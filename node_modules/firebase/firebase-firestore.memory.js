!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Tl){"use strict";try{(function(){Tl=Tl&&Object.prototype.hasOwnProperty.call(Tl,"default")?Tl.default:Tl;var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function t(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var e,o,n,f=function(){return(f=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function c(t,s,a,u){return new(a=a||Promise)(function(e,n){function i(t){try{o(u.next(t))}catch(t){n(t)}}function r(t){try{o(u.throw(t))}catch(t){n(t)}}function o(t){t.done?e(t.value):function(e){return e instanceof a?e:new a(function(t){t(e)})}(t.value).then(i,r)}o((u=u.apply(t,s||[])).next())})}function v(n,i){var r,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}(n=o=o||{})[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT";o.DEBUG,o.VERBOSE,o.INFO,o.WARN,o.ERROR,o.SILENT;function r(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+r+"]  "+t.name+":"],n))}}var u=o.INFO,h=((e={})[o.DEBUG]="log",e[o.VERBOSE]="log",e[o.INFO]="info",e[o.WARN]="warn",e[o.ERROR]="error",e),l=(Object.defineProperty(p.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),p.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,o.DEBUG],t)),this._logHandler.apply(this,a([this,o.DEBUG],t))},p.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,o.VERBOSE],t)),this._logHandler.apply(this,a([this,o.VERBOSE],t))},p.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,o.INFO],t)),this._logHandler.apply(this,a([this,o.INFO],t))},p.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,o.WARN],t)),this._logHandler.apply(this,a([this,o.WARN],t))},p.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,o.ERROR],t)),this._logHandler.apply(this,a([this,o.ERROR],t))},p);function p(t){this.name=t,this._logLevel=u,this._logHandler=r,this._userLogHandler=null}function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var y,g=(t(m,y=Error),m);function m(t,e){var n=y.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=e[0]||{},r=this.service+"/"+t,o=this.errors[t],s=o?function(t,i){return t.replace(E,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})}(o,i):"Error",a=this.serviceName+": "+s+" ("+r+").",u=new g(r,a),h=0,c=Object.keys(i);h<c.length;h++){var f=c[h];"_"!==f.slice(-1)&&(f in u&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),u[f]=i[f])}return u},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,I=(N.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},N.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},N.prototype.setServiceProps=function(t){return this.serviceProps=t,this},N);function N(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var T,A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=S||{},k=A;function R(t){return"string"==typeof t}function D(t){return"number"==typeof t}function C(t,e){t=t.split("."),e=e||k;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function O(){}function L(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function _(t){return"array"==L(t)}function U(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var M="closure_uid_"+(1e9*Math.random()>>>0),F=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function q(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:q).apply(null,arguments)}function G(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now||function(){return+new Date};function B(t,o){function e(){}e.prototype=o.prototype,t.N=o.prototype,t.prototype=new e,(t.prototype.constructor=t).yb=function(t,e,n){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return o.prototype[e].apply(t,i)}}function Y(){this.j=this.j,this.i=this.i}Y.prototype.j=!1,Y.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0))this[M]||(this[M]=++F)},Y.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var H=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(R(t))return R(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r=R(t)?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function K(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var X,$=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Z(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var tt=k.navigator;if(tt){var et=tt.userAgent;if(et){X=et;break t}}X=""}function nt(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function it(t){var e,n={};for(e in t)n[e]=t[e];return n}var rt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ot(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<rt.length;o++)n=rt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function st(t){return st[" "](t),t}st[" "]=O;var at,ut,ht=Z(X,"Opera"),ct=Z(X,"Trident")||Z(X,"MSIE"),ft=Z(X,"Edge"),lt=ft||ct,pt=Z(X,"Gecko")&&!(Z(X.toLowerCase(),"webkit")&&!Z(X,"Edge"))&&!(Z(X,"Trident")||Z(X,"MSIE"))&&!Z(X,"Edge"),dt=Z(X.toLowerCase(),"webkit")&&!Z(X,"Edge");function vt(){var t=k.document;return t?t.documentMode:void 0}t:{var yt="",gt=(ut=X,pt?/rv:([^\);]+)(\)|;)/.exec(ut):ft?/Edge\/([\d\.]+)/.exec(ut):ct?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):dt?/WebKit\/(\S+)/.exec(ut):ht?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);if(gt&&(yt=gt?gt[1]:""),ct){var mt=vt();if(null!=mt&&mt>parseFloat(yt)){at=String(mt);break t}}at=yt}var wt,bt={};function Et(a){return function(t,e){var n=bt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(a,function(){for(var t=0,e=$(String(at)).split("."),n=$(String(a)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t})}var It=k.document;wt=It&&ct?vt()||("CSS1Compat"==It.compatMode?parseInt(at,10):5):void 0;var Nt=!ct||9<=Number(wt),Tt=ct&&!Et("9"),At=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",O,e),k.removeEventListener("test",O,e)}catch(t){}return t}();function St(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function kt(t,e){if(St.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(pt){t:{try{st(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=R(t.pointerType)?t.pointerType:Rt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}St.prototype.b=function(){this.Ia=!1},B(kt,St);var Rt={2:"touch",3:"pen",4:"mouse"};kt.prototype.b=function(){kt.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Tt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Dt="closure_listenable_"+(1e6*Math.random()|0),Ct=0;function Ot(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.da=r,this.key=++Ct,this.X=this.Z=!1}function Lt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function _t(t){this.src=t,this.a={},this.b=0}function Ut(t,e){var n=e.type;if(n in t.a){var i,r=t.a[n],o=H(r,e);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(Lt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Pt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==i)return r}return-1}_t.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Pt(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Ot(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Mt="closure_lm_"+(1e6*Math.random()|0),Ft={};function Vt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(_(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}i=zt(i);return e&&e[Dt]?e.Aa(n,i,P(r)?!!r.capture:!!r,o):qt(e,n,i,!0,r,o)}(t,e,n,i,r);if(_(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,i,r);return null}return n=zt(n),t&&t[Dt]?t.za(e,n,P(i)?!!i.capture:!!i,r):qt(t,e,n,!1,i,r)}function qt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=P(r)?!!r.capture:!!r;if(s&&!Nt)return null;var a=Yt(t);if(a||(t[Mt]=a=new _t(t)),(n=a.add(e,n,i,s,o)).proxy)return n;if(i=function(){var e=Bt,n=Nt?function(t){return e.call(n.src,n.listener,t)}:function(t){if(!(t=e.call(n.src,n.listener,t)))return t};return n}(),(n.proxy=i).src=t,i.listener=n,t.addEventListener)At||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Gt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function xt(t){if(!D(t)&&t&&!t.X){var e=t.src;if(e&&e[Dt])Ut(e.c,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Gt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Yt(e))?(Ut(n,t),0==n.b&&(n.src=null,e[Mt]=null)):Lt(t)}}}function Gt(t){return t in Ft?Ft[t]:Ft[t]="on"+t}function jt(t,e){var n=t.listener,i=t.da||t.src;return t.Z&&xt(t),n.call(i,e)}function Bt(t,e){return!!t.X||(Nt?jt(t,new kt(e,this)):jt(t,e=new kt(e||C("window.event"),this)))}function Yt(t){return(t=t[Mt])instanceof _t?t:null}var Ht="__closure_events_fn_"+(1e9*Math.random()>>>0);function zt(e){return"function"==L(e)?e:(e[Ht]||(e[Ht]=function(t){return e.handleEvent(t)}),e[Ht])}function Kt(){Y.call(this),this.c=new _t(this),(this.J=this).B=null}function Wt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&Ut(t.c,s),r=!1!==a.call(u,i)&&r}}return r&&0!=i.Ia}B(Kt,Y),Kt.prototype[Dt]=!0,(T=Kt.prototype).addEventListener=function(t,e,n,i){Vt(this,t,e,n,i)},T.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(_(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=P(r)?!!r.capture:!!r,i=zt(i),e&&e[Dt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Pt(s=e.a[n],i,r,o))&&(Lt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Yt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Pt(n,i,r,o)),(i=-1<e?n[e]:null)&&xt(i))}(this,t,e,n,i)},T.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var i=t.type||t;if(R(t))t=new St(t,n);else if(t instanceof St)t.target=t.target||n;else{var r=t;ot(t=new St(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];r=Wt(s,i,!0,t)&&r}if(r=Wt(s=t.a=n,i,!0,t)&&r,r=Wt(s,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=Wt(s=t.a=e[o],i,!1,t)&&r;return r},T.G=function(){if(Kt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Lt(n[i]);delete e.a[t],e.b--}}this.B=null},T.za=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},T.Aa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Qt=k.JSON.stringify;function Xt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function $t(){this.b=this.a=null}Xt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Zt,Jt=new Xt(function(){return new te},function(t){t.reset()});function te(){this.next=this.b=this.a=null}function ee(t){k.setTimeout(function(){throw t},0)}function ne(t,e){Zt||function(){var t=k.Promise.resolve(void 0);Zt=function(){t.then(oe)}}(),ie||(Zt(),ie=!0),re.add(t,e)}$t.prototype.add=function(t,e){var n=Jt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},te.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var ie=!(te.prototype.reset=function(){this.next=this.b=this.a=null}),re=new $t;function oe(){for(var t;i=n=void 0,i=null,(n=re).a&&(i=n.a,n.a=n.a.next,n.a||(n.b=null),i.next=null),t=i;){try{t.a.call(t.b)}catch(t){ee(t)}var e=Jt;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,i;ie=!1}function se(t,e){Kt.call(this),this.b=t||1,this.a=e||k,this.f=x(this.gb,this),this.g=j()}function ae(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ue(t,e,n){if("function"==L(t))n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}function he(t,e,n){Y.call(this),this.f=null!=n?x(t,n):t,this.c=e,this.b=x(this.$a,this),this.a=[]}function ce(t){t.U=ue(t.b,t.c),t.f.apply(null,t.a)}function fe(t){Y.call(this),this.b=t,this.a={}}B(se,Kt),(T=se.prototype).ba=!1,T.L=null,T.gb=function(){if(this.ba){var t=j()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(ae(this),this.start()))}},T.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=j())},T.G=function(){se.N.G.call(this),ae(this),delete this.a},B(he,Y),(T=he.prototype).ea=!1,T.U=null,T.Ta=function(t){this.a=arguments,this.U?this.ea=!0:ce(this)},T.G=function(){he.N.G.call(this),this.U&&(k.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},T.$a=function(){this.U=null,this.ea&&(this.ea=!1,ce(this))},B(fe,Y);var le=[];function pe(t,e,n,i){_(n)||(n&&(le[0]=n.toString()),n=le);for(var r=0;r<n.length;r++){var o=Vt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function de(t){nt(t.a,function(t,e){this.a.hasOwnProperty(e)&&xt(t)},t),t.a={}}function ve(){}fe.prototype.G=function(){fe.N.G.call(this),de(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ye=new Kt;function ge(t){St.call(this,"serverreachability",t)}function me(t){ye.dispatchEvent(new ge(ye,t))}function we(t){St.call(this,"statevent",t)}function be(t){ye.dispatchEvent(new we(ye,t))}function Ee(t){St.call(this,"timingevent",t)}function Ie(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}B(ge,St),B(we,St),B(Ee,St);var Ne={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9},Te={jb:"complete",wb:"success",Ma:"error",La:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function Ae(){}function Se(t){var e;return(e=t.a)||(e=t.a={}),e}function ke(){}Ae.prototype.a=null;var Re,De={OPEN:"a",ib:"b",Ma:"c",rb:"d"};function Ce(){St.call(this,"d")}function Oe(){St.call(this,"c")}function Le(){}function _e(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new fe(this),this.O=Ue,t=lt?125:void 0,this.P=new se(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}B(Ce,St),B(Oe,St),B(Le,Ae),Re=new Le;var Ue=45e3,Pe={},Me={};function Fe(t,e,n){t.F=1,t.f=hn(en(e)),t.l=n,t.H=!0,qe(t,null)}function Ve(t,e,n,i){t.F=1,t.f=hn(en(e)),t.l=null,t.H=n,qe(t,i)}function qe(t,e){t.v=j(),je(t),t.D=en(t.f),un(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new he(x(t.Ja,t,t.a),t.J)),pe(t.I,t.a,"readystatechange",t.cb),e=t.h?it(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),me(1)}function xe(t,e,n){for(var i=!0;!t.m&&t.A<n.length;){var r=Ge(t,n);if(r==Me){4==e&&(t.c=4,be(14),i=!1);break}if(r==Pe){t.c=4,be(15),i=!1;break}Ke(t,r)}4==e&&0==n.length&&(t.c=1,be(16),i=!1),t.b=t.b&&i,i||(ze(t),He(t))}function Ge(t,e){var n=t.A,i=e.indexOf("\n",n);return-1==i?Me:(n=Number(e.substring(n,i)),isNaN(n)?Pe:(i+=1)+n>e.length?Me:(e=e.substr(i,n),t.A=i+n,e))}function je(t){t.R=j()+t.O,Be(t,t.O)}function Be(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=Ie(x(t.ab,t),e)}function Ye(t){t.i&&(k.clearTimeout(t.i),t.i=null)}function He(t){t.g.Ca()||t.m||t.g.na(t)}function ze(t){Ye(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,ae(t.P),de(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Ke(t,e){try{t.g.Fa(t,e),me(4)}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(U(t)||R(t))z(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(U(t)||R(t)){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(R(t))return t.split("");if(U(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Qe)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Xe(t,e){Ze(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&$e(t))}function $e(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Ze(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Ze(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=_e.prototype).setTimeout=function(t){this.O=t},T.cb=function(t){t=t.target;var e=this.B;e&&3==ei(t)?e.Ta():this.Ja(t)},T.Ja=function(t){try{if(t==this.a)t:{var e=ei(this.a),n=this.a.ya(),i=this.a.T();if(!(e<3||3==e&&!lt&&!this.a.aa())){this.m||4!=e||7==n||me(8==n||i<=0?3:2),Ye(this);var r=this.a.T();this.o=r;var o=this.a.aa();if(this.b=200==r){if(this.S&&!this.s){e:{if(this.a){var s=ni(this.a,"X-HTTP-Initial-Response");if(s&&!Q(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,be(12),ze(this),He(this);break t}this.s=!0,Ke(this,a)}this.H?(xe(this,e,o),lt&&this.b&&3==e&&(pe(this.I,this.P,"tick",this.bb),this.P.start())):Ke(this,o),4==e&&ze(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,je(this)))}else 400==r&&0<o.indexOf("Unknown SID")?(this.c=3,be(12)):(this.c=0,be(13)),ze(this),He(this)}}}catch(t){}},T.bb=function(){if(this.a){var t=ei(this.a),e=this.a.aa();this.A<e.length&&(Ye(this),xe(this,t,e),this.b&&4!=t&&je(this))}},T.cancel=function(){this.m=!0,ze(this)},T.ab=function(){this.i=null;var t=j();0<=t-this.R?(2!=this.F&&(me(3),be(17)),ze(this),this.c=2,He(this)):Be(this,this.R-t)},(T=Qe.prototype).C=function(){$e(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.K=function(){return $e(this),this.a.concat()},T.get=function(t,e){return Ze(this.b,t)?this.b[t]:e},T.set=function(t,e){Ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function tn(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof tn?(this.h=void 0!==e?e:t.h,nn(this,t.f),this.j=t.j,rn(this,t.b),on(this,t.i),this.a=t.a,sn(this,Nn(t.c)),this.g=t.g):t&&(n=String(t).match(Je))?(this.h=!!e,nn(this,n[1]||"",!0),this.j=cn(n[2]||""),rn(this,n[3]||"",!0),on(this,n[4]),this.a=cn(n[5]||"",!0),sn(this,n[6]||"",!0),this.g=cn(n[7]||"")):(this.h=!!e,this.c=new mn(null,this.h))}function en(t){return new tn(t)}function nn(t,e,n){t.f=n?cn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function rn(t,e,n){t.b=n?cn(e,!0):e}function on(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function sn(t,e,n){e instanceof mn?(t.c=e,function(t,e){e&&!t.f&&(wn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(bn(this,e),In(this,n,t))},t)),t.f=e}(t.c,t.h)):(n||(e=fn(e,yn)),t.c=new mn(e,t.h))}function an(t,e,n){t.c.set(e,n)}function un(t,e,n){_(n)||(n=[String(n)]),In(t.c,e,n)}function hn(t){return an(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function cn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function fn(t,e,n){return R(t)?(t=encodeURI(t).replace(e,ln),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ln(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}tn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(fn(e,pn,!0),":");var n=this.b;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(fn(e,pn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(fn(n,"/"==n.charAt(0)?vn:dn,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",fn(n,gn)),t.join("")},tn.prototype.resolve=function(t){var e=en(this),n=!!t.f;n?nn(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?rn(e,t.b):n=null!=t.i;var i=t.a;if(n)on(e,t.i);else if(n=!!t.a){if("/"!=i.charAt(0))if(this.b&&!this.a)i="/"+i;else{var r=e.a.lastIndexOf("/");-1!=r&&(i=e.a.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if(Z(r,"./")||Z(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],s=0;s<r.length;){var a=r[s++];"."==a?i&&s==r.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&s==r.length&&o.push("")):(o.push(a),i=!0)}i=o.join("/")}else i=r}return n?e.a=i:n=""!==t.c.toString(),n?sn(e,Nn(t.c)):n=!!t.g,n&&(e.g=t.g),e};var pn=/[#\/\?@]/g,dn=/[#\?:]/g,vn=/[#\?]/g,yn=/[#\?@]/g,gn=/#/g;function mn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function wn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function bn(t,e){wn(t),e=Tn(t,e),Ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe(t.a,e))}function En(t,e){return wn(t),e=Tn(t,e),Ze(t.a.b,e)}function In(t,e,n){bn(t,e),0<n.length&&(t.c=null,t.a.set(Tn(t,e),W(n)),t.b+=n.length)}function Nn(t){var e=new mn;return e.c=t.c,t.a&&(e.a=new Qe(t.a),e.b=t.b),e}function Tn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function An(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function Sn(t){var e=t.a.F.a;if(null!=e)be(4),e?(be(10),di(t.a,t,!1)):(be(11),di(t.a,t,!0));else{t.b=new _e(t,void 0,void 0),t.b.h=t.h,e=wi(e=t.a,e.Y()?t.f:null,t.i),be(4),un(e,"TYPE","xmlhttp");var n=t.a.j,i=t.a.I;n&&i&&an(e,n,i),Ve(t.b,e,!1,t.f)}}function kn(){this.a=this.b=null}function Rn(){this.a=new Qe}function Dn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[M]||(t[M]=++F)):e.charAt(0)+t}function Cn(t,e){this.b=t,this.a=e}function On(t){this.g=t||Ln,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ka&&k.ka.Da&&k.ka.Da()&&k.ka.Da().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Rn),this.b=null,this.c=[]}(T=mn.prototype).add=function(t,e){wn(this),this.c=null,t=Tn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(n,i){wn(this),this.a.forEach(function(t,e){z(t,function(t){n.call(i,t,e,this)},this)},this)},T.K=function(){wn(this);for(var t=this.a.C(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},T.C=function(t){wn(this);var e=[];if(R(t))En(this,t)&&(e=K(e,this.a.get(Tn(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=K(e,t[n])}return e},T.set=function(t,e){return wn(this),this.c=null,En(this,t=Tn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.C(i);for(var o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}}return this.c=t.join("&")},B(function(){},function(){}),(T=An.prototype).M=null,T.$=function(t){return this.a.$(t)},T.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},T.Ca=function(){return!1},T.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=ni(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=ni(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var i=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void gi(e,2)}this.f=i[0]}else(e=this.a).m=this.c,gi(e,2)}else 1==this.M&&(this.g?be(6):"11111"==e?(be(5),this.g=!0,(!ct||10<=Number(wt))&&(this.c=200,this.b.cancel(),be(11),di(this.a,this,!0))):(be(7),this.g=!1))},T.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,Sn(this)):1==this.M&&(this.g?(be(11),di(this.a,this,!0)):(be(10),di(this.a,this,!1)));else{0==this.M?be(8):1==this.M&&be(9);var t=this.a;t.m=this.c,gi(t,2)}},T.Y=function(){return this.a.Y()},T.ma=function(){return this.a.ma()},Rn.prototype.add=function(t){this.a.set(Dn(t),t)},Rn.prototype.C=function(){return this.a.C()};var Ln=10;function _n(t,e){!t.a&&(Z(e,"spdy")||Z(e,"quic")||Z(e,"h2"))&&(t.f=t.g,t.a=new Rn,t.b&&(Fn(t,t.b),t.b=null))}function Un(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function Pn(t){return t.b?1:t.a?t.a.a.c:0}function Mn(t,e){return t=t.b?t.b==e:!!t.a&&(e=Dn(e),Ze(t.a.a.b,e))}function Fn(t,e){t.a?t.a.add(e):t.b=e}function Vn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=Dn(e),n=Ze(t.a.a.b,n)),n&&Xe(t.a.a,Dn(e)))}function qn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return W(t.c);var e=t.c;return z(t.a.C(),function(t){e=e.concat(t.j)}),e}function xn(){}function Gn(){this.a=new xn}function jn(t,i,e){var r=e||"";try{We(t,function(t,e){var n=t;P(t)&&(n=Qt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function Bn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}On.prototype.cancel=function(){this.c=qn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(z(this.a.C(),function(t){t.cancel()}),function(t){t.b={},t.a.length=0,t.c=0}(this.a.a))},xn.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},xn.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Yn=k.JSON.parse;function Hn(t){Kt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=zn,this.D=this.F=!1}B(Hn,Kt);var zn="",Kn=/^https?$/i,Wn=["POST","PUT"];function Qn(t){return"content-type"==t.toLowerCase()}function Xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,$n(t),Jn(t)}function $n(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Zn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=ei(t)||2!=t.T()))if(t.l&&4==ei(t))ue(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==ei(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var o=String(t.A).match(Je)[1]||null;if(!o&&k.self&&k.self.location){var s=k.self.location.protocol;o=s.substr(0,s.length-1)}r=!Kn.test(o?o.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<ei(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.T()+"]",$n(t)}}finally{Jn(t)}}}function Jn(t,e){if(t.a){ti(t);var n=t.a,i=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function ti(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function ei(t){return t.a?t.a.readyState:0}function ni(t,e){return t.a?t.a.getResponseHeader(e):null}function ii(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}if(i)return t;if(n=function(t){var n="";return nt(t,function(t,e){n+=e,n+=":",n+=t,n+="\r\n"}),n}(n),R(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(i=t.indexOf("?"))<0||n<i){i=n;var r=""}else r=t.substring(i+1,n);n=(t=[t.substr(0,i),r,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return an(t,e,n),t}function ri(t){this.f=[],this.F=new kn,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!C("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=C("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=C("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=C("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=C("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new On(t&&t.concurrentRequestLimit),this.ja=new Gn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function oi(t){if(si(t),3==t.u){var e=t.P++,n=en(t.B);an(n,"SID",t.H),an(n,"RID",e),an(n,"TYPE","terminate"),ci(t,n),(e=new _e(t,e,void 0)).F=2,e.f=hn(en(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.f.toString(),"")),!n&&k.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=j(),je(e)}mi(t)}function si(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(k.clearTimeout(t.l),t.l=null),vi(t),t.b.cancel(),t.h&&(D(t.h)&&k.clearTimeout(t.h),t.h=null)}function ai(t,e){t.f.push(new Cn(t.Qa++,e)),3==t.u&&ui(t)}function ui(t){Un(t.b)||t.h||(t.h=!0,ne(t.Ha,t),t.A=0)}function hi(t,e){var n;n=e?e.W:t.P++;var i=en(t.B);an(i,"SID",t.H),an(i,"RID",n),an(i,"AID",t.O),ci(t,i),t.g&&t.i&&ii(i,t.g,t.i),n=new _e(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=fi(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Fn(t.b,n),Fe(n,i,e)}function ci(t,n){t.c&&We({},function(t,e){an(n,e,t)})}function fi(t,e,n){n=Math.min(t.f.length,n);var i=t.c?x(t.c.Sa,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=r[u].b,c=r[u].a;if((h-=o)<0)o=Math.max(0,r[u].b-100),a=!1;else try{jn(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(a){i=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,i}function li(t){t.a||t.l||(t.S=1,ne(t.Ga,t),t.v=0)}function pi(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=Ie(x(t.Ga,t),yi(t,t.v)),t.v++,!0)}function di(t,e,n){var i=e.l;i&&_n(t.b,i),t.ia=t.oa&&n,t.m=e.c,t.B=wi(t,null,t.ha),ui(t)}function vi(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function yi(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function gi(t,e){if(2==e){var n=null;t.c&&(n=null);var i=x(t.eb,t);n||(n=new tn("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||nn(n,"https"),hn(n)),function(t,e){var n=new ve;if(k.Image){var i=new Image;i.onload=G(Bn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=G(Bn,n,i,"TestLoadImage: error",!1,e),i.onabort=G(Bn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=G(Bn,n,i,"TestLoadImage: timeout",!1,e),k.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(n.toString(),i)}else be(2);t.u=0,t.c&&t.c.ta(e),mi(t),si(t)}function mi(t){t.u=0,t.m=-1,t.c&&(0==qn(t.b).length&&0==t.f.length||(t.b.c.length=0,W(t.f),t.f.length=0),t.c.sa())}function wi(t,e,n){var i=function(t){return t instanceof tn?en(t):new tn(t,void 0)}(n);if(""!=i.b)e&&rn(i,e+"."+i.b),on(i,i.i);else{var r,o=k.location;r=e?e+"."+o.hostname:o.hostname,i=function(t,e,n,i){var r=new tn(null,void 0);return t&&nn(r,t),e&&rn(r,e),n&&on(r,n),i&&(r.a=i),r}(o.protocol,r,+o.port,n)}return t.V&&nt(t.V,function(t,e){an(i,e,t)}),e=t.j,n=t.I,e&&n&&an(i,e,n),an(i,"VER",t.wa),ci(t,i),i}function bi(){}function Ei(){if(ct&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function Ii(t,e){Kt.call(this),this.a=new ri(e),this.g=t,this.m=e&&e.fb?e.fb:function(t){for(var e=t,n=1;n<arguments.length;n++){var i,r=arguments[n];if(0==r.lastIndexOf("/",0))e=r;else(i=""==e)||(i=0<=(i=e.length-1)&&e.indexOf("/",i)==i),e+=i?r:"/"+r}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new Ai(this)}function Ni(t){Ce.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Ti(){Oe.call(this),this.status=1}function Ai(t){this.a=t}(T=Hn.prototype).ca=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Se(this.H):Se(Re),this.a.onreadystatechange=x(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Xn(this,t)}t=n||"";var r=new Qe(this.headers);i&&We(i,function(t,e){r.set(e,t)}),i=function(t){t:{for(var e=Qn,n=t.length,i=R(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:R(t)?t.charAt(e):t[e]}(r.K()),n=k.FormData&&t instanceof k.FormData,0<=H(Wn,e)&&!i&&!n&&r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{ti(this),0<this.o&&((this.D=function(t){return ct&&Et(9)&&D(t.timeout)&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=x(this.Ba,this)):this.m=ue(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Xn(this,t)}},T.Ba=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Jn(this))},T.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Jn(this,!0)),Hn.N.G.call(this)},T.Ea=function(){this.j||(this.w||this.l||this.g?Zn(this):this.Za())},T.Za=function(){Zn(this)},T.T=function(){try{return 2<ei(this)?this.a.status:-1}catch(t){return-1}},T.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},T.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Yn(e)}},T.ya=function(){return this.h},T.Xa=function(){return R(this.f)?this.f:String(this.f)},(T=ri.prototype).wa=8,T.u=1,T.Ca=function(){return 0==this.u},T.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random()),t=this.P++;var e,n=new _e(this,t,void 0),i=this.i;if(this.J&&(i?ot(i=it(i),this.J):i=this.J),null===this.g&&(n.h=i),this.W)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if(void 0===(o="__data__"in o.a&&R(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=fi(this,n,e),an(r=en(this.B),"RID",t),an(r,"CVER",22),this.o&&this.j&&an(r,"X-HTTP-Session-Id",this.j),ci(this,r),this.g&&i&&ii(r,this.g,i),Fn(this.b,n),this.W?(an(r,"$req",e),an(r,"SID","null"),n.S=!0,Fe(n,r,null)):Fe(n,r,e),this.u=2}}else 3==this.u&&(t?hi(this,t):0==this.f.length||Un(this.b)||hi(this))},T.Ga=function(){this.l=null,this.a=new _e(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=en(this.pa);an(t,"RID","rpc"),an(t,"SID",this.H),an(t,"CI",this.ia?"0":"1"),an(t,"AID",this.O),ci(this,t),an(t,"TYPE","xmlhttp"),this.g&&this.i&&ii(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Ve(this.a,t,!0,this.ga)},T.Fa=function(t,e){if(0!=this.u&&(this.a==t||Mn(this.b,t)))if(this.m=t.o,!t.s&&Mn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(_(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;vi(this),this.a.cancel(),this.a=null}pi(this),be(18)}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=Ie(x(this.Ya,this),6e3));if(Pn(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else gi(this,11)}else if(!t.s&&this.a!=t||vi(this),!Q(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var i=e[n];if(this.O=i[0],i=i[1],2==this.u)if("c"==i[0]){this.H=i[1],this.ga=i[2];var r=i[3];null!=r&&(this.wa=r),null!=(i=i[5])&&D(i)&&0<i&&(this.D=1.5*i),this.o&&(i=t.a)&&((r=ni(i,"X-Client-Wire-Protocol"))&&_n(this.b,r),this.j&&(i=ni(i,"X-HTTP-Session-Id")))&&(this.I=i,an(this.B,this.j,i)),this.u=3,this.c&&this.c.va(),i=t,this.pa=wi(this,this.Y()?this.ga:null,this.ha),i.s?(Vn(this.b,i),(r=this.D)&&i.setTimeout(r),i.i&&(Ye(i),je(i)),this.a=i):li(this),0<this.f.length&&ui(this)}else"stop"!=i[0]&&"close"!=i[0]||gi(this,7);else 3==this.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?gi(this,7):oi(this):"noop"!=i[0]&&this.c&&this.c.ua(i),this.v=0)}},T.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,pi(this),be(19))},T.na=function(t){var e=null;if(this.a==t){vi(this),this.a=null;var n=2}else{if(!Mn(this.b,t))return;e=t.j,Vn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=j()-t.v,ye.dispatchEvent(new Ee(ye,t.l?t.l.length:0,e,this.A)),ui(this)):li(this);else{var i=t.c;if(3==i||0==i&&0<this.m||!(1==n&&function(t,e){return!(Pn(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.f=e.j.concat(t.f),!0):!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa))&&(t.h=Ie(x(t.Ha,t,e),yi(t,t.A)),t.A++,!0))}(this,t)||2==n&&pi(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),i){case 1:gi(this,5);break;case 4:gi(this,10);break;case 3:gi(this,6);break;default:gi(this,2)}}},T.eb=function(t){be(t?2:1)},T.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Hn(this.Ka)).F=this.R,t},T.ma=function(){return!!this.c&&!0},T.Y=function(){return this.R},(T=bi.prototype).va=function(){},T.ua=function(){},T.ta=function(){},T.sa=function(){},T.Sa=function(){},Ei.prototype.a=function(t,e){return new Ii(t,e)},B(Ii,Kt),(T=Ii.prototype).addEventListener=function(t,e,n,i){Ii.N.addEventListener.call(this,t,e,n,i)},T.removeEventListener=function(t,e,n,i){Ii.N.removeEventListener.call(this,t,e,n,i)},T.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,i=this.b||void 0;be(0),t.ha=n,t.V=i||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new An(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=ii(e,t.g,t.i)),(t=t.w).i=n,e=wi(t.a,null,t.i),be(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,Sn(t)):(un(e,"MODE","init"),!t.a.o&&t.a.j&&un(e,"X-HTTP-Session-Id",t.a.j),t.b=new _e(t,void 0,void 0),t.b.h=t.h,Ve(t.b,e,!1,null),t.M=0)},T.close=function(){oi(this.a)},T.Wa=function(t){if(R(t)){var e={};e.__data__=t,ai(this.a,e)}else this.h?((e={}).__data__=Qt(t),ai(this.a,e)):ai(this.a,t)},T.G=function(){this.a.c=null,delete this.f,oi(this.a),delete this.a,Ii.N.G.call(this)},B(Ni,Ce),B(Ti,Oe),B(Ai,bi),Ai.prototype.va=function(){this.a.dispatchEvent("a")},Ai.prototype.ua=function(t){this.a.dispatchEvent(new Ni(t))},Ai.prototype.ta=function(t){this.a.dispatchEvent(new Ti(t))},Ai.prototype.sa=function(){this.a.dispatchEvent("b")};var Si=G(function(t,e){function n(){}n.prototype=t.prototype;var i=new n;return t.apply(i,Array.prototype.slice.call(arguments,1)),i},Ei);Ei.prototype.createWebChannel=Ei.prototype.a,Ii.prototype.send=Ii.prototype.Wa,Ii.prototype.open=Ii.prototype.Va,Ii.prototype.close=Ii.prototype.close,Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,Te.COMPLETE="complete",(ke.EventType=De).OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",Kt.prototype.listen=Kt.prototype.za,Hn.prototype.listenOnce=Hn.prototype.Aa,Hn.prototype.getLastError=Hn.prototype.Xa,Hn.prototype.getLastErrorCode=Hn.prototype.ya,Hn.prototype.getStatus=Hn.prototype.T,Hn.prototype.getResponseJson=Hn.prototype.Ua,Hn.prototype.getResponseText=Hn.prototype.aa,Hn.prototype.send=Hn.prototype.ca;function ki(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}var Ri,Di={createWebChannelTransport:Si,ErrorCode:Ne,EventType:Te,WebChannel:ke,XhrIo:Hn},Ci=Di.createWebChannelTransport,Oi=Di.ErrorCode,Li=Di.EventType,_i=Di.WebChannel,Ui=Di.XhrIo,Pi=Tl.SDK_VERSION,Mi=(Wi.prototype.t=function(){return null!=this.uid},Wi.prototype.i=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Wi.prototype.isEqual=function(t){return t.uid===this.uid},Wi.UNAUTHENTICATED=new Wi(null),Wi.s=new Wi("google-credentials-uid"),Wi.u=new Wi("first-party-uid"),Wi),Fi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Vi=(t(Ki,Ri=Error),Ki),qi=(zi.prototype.getToken=function(){return Promise.resolve(null)},zi.prototype.l=function(){},zi.prototype.v=function(t){Nu(!this.h,"Can only call setChangeListener() once."),(this.h=t)(Mi.UNAUTHENTICATED)},zi.prototype.m=function(){Nu(null!==this.h,"removeChangeListener() when no listener registered"),this.h=null},zi),xi=(Hi.prototype.getToken=function(){var e=this;Nu(null!=this.g,"getToken cannot be called after listener removed.");var n=this._,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e._!==n)throw new Vi(Fi.ABORTED,"getToken aborted due to token change.");return t?(Nu("string"==typeof t.accessToken,"Invalid tokenData returned from getToken():"+t),new ki(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Hi.prototype.l=function(){this.forceRefresh=!0},Hi.prototype.v=function(t){Nu(!this.h,"Can only call setChangeListener() once."),this.h=t,this.p&&t(this.currentUser)},Hi.prototype.m=function(){Nu(null!=this.g,"removeChangeListener() called twice"),Nu(null!==this.h,"removeChangeListener() called when no listener registered"),this.auth&&this.auth.removeAuthTokenListener(this.g),this.g=null,this.h=null},Hi.prototype.T=function(){var t=this.auth&&this.auth.getUid();return Nu(null===t||"string"==typeof t,"Received invalid UID: "+t),new Mi(t)},Hi),Gi=(Object.defineProperty(Yi.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.I},e=this.S.auth.A([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Yi),ji=(Bi.prototype.getToken=function(){return Promise.resolve(new Gi(this.S,this.I))},Bi.prototype.v=function(t){t(Mi.u)},Bi.prototype.m=function(){},Bi.prototype.l=function(){},Bi);function Bi(t,e){this.S=t,this.I=e}function Yi(t,e){this.S=t,this.I=e,this.type="FirstParty",this.user=Mi.u}function Hi(t){var e=this;this.g=null,this.currentUser=Mi.UNAUTHENTICATED,this.p=!1,this._=0,this.h=null,this.forceRefresh=!1,this.g=function(){e._++,e.currentUser=e.T(),e.p=!0,e.h&&e.h(e.currentUser)},this._=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.g):(this.g(null),t.get().then(function(t){e.auth=t,e.g&&e.auth.addAuthTokenListener(e.g)},function(){}))}function zi(){this.h=null}function Ki(t,e){var n=Ri.call(this,e)||this;return n.code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Wi(t){this.uid=t}function Qi(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Vi(Fi.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}function Xi(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $i(t,e){return void 0!==t?t:e}function Zi(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Number(n);isNaN(i)||e(i,t[n])}}function Ji(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function tr(t){for(var e in Nu(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function er(t,e){if(0!==e.length)throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+mr(e.length,"argument")+".")}function nr(t,e,n){if(e.length!==n)throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() requires "+mr(n,"argument")+", but was called with "+mr(e.length,"argument")+".")}function ir(t,e,n){if(e.length<n)throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+mr(n,"argument")+", but was called with "+mr(e.length,"argument")+".")}function rr(t,e,n,i){if(e.length<n||e.length>i)throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+mr(e.length,"argument")+".")}function or(t,e,n,i){cr(t,e,gr(n)+" argument",i)}function sr(t,e,n,i){void 0!==i&&or(t,e,n,i)}function ar(t,e,n,i){cr(t,e,n+" option",i)}function ur(t,e,n,i){void 0!==i&&ar(t,e,n,i)}function hr(t,e,n,i,h){void 0!==i&&function(t,e,n,i){for(var r=[],o=0,s=h;o<s.length;o++){var a=s[o];if(a===i)return;r.push(lr(a))}var u=lr(i);throw new Vi(Fi.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+r.join(", "))}(t,0,n,i)}function cr(t,e,n,i){if(!("object"===e?fr(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=lr(i);throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function fr(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function lr(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return 20<t.length&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"!=typeof t)return"function"==typeof t?"a function":Iu("Unknown wrong type: "+typeof t);if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&1<e.length)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}function pr(t,e,n){if(void 0===n)throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+gr(e)+" argument, but it was undefined.")}function dr(n,t,i){Ji(t,function(t,e){if(i.indexOf(t)<0)throw new Vi(Fi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function vr(t,e,n,i){var r=lr(i);return new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() requires its "+gr(n)+" argument to be a "+e+", but it was: "+r)}function yr(t,e,n){if(n<=0)throw new Vi(Fi.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+gr(e)+" argument to be a positive number, but it was: "+n+".")}function gr(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function mr(t,e){return t+" "+e+(1===t?"":"s")}var wr=(br.fromBase64String=function(t){return new br(pu.N().atob(t))},br.fromUint8Array=function(t){return new br(Er(t))},br.prototype.toBase64=function(){return pu.N().btoa(this.R)},br.prototype.toUint8Array=function(){return Ir(this.R)},br.prototype.D=function(){return 2*this.R.length},br.prototype.isEqual=function(t){return this.R===t.R},br.k=new br(""),br);function br(t){this.R=t}function Er(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}function Ir(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}function Nr(){if("undefined"==typeof Uint8Array)throw new Vi(Fi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Tr(){if(!pu.N().O)throw new Vi(Fi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ar,Sr,kr=(Zr.fromBase64String=function(t){nr("Blob.fromBase64String",arguments,1),or("Blob.fromBase64String","string",1,t),Tr();try{return new Zr(pu.N().atob(t))}catch(t){throw new Vi(Fi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Zr.fromUint8Array=function(t){if(nr("Blob.fromUint8Array",arguments,1),Nr(),!(t instanceof Uint8Array))throw vr("Blob.fromUint8Array","Uint8Array",1,t);return new Zr(Er(t))},Zr.prototype.toBase64=function(){return nr("Blob.toBase64",arguments,0),Tr(),pu.N().btoa(this.R)},Zr.prototype.toUint8Array=function(){return nr("Blob.toUint8Array",arguments,0),Nr(),Ir(this.R)},Zr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Zr.prototype.isEqual=function(t){return this.R===t.R},Zr.prototype.P=function(){return 2*this.R.length},Zr.prototype.F=function(t){return Su(this.R,t.R)},Zr),Rr=Qi(kr,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Dr=(Object.defineProperty($r.prototype,"latitude",{get:function(){return this.V},enumerable:!0,configurable:!0}),Object.defineProperty($r.prototype,"longitude",{get:function(){return this.U},enumerable:!0,configurable:!0}),$r.prototype.isEqual=function(t){return this.V===t.V&&this.U===t.U},$r.prototype.F=function(t){return Su(this.V,t.V)||Su(this.U,t.U)},$r),Cr=(Xr.now=function(){return Xr.fromMillis(Date.now())},Xr.fromDate=function(t){return Xr.fromMillis(t.getTime())},Xr.fromMillis=function(t){var e=Math.floor(t/1e3);return new Xr(e,1e6*(t-1e3*e))},Xr.prototype.toDate=function(){return new Date(this.toMillis())},Xr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Xr.prototype.F=function(t){return this.seconds===t.seconds?Su(this.nanoseconds,t.nanoseconds):Su(this.seconds,t.seconds)},Xr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Xr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Xr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Xr),Or=(Qr.j=function(t){var e=Math.floor(t/1e6);return new Qr(new Cr(e,t%1e6*1e3))},Qr.L=function(t){return new Qr(t)},Qr.q=function(){return Qr.MIN},Qr.prototype.M=function(t){return this.timestamp.F(t.timestamp)},Qr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Qr.prototype.B=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Qr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Qr.prototype.W=function(){return this.timestamp},Qr.MIN=new Qr(new Cr(0,0)),Qr),Lr=(Object.defineProperty(Wr.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),Wr.prototype.isEqual=function(t){return 0===Wr.G(this,t)},Wr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Wr?t.forEach(function(t){e.push(t)}):e.push(t),this.H(e)},Wr.prototype.limit=function(){return this.offset+this.length},Wr.prototype.J=function(t){return t=void 0===t?1:t,Nu(this.length>=t,"Can't call popFirst() with less segments"),this.H(this.segments,this.offset+t,this.length-t)},Wr.prototype.Y=function(){return Nu(!this.K(),"Can't call popLast() on empty path"),this.H(this.segments,this.offset,this.length-1)},Wr.prototype.X=function(){return Nu(!this.K(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},Wr.prototype.$=function(){return this.get(this.length-1)},Wr.prototype.get=function(t){return Nu(t<this.length,"Index out of range"),this.segments[this.offset+t]},Wr.prototype.K=function(){return 0===this.length},Wr.prototype.Z=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Wr.prototype.tt=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Wr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Wr.prototype.nt=function(){return this.segments.slice(this.offset,this.limit())},Wr.G=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Wr),_r=(t(Kr,Sr=Lr),Kr.prototype.H=function(t,e,n){return new Kr(t,e,n)},Kr.prototype.it=function(){return this.nt().join("/")},Kr.prototype.toString=function(){return this.it()},Kr.et=function(t){if(0<=t.indexOf("//"))throw new Vi(Fi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Kr(t.split("/").filter(function(t){return 0<t.length}))},Kr.rt=new Kr([]),Kr),Ur=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Pr=(t(zr,Ar=Lr),zr.prototype.H=function(t,e,n){return new zr(t,e,n)},zr.st=function(t){return Ur.test(t)},zr.prototype.it=function(){return this.nt().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),zr.st(t)||(t="`"+t+"`"),t}).join(".")},zr.prototype.toString=function(){return this.it()},zr.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},zr.ot=function(){return new zr(["__name__"])},zr.ht=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Vi(Fi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Vi(Fi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Vi(Fi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zr(e)},zr.rt=new zr([]),zr),Mr=(Hr.prototype.at=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Hr.prototype.isEqual=function(t){return null!==t&&0===_r.G(this.path,t.path)},Hr.prototype.toString=function(){return this.path.toString()},Hr.G=function(t,e){return _r.G(t.path,e.path)},Hr.ct=function(t){return t.length%2==0},Hr.ft=function(t){return new Hr(new _r(t.slice()))},Hr.lt=function(t){return new Hr(_r.et(t))},Hr.EMPTY=new Hr(new _r([])),Hr),Fr=(Yr.prototype.dt=function(t,e){return new Yr(this.G,this.root.dt(t,e,this.G).copy(null,null,qr.vt,null,null))},Yr.prototype.remove=function(t){return new Yr(this.G,this.root.remove(t,this.G).copy(null,null,qr.vt,null,null))},Yr.prototype.get=function(t){for(var e=this.root;!e.K();){var n=this.G(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Yr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.K();){var i=this.G(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Yr.prototype.K=function(){return this.root.K()},Object.defineProperty(Yr.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),Yr.prototype.wt=function(){return this.root.wt()},Yr.prototype.gt=function(){return this.root.gt()},Yr.prototype.pt=function(t){return this.root.pt(t)},Yr.prototype.forEach=function(n){this.pt(function(t,e){return n(t,e),!1})},Yr.prototype.toString=function(){var n=[];return this.pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Yr.prototype.bt=function(t){return this.root.bt(t)},Yr.prototype.yt=function(){return new Vr(this.root,null,this.G,!1)},Yr.prototype._t=function(t){return new Vr(this.root,t,this.G,!1)},Yr.prototype.Tt=function(){return new Vr(this.root,null,this.G,!0)},Yr.prototype.Et=function(t){return new Vr(this.root,t,this.G,!0)},Yr),Vr=(Br.prototype.At=function(){Nu(0<this.It.length,"getNext() called on iterator when hasNext() is false.");var t=this.It.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.K();)this.It.push(t),t=t.right;else for(t=t.right;!t.K();)this.It.push(t),t=t.left;return e},Br.prototype.Ct=function(){return 0<this.It.length},Br.prototype.Rt=function(){if(0===this.It.length)return null;var t=this.It[this.It.length-1];return{key:t.key,value:t.value}},Br),qr=(jr.prototype.copy=function(t,e,n,i,r){return new jr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},jr.prototype.K=function(){return!1},jr.prototype.pt=function(t){return this.left.pt(t)||t(this.key,this.value)||this.right.pt(t)},jr.prototype.bt=function(t){return this.right.bt(t)||t(this.key,this.value)||this.left.bt(t)},jr.prototype.min=function(){return this.left.K()?this:this.left.min()},jr.prototype.wt=function(){return this.min().key},jr.prototype.gt=function(){return this.right.K()?this.key:this.right.gt()},jr.prototype.dt=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.dt(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.dt(t,e,n))).Nt()},jr.prototype.Dt=function(){if(this.left.K())return jr.EMPTY;var t=this;return t.left.kt()||t.left.left.kt()||(t=t.Ot()),(t=t.copy(null,null,null,t.left.Dt(),null)).Nt()},jr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.K()||i.left.kt()||i.left.left.kt()||(i=i.Ot()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.kt()&&(i=i.Pt()),i.right.K()||i.right.kt()||i.right.left.kt()||(i=i.Ft()),0===e(t,i.key)){if(i.right.K())return jr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.Dt())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.Nt()},jr.prototype.kt=function(){return this.color},jr.prototype.Nt=function(){var t=this;return t.right.kt()&&!t.left.kt()&&(t=t.Vt()),t.left.kt()&&t.left.left.kt()&&(t=t.Pt()),t.left.kt()&&t.right.kt()&&(t=t.Ut()),t},jr.prototype.Ot=function(){var t=this.Ut();return t.right.left.kt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).Vt()).Ut()),t},jr.prototype.Ft=function(){var t=this.Ut();return t.left.left.kt()&&(t=(t=t.Pt()).Ut()),t},jr.prototype.Vt=function(){var t=this.copy(null,null,jr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},jr.prototype.Pt=function(){var t=this.copy(null,null,jr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},jr.prototype.Ut=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},jr.prototype.jt=function(){var t=this.Lt();return Math.pow(2,t)<=this.size+1},jr.prototype.Lt=function(){if(this.kt()&&this.left.kt())throw Iu("Red node has red child("+this.key+","+this.value+")");if(this.right.kt())throw Iu("Right child of ("+this.key+","+this.value+") is red");var t=this.left.Lt();if(t!==this.right.Lt())throw Iu("Black depths differ");return t+(this.kt()?0:1)},jr.EMPTY=null,jr.RED=!0,jr.vt=!1,jr),xr=(Object.defineProperty(Gr.prototype,"key",{get:function(){throw Iu("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(Gr.prototype,"value",{get:function(){throw Iu("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(Gr.prototype,"color",{get:function(){throw Iu("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(Gr.prototype,"left",{get:function(){throw Iu("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(Gr.prototype,"right",{get:function(){throw Iu("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),Gr.prototype.copy=function(t,e,n,i,r){return this},Gr.prototype.dt=function(t,e,n){return new qr(t,e)},Gr.prototype.remove=function(t,e){return this},Gr.prototype.K=function(){return!0},Gr.prototype.pt=function(t){return!1},Gr.prototype.bt=function(t){return!1},Gr.prototype.wt=function(){return null},Gr.prototype.gt=function(){return null},Gr.prototype.kt=function(){return!1},Gr.prototype.jt=function(){return!0},Gr.prototype.Lt=function(){return 0},Gr);function Gr(){this.size=0}function jr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:jr.RED,this.left=null!=i?i:jr.EMPTY,this.right=null!=r?r:jr.EMPTY,this.size=this.left.size+1+this.right.size}function Br(t,e,n,i){this.St=i,this.It=[];for(var r=1;!t.K();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.St?t.left:t.right;else{if(0===r){this.It.push(t);break}this.It.push(t),t=this.St?t.right:t.left}}function Yr(t,e){this.G=t,this.root=e||qr.EMPTY}function Hr(t){this.path=t,Nu(Hr.ct(t),"Invalid DocumentKey with an odd number of segments: "+t.nt().join("/"))}function zr(){return null!==Ar&&Ar.apply(this,arguments)||this}function Kr(){return null!==Sr&&Sr.apply(this,arguments)||this}function Wr(t,e,n){void 0===e?e=0:e>t.length&&Iu("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&Iu("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n}function Qr(t){this.timestamp=t}function Xr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Vi(Fi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Vi(Fi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Vi(Fi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Vi(Fi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function $r(t,e){if(nr("GeoPoint",arguments,2),or("GeoPoint","number",1,t),or("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Vi(Fi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Vi(Fi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.V=t,this.U=e}function Zr(t){Tr(),this.R=t}qr.EMPTY=new xr;var Jr=(co.qt=function(t){var e=new co(t.G);return t.forEach(function(t){e=e.add(t)}),e},co.prototype.has=function(t){return null!==this.data.get(t)},co.prototype.first=function(){return this.data.wt()},co.prototype.last=function(){return this.data.gt()},Object.defineProperty(co.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),co.prototype.indexOf=function(t){return this.data.indexOf(t)},co.prototype.forEach=function(n){this.data.pt(function(t,e){return n(t),!1})},co.prototype.Mt=function(t,e){for(var n=this.data._t(t[0]);n.Ct();){var i=n.At();if(0<=this.G(i.key,t[1]))return;e(i.key)}},co.prototype.xt=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.yt();n.Ct();)if(!t(n.At().key))return},co.prototype.Bt=function(t){var e=this.data._t(t);return e.Ct()?e.At().key:null},co.prototype.yt=function(){return new to(this.data.yt())},co.prototype._t=function(t){return new to(this.data._t(t))},co.prototype.add=function(t){return this.copy(this.data.remove(t).dt(t,!0))},co.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},co.prototype.K=function(){return this.data.K()},co.prototype.Qt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},co.prototype.isEqual=function(t){if(!(t instanceof co))return!1;if(this.size!==t.size)return!1;for(var e=this.data.yt(),n=t.data.yt();e.Ct();){var i=e.At().key,r=n.At().key;if(0!==this.G(i,r))return!1}return!0},co.prototype.nt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},co.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},co.prototype.copy=function(t){var e=new co(this.G);return e.data=t,e},co),to=(ho.prototype.At=function(){return this.Wt.At().key},ho.prototype.Ct=function(){return this.Wt.Ct()},ho),eo=(uo.prototype.Gt=function(t,e){return new ds(e,t)},uo.prototype.zt=function(t,e){return e},uo.prototype.Ht=function(t){return null},uo.prototype.isEqual=function(t){return t instanceof uo},uo.instance=new uo,uo),no=(ao.prototype.Gt=function(t,e){return this.apply(t)},ao.prototype.zt=function(t,e){return this.apply(t)},ao.prototype.apply=function(t){for(var n=fo(t),e=function(e){n.find(function(t){return t.isEqual(e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return new bs(n)},ao.prototype.Ht=function(t){return null},ao.prototype.isEqual=function(t){return t instanceof ao&&ku(t.elements,this.elements)},ao),io=(so.prototype.Gt=function(t,e){return this.apply(t)},so.prototype.zt=function(t,e){return this.apply(t)},so.prototype.apply=function(t){for(var n=fo(t),e=function(e){n=n.filter(function(t){return!t.isEqual(e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return new bs(n)},so.prototype.Ht=function(t){return null},so.prototype.isEqual=function(t){return t instanceof so&&ku(t.elements,this.elements)},so),ro=(oo.prototype.Gt=function(t,e){var n=this.Ht(t);if(n instanceof cs&&this.Jt instanceof cs){var i=n.Yt+this.Jt.Yt;return new cs(i)}return i=n.Yt+this.Jt.Yt,new fs(i)},oo.prototype.zt=function(t,e){return Nu(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},oo.prototype.Ht=function(t){return t instanceof Po?t:new cs(0)},oo.prototype.isEqual=function(t){return t instanceof oo&&this.Jt.isEqual(t.Jt)},oo);function oo(t){this.Jt=t}function so(t){this.elements=t}function ao(t){this.elements=t}function uo(){}function ho(t){this.Wt=t}function co(t){this.G=t,this.data=new Fr(this.G)}function fo(t){return t instanceof bs?t.Yt.slice():[]}function lo(t,e){this.version=t,this.transformResults=e}var po,vo,yo,go,mo,wo,bo,Eo,Io=(Qo.Kt=function(t){return new Qo(t)},Qo.Xt=function(t){var e=new Jr(Pr.G);return t.forEach(function(t){return e=e.add(t)}),new Qo(e)},Qo.prototype.$t=function(e){var n=!1;return this.fields.forEach(function(t){t.Z(e)&&(n=!0)}),n},Qo.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},Qo),No=(Wo.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},Wo),To=(Ko.exists=function(t){return new Ko(void 0,t)},Ko.updateTime=function(t){return new Ko(t)},Object.defineProperty(Ko.prototype,"Zt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),Ko.prototype.tn=function(t){return void 0!==this.updateTime?t instanceof Is&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof Is:(Nu(this.Zt,"Precondition should be empty"),!0)},Ko.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,!((null!=e?!n||!e.isEqual(n):e!==n)||this.exists!==t.exists);var e,n},Ko.NONE=new Ko,Ko),Ao=(zo.prototype.nn=function(t){null!=t&&Nu(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},zo.in=function(t){return t instanceof Is?t.version:Or.MIN},zo),So=(t(Ho,Eo=Ao),Ho.prototype.zt=function(t,e){this.nn(t),Nu(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new Is(this.key,n,{hasCommittedMutations:!0},this.value)},Ho.prototype.Gt=function(t,e,n){if(this.nn(t),!this.en.tn(t))return t;var i=Ao.in(t);return new Is(this.key,i,{rn:!0},this.value)},Ho.prototype.sn=function(t){return null},Ho.prototype.isEqual=function(t){return t instanceof Ho&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.en.isEqual(t.en)},Ho),ko=(t(Yo,bo=Ao),Yo.prototype.zt=function(t,e){if(this.nn(t),Nu(null==e.transformResults,"Transform results received by PatchMutation."),!this.en.tn(t))return new Ts(this.key,e.version);var n=this.on(t);return new Is(this.key,e.version,{hasCommittedMutations:!0},n)},Yo.prototype.Gt=function(t,e,n){if(this.nn(t),!this.en.tn(t))return t;var i=Ao.in(t),r=this.on(t);return new Is(this.key,i,{rn:!0},r)},Yo.prototype.sn=function(t){return null},Yo.prototype.isEqual=function(t){return t instanceof Yo&&this.key.isEqual(t.key)&&this.un.isEqual(t.un)&&this.en.isEqual(t.en)},Yo.prototype.on=function(t){var e;return e=t instanceof Is?t.data():ms.EMPTY,this.hn(e)},Yo.prototype.hn=function(t){var n=this,i=t.cn();return this.un.fields.forEach(function(t){if(!t.K()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.an()},Yo),Ro=(t(Bo,wo=Ao),Bo.prototype.zt=function(t,e){if(this.nn(t),Nu(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.en.tn(t))return new Ts(this.key,e.version);var n=this.fn(t),i=this.ln(t,e.transformResults),r=e.version,o=this.dn(n.data(),i);return new Is(this.key,r,{hasCommittedMutations:!0},o)},Bo.prototype.Gt=function(t,e,n){if(this.nn(t),!this.en.tn(t))return t;var i=this.fn(t),r=this.vn(n,t,e),o=this.dn(i.data(),r);return new Is(this.key,i.version,{rn:!0},o)},Bo.prototype.sn=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Is?t.field(r.field):void 0,s=r.transform.Ht(o||null);null!=s&&(e=null==e?ms.wn().set(r.field,s):e.set(r.field,s))}return e?e.an():null},Bo.prototype.isEqual=function(t){return t instanceof Bo&&this.key.isEqual(t.key)&&ku(this.fieldTransforms,t.fieldTransforms)&&this.en.isEqual(t.en)},Bo.prototype.fn=function(t){return Nu(t instanceof Is,"Unknown MaybeDocument type "+t),Nu(t.key.isEqual(this.key),"Can only transform a document with the same key"),t},Bo.prototype.ln=function(t,e){var n=[];Nu(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof Is&&(s=t.field(r.field)),n.push(o.zt(s,e[i]))}return n},Bo.prototype.vn=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],a=s.transform,u=null;e instanceof Is&&(u=e.field(s.field)),null===u&&n instanceof Is&&(u=n.field(s.field)),i.push(a.Gt(u,t))}return i},Bo.prototype.dn=function(t,e){Nu(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=t.cn(),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.an()},Bo),Do=(t(jo,mo=Ao),jo.prototype.zt=function(t,e){return this.nn(t),Nu(null==e.transformResults,"Transform results received by DeleteMutation."),new Ns(this.key,e.version,{hasCommittedMutations:!0})},jo.prototype.Gt=function(t,e,n){return this.nn(t),this.en.tn(t)?(t&&Nu(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new Ns(this.key,Or.q())):t},jo.prototype.sn=function(t){return null},jo.prototype.isEqual=function(t){return t instanceof jo&&this.key.isEqual(t.key)&&this.en.isEqual(t.en)},jo),Co=(t(Go,go=Ao),Go.prototype.zt=function(t,e){Iu("VerifyMutation should only be used in Transactions.")},Go.prototype.Gt=function(t,e,n){Iu("VerifyMutation should only be used in Transactions.")},Go.prototype.sn=function(t){Iu("VerifyMutation should only be used in Transactions.")},Go.prototype.isEqual=function(t){return t instanceof Go&&this.key.isEqual(t.key)&&this.en.isEqual(t.en)},Go),Oo=(xo.gn=function(t,e){switch(t.serverTimestamps){case"estimate":return new xo(1,e);case"previous":return new xo(2,e);case"none":case void 0:return new xo(0,e);default:return Iu("fromSnapshotOptions() called with invalid options.")}},xo),Lo=(qo.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},qo.prototype.pn=function(t){return Nu(this.bn!==t.bn,"Default compareTo should not be used for values of same type."),Su(this.bn,t.bn)},qo),_o=(t(Vo,yo=Lo),Vo.prototype.value=function(t){return null},Vo.prototype.isEqual=function(t){return t instanceof Vo},Vo.prototype.M=function(t){return t instanceof Vo?0:this.pn(t)},Vo.prototype.D=function(){return 4},Vo.yn=new Vo,Vo),Uo=(t(Fo,vo=Lo),Fo.prototype.value=function(t){return this.Yt},Fo.prototype.isEqual=function(t){return t instanceof Fo&&this.Yt===t.Yt},Fo.prototype.M=function(t){return t instanceof Fo?Su(this.Yt,t.Yt):this.pn(t)},Fo.prototype.D=function(){return 4},Fo.of=function(t){return t?Fo._n:Fo.Tn},Fo._n=new Fo(!0),Fo.Tn=new Fo(!1),Fo),Po=(t(Mo,po=Lo),Mo.prototype.value=function(t){return this.Yt},Mo.prototype.M=function(t){return t instanceof Mo?(e=this.Yt)<(n=t.Yt)?-1:n<e?1:e===n?0:isNaN(e)?isNaN(n)?0:-1:1:this.pn(t);var e,n},Mo.prototype.D=function(){return 8},Mo);function Mo(t){var e=po.call(this)||this;return e.Yt=t,e.bn=2,e}function Fo(t){var e=vo.call(this)||this;return e.Yt=t,e.bn=1,e}function Vo(){var t=yo.call(this)||this;return t.bn=0,t.Yt=null,t}function qo(){}function xo(t,e){this.mn=t,this.timestampsInSnapshots=e}function Go(t,e){var n=go.call(this)||this;return n.key=t,n.en=e,n.type=4,n}function jo(t,e){var n=mo.call(this)||this;return n.key=t,n.en=e,n.type=3,n}function Bo(t,e){var n=wo.call(this)||this;return n.key=t,n.fieldTransforms=e,n.type=2,n.en=To.exists(!0),n}function Yo(t,e,n,i){var r=bo.call(this)||this;return r.key=t,r.data=e,r.un=n,r.en=i,r.type=1,r}function Ho(t,e,n){var i=Eo.call(this)||this;return i.key=t,i.value=e,i.en=n,i.type=0,i}function zo(){}function Ko(t,e){this.updateTime=t,this.exists=e,Nu(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}function Wo(t,e){this.field=t,this.transform=e}function Qo(t){this.fields=t}function Xo(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var $o,Zo,Jo,ts,es,ns,is,rs,os,ss,as,us,hs,cs=(t(qs,hs=Po),qs.prototype.isEqual=function(t){return t instanceof qs&&Xo(this.Yt,t.Yt)},qs),fs=(t(Vs,us=Po),Vs.prototype.isEqual=function(t){return t instanceof Vs&&Xo(this.Yt,t.Yt)},Vs.En=new Vs(NaN),Vs.POSITIVE_INFINITY=new Vs(1/0),Vs.NEGATIVE_INFINITY=new Vs(-1/0),Vs),ls=(t(Fs,as=Lo),Fs.prototype.value=function(t){return this.Yt},Fs.prototype.isEqual=function(t){return t instanceof Fs&&this.Yt===t.Yt},Fs.prototype.M=function(t){return t instanceof Fs?Su(this.Yt,t.Yt):this.pn(t)},Fs.prototype.D=function(){return 2*this.Yt.length},Fs),ps=(t(Ms,ss=Lo),Ms.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.Yt:this.Yt.toDate()},Ms.prototype.isEqual=function(t){return t instanceof Ms&&this.Yt.isEqual(t.Yt)},Ms.prototype.M=function(t){return t instanceof Ms?this.Yt.F(t.Yt):t instanceof ds?-1:this.pn(t)},Ms.prototype.D=function(){return 16},Ms),ds=(t(Ps,os=Lo),Ps.prototype.value=function(t){return t&&1===t.mn?new ps(this.Sn).value(t):t&&2===t.mn&&this.previousValue?this.previousValue.value(t):null},Ps.prototype.isEqual=function(t){return t instanceof Ps&&this.Sn.isEqual(t.Sn)},Ps.prototype.M=function(t){return t instanceof Ps?this.Sn.F(t.Sn):t instanceof ps?1:this.pn(t)},Ps.prototype.toString=function(){return"<ServerTimestamp localTime="+this.Sn.toString()+">"},Ps.prototype.D=function(){return 16+(this.previousValue?this.previousValue.D():0)},Ps),vs=(t(Us,rs=Lo),Us.prototype.value=function(t){return this.Yt},Us.prototype.isEqual=function(t){return t instanceof Us&&this.Yt.isEqual(t.Yt)},Us.prototype.M=function(t){return t instanceof Us?this.Yt.F(t.Yt):this.pn(t)},Us.prototype.D=function(){return this.Yt.P()},Us),ys=(t(_s,is=Lo),_s.prototype.value=function(t){return this.key},_s.prototype.isEqual=function(t){return t instanceof _s&&this.key.isEqual(t.key)&&this.In.isEqual(t.In)},_s.prototype.M=function(t){if(t instanceof _s){var e=this.In.M(t.In);return 0!==e?e:Mr.G(this.key,t.key)}return this.pn(t)},_s.prototype.D=function(){return this.In.projectId.length+this.In.database.length+this.key.toString().length},_s),gs=(t(Ls,ns=Lo),Ls.prototype.value=function(t){return this.Yt},Ls.prototype.isEqual=function(t){return t instanceof Ls&&this.Yt.isEqual(t.Yt)},Ls.prototype.M=function(t){return t instanceof Ls?this.Yt.F(t.Yt):this.pn(t)},Ls.prototype.D=function(){return 16},Ls),ms=(t(Os,es=Lo),Os.wn=function(){return new ws(Os.EMPTY.Yt)},Os.prototype.value=function(n){var i={};return this.Yt.pt(function(t,e){i[t]=e.value(n)}),i},Os.prototype.forEach=function(t){this.Yt.pt(t)},Os.prototype.isEqual=function(t){if(t instanceof Os){for(var e=this.Yt.yt(),n=t.Yt.yt();e.Ct()&&n.Ct();){var i=e.At(),r=n.At();if(i.key!==r.key||!i.value.isEqual(r.value))return!1}return!e.Ct()&&!n.Ct()}return!1},Os.prototype.M=function(t){if(t instanceof Os){for(var e=this.Yt.yt(),n=t.Yt.yt();e.Ct()&&n.Ct();){var i=e.At(),r=n.At(),o=Su(i.key,r.key)||i.value.M(r.value);if(o)return o}return Su(e.Ct(),n.Ct())}return this.pn(t)},Os.prototype.contains=function(t){return null!==this.field(t)},Os.prototype.field=function(t){Nu(!t.K(),"Can't get field of empty path");var e=this;return t.forEach(function(t){e=e instanceof Os?e.Yt.get(t):null}),e},Os.prototype.un=function(){var r=new Jr(Pr.G);return this.Yt.forEach(function(t,e){var n=new Pr([t]);if(e instanceof Os){var i=e.un().fields;i.K()?r=r.add(n):i.forEach(function(t){r=r.add(n.child(t))})}else r=r.add(n)}),Io.Kt(r)},Os.prototype.D=function(){var n=0;return this.Yt.pt(function(t,e){n+=t.length+e.D()}),n},Os.prototype.toString=function(){return this.Yt.toString()},Os.prototype.cn=function(){return new ws(this.Yt)},Os.EMPTY=new Os(new Fr(Su)),Os),ws=(Cs.prototype.set=function(t,e){Nu(!t.K(),"Cannot set field for empty path on ObjectValue");var n=t.X();if(1===t.length)this.Yt=this.Yt.dt(n,e);else{var i=this.Yt.get(n),r=(i instanceof ms?i:ms.EMPTY).cn().set(t.J(),e).an();this.Yt=this.Yt.dt(n,r)}return this},Cs.prototype.delete=function(t){Nu(!t.K(),"Cannot delete field for empty path on ObjectValue");var e=t.X();if(1===t.length)this.Yt=this.Yt.remove(e);else{var n=this.Yt.get(e);if(n instanceof ms){var i=n.cn().delete(t.J()).an();this.Yt=this.Yt.dt(t.X(),i)}}return this},Cs.prototype.an=function(){return new ms(this.Yt)},Cs),bs=(t(Ds,ts=Lo),Ds.prototype.value=function(e){return this.Yt.map(function(t){return t.value(e)})},Ds.prototype.contains=function(t){for(var e=0,n=this.Yt;e<n.length;e++)if(n[e].isEqual(t))return!0;return!1},Ds.prototype.forEach=function(t){this.Yt.forEach(t)},Ds.prototype.isEqual=function(t){if(t instanceof Ds){if(this.Yt.length!==t.Yt.length)return!1;for(var e=0;e<this.Yt.length;e++)if(!this.Yt[e].isEqual(t.Yt[e]))return!1;return!0}return!1},Ds.prototype.M=function(t){if(t instanceof Ds){for(var e=Math.min(this.Yt.length,t.Yt.length),n=0;n<e;n++){var i=this.Yt[n].M(t.Yt[n]);if(i)return i}return Su(this.Yt.length,t.Yt.length)}return this.pn(t)},Ds.prototype.D=function(){return this.Yt.reduce(function(t,e){return t+e.D()},0)},Ds.prototype.toString=function(){return"["+this.Yt.map(function(t){return t.toString()}).join(",")+"]"},Ds),Es=(Rs.An=function(t,e){return Mr.G(t.key,e.key)},Rs),Is=(t(ks,Jo=Es),ks.prototype.field=function(t){if(this.Cn)return this.Cn.field(t);this.Rn||(this.Rn=new Map);var e=t.it(),n=this.Rn.get(e);if(void 0===n){var i=this.Nn(t);n=void 0===i?null:this.converter(i),this.Rn.set(e,n)}return n},ks.prototype.data=function(){var n=this;if(!this.Cn){var i=ms.wn();Ji(this.proto.fields||{},function(t,e){i.set(new Pr([t]),n.converter(e))}),this.Cn=i.an(),this.Rn=void 0}return this.Cn},ks.prototype.value=function(){return this.data().value()},ks.prototype.isEqual=function(t){return t instanceof ks&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.rn===t.rn&&this.hasCommittedMutations===t.hasCommittedMutations&&this.data().isEqual(t.data())},ks.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.rn+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(ks.prototype,"hasPendingWrites",{get:function(){return this.rn||this.hasCommittedMutations},enumerable:!0,configurable:!0}),ks.prototype.Nn=function(t){Nu(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var e=this.proto.fields?this.proto.fields[t.X()]:void 0,n=1;n<t.length;++n){if(!e||!e.mapValue||!e.mapValue.fields)return;e=e.mapValue.fields[t.get(n)]}return e},ks.Dn=function(t,e,n){var i=e.field(t),r=n.field(t);return null!==i&&null!==r?i.M(r):Iu("Trying to compare documents on fields that don't exist")},ks),Ns=(t(Ss,Zo=Es),Ss.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ss.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Ss.prototype.isEqual=function(t){return t instanceof Ss&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ss),Ts=(t(As,$o=Es),As.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(As.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),As.prototype.isEqual=function(t){return t instanceof As&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},As);function As(){return null!==$o&&$o.apply(this,arguments)||this}function Ss(t,e,n){var i=Zo.call(this,t,e)||this;return i.hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function ks(t,e,n,i,r,o){var s=Jo.call(this,t,e)||this;return s.Cn=i,s.proto=r,s.converter=o,Nu(void 0!==s.Cn||void 0!==s.proto&&void 0!==s.converter,"If objectValue is not defined, proto and converter need to be set."),s.rn=!!n.rn,s.hasCommittedMutations=!!n.hasCommittedMutations,s}function Rs(t,e){this.key=t,this.version=e}function Ds(t){var e=ts.call(this)||this;return e.Yt=t,e.bn=8,e}function Cs(t){this.Yt=t}function Os(t){var e=es.call(this)||this;return e.Yt=t,e.bn=9,e}function Ls(t){var e=ns.call(this)||this;return e.Yt=t,e.bn=7,e}function _s(t,e){var n=is.call(this)||this;return n.In=t,n.key=e,n.bn=6,n}function Us(t){var e=rs.call(this)||this;return e.Yt=t,e.bn=5,e}function Ps(t,e){var n=os.call(this)||this;return n.Sn=t,n.previousValue=e,n.bn=3,n}function Ms(t){var e=ss.call(this)||this;return e.Yt=t,e.bn=3,e}function Fs(t){var e=as.call(this)||this;return e.Yt=t,e.bn=4,e}function Vs(){return null!==us&&us.apply(this,arguments)||this}function qs(){return null!==hs&&hs.apply(this,arguments)||this}function xs(t){return null==t}function Gs(t){return-0===t&&1/t==-1/0}function js(t){return"number"==typeof t&&Number.isInteger(t)&&!Gs(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Bs,Ys,Hs,zs,Ks,Ws,Qs,Xs,$s=(Sa.prototype.canonicalId=function(){if(null===this.kn){var t=this.path.it();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:";for(var e=0,n=this.filters;e<n.length;e++)t+=n[e].canonicalId(),t+=",";t+="|ob:";for(var i=0,r=this.orderBy;i<r.length;i++)t+=r[i].canonicalId(),t+=",";xs(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.kn=t}return this.kn},Sa.prototype.toString=function(){var t=this.path.it();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),xs(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Sa.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Sa.prototype.On=function(){return Mr.ct(this.path)&&null===this.collectionGroup&&0===this.filters.length},Sa),Zs=(Aa.Ln=function(t){return new Aa(t)},Object.defineProperty(Aa.prototype,"orderBy",{get:function(){if(null===this.Vn){var t=this.qn(),e=this.Mn();if(null!==t&&null===e)t.ut()?this.Vn=[ha]:this.Vn=[new ua(t),ha];else{Nu(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field.");for(var n=!(this.Vn=[]),i=0,r=this.Pn;i<r.length;i++){var o=r[i];this.Vn.push(o),o.field.ut()&&(n=!0)}if(!n){var s=0<this.Pn.length?this.Pn[this.Pn.length-1].dir:sa.ASCENDING;this.Vn.push(s===sa.ASCENDING?ha:ca)}}}return this.Vn},enumerable:!0,configurable:!0}),Aa.prototype.xn=function(t){Nu(null==this.qn()||!(t instanceof ta)||!t.Bn()||t.field.isEqual(this.qn()),"Query must only have one inequality field."),Nu(!this.On(),"No filtering allowed for document query");var e=this.filters.concat([t]);return new Aa(this.path,this.collectionGroup,this.Pn.slice(),e,this.limit,this.Fn,this.startAt,this.endAt)},Aa.prototype.Qn=function(t){Nu(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var e=this.Pn.concat([t]);return new Aa(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.Fn,this.startAt,this.endAt)},Aa.prototype.Wn=function(t){return new Aa(this.path,this.collectionGroup,this.Pn.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},Aa.prototype.Gn=function(t){return new Aa(this.path,this.collectionGroup,this.Pn.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},Aa.prototype.zn=function(t){return new Aa(this.path,this.collectionGroup,this.Pn.slice(),this.filters.slice(),this.limit,this.Fn,t,this.endAt)},Aa.prototype.Hn=function(t){return new Aa(this.path,this.collectionGroup,this.Pn.slice(),this.filters.slice(),this.limit,this.Fn,this.startAt,t)},Aa.prototype.Jn=function(t){return new Aa(t,null,this.Pn.slice(),this.filters.slice(),this.limit,this.Fn,this.startAt,this.endAt)},Aa.prototype.Yn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Pn.length||1===this.Pn.length&&this.Pn[0].field.ut())},Aa.prototype.canonicalId=function(){return this.Kn().canonicalId()+"|lt:"+this.Fn},Aa.prototype.toString=function(){return"Query(target="+this.Kn().toString()+"; limitType="+this.Fn+")"},Aa.prototype.isEqual=function(t){return this.Kn().isEqual(t.Kn())&&this.Fn===t.Fn},Aa.prototype.Xn=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.ut()}return Nu(n,"orderBy used that doesn't compare on key field"),0},Aa.prototype.matches=function(t){return this.$n(t)&&this.Zn(t)&&this.ti(t)&&this.ni(t)},Aa.prototype.ii=function(){return!xs(this.limit)&&"F"===this.Fn},Aa.prototype.ei=function(){return!xs(this.limit)&&"L"===this.Fn},Aa.prototype.Mn=function(){return 0<this.Pn.length?this.Pn[0].field:null},Aa.prototype.qn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof ta&&n.Bn())return n.field}return null},Aa.prototype.ri=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof ta&&0<=t.indexOf(i.op))return i.op}return null},Aa.prototype.On=function(){return this.Kn().On()},Aa.prototype.si=function(){return null!==this.collectionGroup},Aa.prototype.Kn=function(){if(!this.Un)if("F"===this.Fn)this.Un=new $s(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r=i.dir===sa.DESCENDING?sa.ASCENDING:sa.DESCENDING;t.push(new ua(i.field,r))}var o=this.endAt?new aa(this.endAt.position,!this.endAt.before):null,s=this.startAt?new aa(this.startAt.position,!this.startAt.before):null;this.Un=new $s(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Un},Aa.prototype.$n=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.at(this.collectionGroup)&&this.path.Z(e):Mr.ct(this.path)?this.path.isEqual(e):this.path.tt(e)},Aa.prototype.Zn=function(t){for(var e=0,n=this.Pn;e<n.length;e++){var i=n[e];if(!i.field.ut()&&null===t.field(i.field))return!1}return!0},Aa.prototype.ti=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},Aa.prototype.ni=function(t){return!(this.startAt&&!this.startAt.ui(this.orderBy,t)||this.endAt&&this.endAt.ui(this.orderBy,t))},Aa.prototype.jn=function(t){Nu(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},Aa),Js=(Ta.et=function(t){switch(t){case"<":return Ta.LESS_THAN;case"<=":return Ta.LESS_THAN_OR_EQUAL;case"==":return Ta.EQUAL;case">=":return Ta.GREATER_THAN_OR_EQUAL;case">":return Ta.GREATER_THAN;case"array-contains":return Ta.ARRAY_CONTAINS;case"in":return Ta.IN;case"array-contains-any":return Ta.ARRAY_CONTAINS_ANY;default:return Iu("Unknown FieldFilter operator: "+t)}},Ta.prototype.toString=function(){return this.name},Ta.prototype.isEqual=function(t){return this.name===t.name},Ta.LESS_THAN=new Ta("<"),Ta.LESS_THAN_OR_EQUAL=new Ta("<="),Ta.EQUAL=new Ta("=="),Ta.GREATER_THAN=new Ta(">"),Ta.GREATER_THAN_OR_EQUAL=new Ta(">="),Ta.ARRAY_CONTAINS=new Ta("array-contains"),Ta.IN=new Ta("in"),Ta.ARRAY_CONTAINS_ANY=new Ta("array-contains-any"),Ta),ta=(t(Na,Xs=function(){}),Na.create=function(t,e,n){if(t.ut())return e===Js.IN?(Nu(n instanceof bs,"Comparing on key with IN, but filter value not an ArrayValue"),Nu(n.Yt.every(function(t){return t instanceof ys}),"Comparing on key with IN, but an array value was not a RefValue"),new na(t,n)):(Nu(n instanceof ys,"Comparing on key, but filter value not a RefValue"),Nu(e!==Js.ARRAY_CONTAINS&&e!==Js.ARRAY_CONTAINS_ANY,"'"+e.toString()+"' queries don't make sense on document keys."),new ea(t,e,n));if(n.isEqual(_o.yn)){if(e!==Js.EQUAL)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Na(t,e,n)}if(n.isEqual(fs.En)){if(e!==Js.EQUAL)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Na(t,e,n)}return e===Js.ARRAY_CONTAINS?new ia(t,n):e===Js.IN?(Nu(n instanceof bs,"IN filter has invalid value: "+n.toString()),new ra(t,n)):e===Js.ARRAY_CONTAINS_ANY?(Nu(n instanceof bs,"ARRAY_CONTAINS_ANY filter has invalid value: "+n.toString()),new oa(t,n)):new Na(t,e,n)},Na.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&this.value.bn===e.bn&&this.oi(e.M(this.value))},Na.prototype.oi=function(t){switch(this.op){case Js.LESS_THAN:return t<0;case Js.LESS_THAN_OR_EQUAL:return t<=0;case Js.EQUAL:return 0===t;case Js.GREATER_THAN:return 0<t;case Js.GREATER_THAN_OR_EQUAL:return 0<=t;default:return Iu("Unknown FieldFilter operator: "+this.op)}},Na.prototype.Bn=function(){return 0<=[Js.LESS_THAN,Js.LESS_THAN_OR_EQUAL,Js.GREATER_THAN,Js.GREATER_THAN_OR_EQUAL].indexOf(this.op)},Na.prototype.canonicalId=function(){return this.field.it()+this.op.toString()+this.value.toString()},Na.prototype.isEqual=function(t){return t instanceof Na&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value)},Na.prototype.toString=function(){return this.field.it()+" "+this.op+" "+this.value.value()},Na),ea=(t(Ia,Qs=ta),Ia.prototype.matches=function(t){var e=this.value,n=Mr.G(t.key,e.key);return this.oi(n)},Ia),na=(t(Ea,Ws=ta),Ea.prototype.matches=function(e){return this.value.Yt.some(function(t){return e.key.isEqual(t.key)})},Ea),ia=(t(ba,Ks=ta),ba.prototype.matches=function(t){var e=t.field(this.field);return e instanceof bs&&e.contains(this.value)},ba),ra=(t(wa,zs=ta),wa.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return null!==n&&e.contains(n)},wa),oa=(t(ma,Hs=ta),ma.prototype.matches=function(t){var e=this,n=t.field(this.field);return n instanceof bs&&n.Yt.some(function(t){return e.value.contains(t)})},ma),sa=(ga.prototype.toString=function(){return this.name},ga.ASCENDING=new ga("asc"),ga.DESCENDING=new ga("desc"),ga),aa=(ya.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++)t+=n[e].toString();return t},ya.prototype.ui=function(t,e){Nu(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i];if(r.field.ut())Nu(o instanceof ys,"Bound has a non-key value where the key path is being used."),n=Mr.G(o.key,e.key);else{var s=e.field(r.field);Nu(null!==s,"Field should exist since document matched the orderBy already."),n=o.M(s)}if(r.dir===sa.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},ya.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],i=t.position[e];if(!n.isEqual(i))return!1}return!0},ya),ua=(va.prototype.compare=function(t,e){var n=this.hi?Is.An(t,e):Is.Dn(this.field,t,e);switch(this.dir){case sa.ASCENDING:return n;case sa.DESCENDING:return-1*n;default:return Iu("Unknown direction: "+this.dir)}},va.prototype.canonicalId=function(){return this.field.it()+this.dir.toString()},va.prototype.toString=function(){return this.field.it()+" ("+this.dir+")"},va.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},va),ha=new ua(Pr.ot(),sa.ASCENDING),ca=new ua(Pr.ot(),sa.DESCENDING),fa=(da.prototype.fi=function(t){return new da(this.target,this.targetId,this.ci,t,this.ai,this.lastLimboFreeSnapshotVersion,this.resumeToken)},da.prototype.li=function(t,e){return new da(this.target,this.targetId,this.ci,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},da.prototype.di=function(t){return new da(this.target,this.targetId,this.ci,this.sequenceNumber,this.ai,t,this.resumeToken)},da.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.ci===t.ci&&this.sequenceNumber===t.sequenceNumber&&this.ai.isEqual(t.ai)&&this.lastLimboFreeSnapshotVersion.isEqual(t.lastLimboFreeSnapshotVersion)&&this.resumeToken.isEqual(t.resumeToken)&&this.target.isEqual(t.target)},da),la=(pa.prototype.isEqual=function(t){return t&&t.count===this.count},pa);function pa(t){this.count=t}function da(t,e,n,i,r,o,s){void 0===r&&(r=Or.MIN),void 0===o&&(o=Or.MIN),void 0===s&&(s=wr.k),this.target=t,this.targetId=e,this.ci=n,this.sequenceNumber=i,this.ai=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function va(t,e){this.field=t,void 0===e&&(e=sa.ASCENDING),this.dir=e,this.hi=t.ut()}function ya(t,e){this.position=t,this.before=e}function ga(t){this.name=t}function ma(t,e){var n=Hs.call(this,t,Js.ARRAY_CONTAINS_ANY,e)||this;return n.value=e,n}function wa(t,e){var n=zs.call(this,t,Js.IN,e)||this;return n.value=e,n}function ba(t,e){return Ks.call(this,t,Js.ARRAY_CONTAINS,e)||this}function Ea(t,e){var n=Ws.call(this,t,Js.IN,e)||this;return n.value=e,n}function Ia(){return null!==Qs&&Qs.apply(this,arguments)||this}function Na(t,e,n){var i=Xs.call(this)||this;return i.field=t,i.op=e,i.value=n,i}function Ta(t){this.name=t}function Aa(t,e,n,i,r,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.Pn=n,this.filters=i,this.limit=r,this.Fn=o,this.startAt=s,this.endAt=a,this.Vn=null,this.Un=null,this.startAt&&this.jn(this.startAt),this.endAt&&this.jn(this.endAt)}function Sa(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.kn=null}function ka(t){switch(t){case Fi.OK:return Iu("Treated status OK as error");case Fi.CANCELLED:case Fi.UNKNOWN:case Fi.DEADLINE_EXCEEDED:case Fi.RESOURCE_EXHAUSTED:case Fi.INTERNAL:case Fi.UNAVAILABLE:case Fi.UNAUTHENTICATED:return!1;case Fi.INVALID_ARGUMENT:case Fi.NOT_FOUND:case Fi.ALREADY_EXISTS:case Fi.PERMISSION_DENIED:case Fi.FAILED_PRECONDITION:case Fi.ABORTED:case Fi.OUT_OF_RANGE:case Fi.UNIMPLEMENTED:case Fi.DATA_LOSS:return!0;default:return Iu("Unknown status code: "+t)}}function Ra(t){if(void 0===t)return bu("GRPC error has no .code"),Fi.UNKNOWN;switch(t){case Bs.OK:return Fi.OK;case Bs.CANCELLED:return Fi.CANCELLED;case Bs.UNKNOWN:return Fi.UNKNOWN;case Bs.DEADLINE_EXCEEDED:return Fi.DEADLINE_EXCEEDED;case Bs.RESOURCE_EXHAUSTED:return Fi.RESOURCE_EXHAUSTED;case Bs.INTERNAL:return Fi.INTERNAL;case Bs.UNAVAILABLE:return Fi.UNAVAILABLE;case Bs.UNAUTHENTICATED:return Fi.UNAUTHENTICATED;case Bs.INVALID_ARGUMENT:return Fi.INVALID_ARGUMENT;case Bs.NOT_FOUND:return Fi.NOT_FOUND;case Bs.ALREADY_EXISTS:return Fi.ALREADY_EXISTS;case Bs.PERMISSION_DENIED:return Fi.PERMISSION_DENIED;case Bs.FAILED_PRECONDITION:return Fi.FAILED_PRECONDITION;case Bs.ABORTED:return Fi.ABORTED;case Bs.OUT_OF_RANGE:return Fi.OUT_OF_RANGE;case Bs.UNIMPLEMENTED:return Fi.UNIMPLEMENTED;case Bs.DATA_LOSS:return Fi.DATA_LOSS;default:return Iu("Unknown status code: "+t)}}(Ys=Bs=Bs||{})[Ys.OK=0]="OK",Ys[Ys.CANCELLED=1]="CANCELLED",Ys[Ys.UNKNOWN=2]="UNKNOWN",Ys[Ys.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ys[Ys.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ys[Ys.NOT_FOUND=5]="NOT_FOUND",Ys[Ys.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ys[Ys.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ys[Ys.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ys[Ys.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ys[Ys.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ys[Ys.ABORTED=10]="ABORTED",Ys[Ys.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ys[Ys.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ys[Ys.INTERNAL=13]="INTERNAL",Ys[Ys.UNAVAILABLE=14]="UNAVAILABLE",Ys[Ys.DATA_LOSS=15]="DATA_LOSS";var Da=new Fr(Mr.G);function Ca(){return Da}function Oa(){return Ca()}var La=new Fr(Mr.G);function _a(){return La}var Ua=new Fr(Mr.G);function Pa(){return Ua}var Ma=new Jr(Mr.G);function Fa(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ma,i=0,r=t;i<r.length;i++){var o=r[i];n=n.add(o)}return n}var Va=new Jr(Su);function qa(){return Va}function xa(t,e,n,i){this.Fi=t,this.removedTargetIds=e,this.key=n,this.Vi=i}function Ga(t,e){this.targetId=t,this.Ui=e}function ja(t,e,n,i){void 0===n&&(n=wr.k),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Ba=(nu.mi=function(t){return new nu(t.G)},nu.prototype.has=function(t){return null!=this.vi.get(t)},nu.prototype.get=function(t){return this.vi.get(t)},nu.prototype.first=function(){return this.wi.wt()},nu.prototype.last=function(){return this.wi.gt()},nu.prototype.K=function(){return this.wi.K()},nu.prototype.indexOf=function(t){var e=this.vi.get(t);return e?this.wi.indexOf(e):-1},Object.defineProperty(nu.prototype,"size",{get:function(){return this.wi.size},enumerable:!0,configurable:!0}),nu.prototype.forEach=function(n){this.wi.pt(function(t,e){return n(t),!1})},nu.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.vi.dt(t.key,t),e.wi.dt(t,null))},nu.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.vi.remove(t),this.wi.remove(e)):this},nu.prototype.isEqual=function(t){if(!(t instanceof nu))return!1;if(this.size!==t.size)return!1;for(var e=this.wi.yt(),n=t.wi.yt();e.Ct();){var i=e.At().key,r=n.At().key;if(!i.isEqual(r))return!1}return!0},nu.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},nu.prototype.copy=function(t,e){var n=new nu;return n.G=this.G,n.vi=t,n.wi=e,n},nu),Ya=(eu.prototype.track=function(t){var e=t.doc.key,n=this.gi.get(e);n?0!==t.type&&3===n.type?this.gi=this.gi.dt(e,t):3===t.type&&1!==n.type?this.gi=this.gi.dt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.gi=this.gi.dt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.gi=this.gi.dt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.gi=this.gi.remove(e):1===t.type&&2===n.type?this.gi=this.gi.dt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.gi=this.gi.dt(e,{type:2,doc:t.doc}):Iu("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.gi=this.gi.dt(e,t)},eu.prototype.pi=function(){var n=[];return this.gi.pt(function(t,e){n.push(e)}),n},eu),Ha=(tu.Ei=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new tu(t,e,Ba.mi(e),r,n,i,!0,!1)},Object.defineProperty(tu.prototype,"hasPendingWrites",{get:function(){return!this.yi.K()},enumerable:!0,configurable:!0}),tu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this._i===t._i&&this.yi.isEqual(t.yi)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.bi.isEqual(t.bi)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},tu),za=(Ja.Ri=function(t,e){var n,i=((n={})[t]=Ka.Ni(t,e),n);return new Ja(Or.MIN,i,qa(),Ca(),Fa())},Ja),Ka=(Za.Ni=function(t,e){return new Za(wr.k,e,Fa(),Fa(),Fa())},Za),Wa=(Object.defineProperty($a.prototype,"Di",{get:function(){return this.Mi},enumerable:!0,configurable:!0}),Object.defineProperty($a.prototype,"resumeToken",{get:function(){return this.qi},enumerable:!0,configurable:!0}),Object.defineProperty($a.prototype,"Bi",{get:function(){return 0!==this.ji},enumerable:!0,configurable:!0}),Object.defineProperty($a.prototype,"Qi",{get:function(){return this.xi},enumerable:!0,configurable:!0}),$a.prototype.Wi=function(t){0<t.D()&&(this.xi=!0,this.qi=t)},$a.prototype.Gi=function(){var n=Fa(),i=Fa(),r=Fa();return this.Li.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Iu("Encountered invalid change type: "+e)}}),new Ka(this.qi,this.Mi,n,i,r)},$a.prototype.zi=function(){this.xi=!1,this.Li=ru()},$a.prototype.Hi=function(t,e){this.xi=!0,this.Li=this.Li.dt(t,e)},$a.prototype.Ji=function(t){this.xi=!0,this.Li=this.Li.remove(t)},$a.prototype.Yi=function(){this.ji+=1},$a.prototype.Ki=function(){this.ji-=1},$a.prototype.Xi=function(){this.xi=!0,this.Mi=!0},$a),Qa=(Xa.prototype.ee=function(t){for(var e=0,n=t.Fi;e<n.length;e++){var i=n[e];t.Vi instanceof Is?this.re(i,t.Vi):t.Vi instanceof Ns&&this.se(i,t.key,t.Vi)}for(var r=0,o=t.removedTargetIds;r<o.length;r++)i=o[r],this.se(i,t.key,t.Vi)},Xa.prototype.ue=function(n){var i=this;this.oe(n,function(t){var e=i.he(t);switch(n.state){case 0:i.ce(t)&&e.Wi(n.resumeToken);break;case 1:e.Ki(),e.Bi||e.zi(),e.Wi(n.resumeToken);break;case 2:e.Ki(),e.Bi||i.removeTarget(t),Nu(!n.cause,"WatchChangeAggregator does not handle errored targets");break;case 3:i.ce(t)&&(e.Xi(),e.Wi(n.resumeToken));break;case 4:i.ce(t)&&(i.ae(t),e.Wi(n.resumeToken));break;default:Iu("Unknown target watch change state: "+n.state)}})},Xa.prototype.oe=function(t,e){0<t.targetIds.length?t.targetIds.forEach(e):Zi(this.Zi,e)},Xa.prototype.fe=function(t){var e=t.targetId,n=t.Ui.count,i=this.le(e);if(i){var r=i.target;if(r.On())if(0===n){var o=new Mr(r.path);this.se(e,o,new Ns(o,Or.q()))}else Nu(1===n,"Single document existence filter with count: "+n);else this.de(e)!==n&&(this.ae(e),this.ie=this.ie.add(e))}},Xa.prototype.ve=function(r){var o=this,s={};Zi(this.Zi,function(t,e){var n=o.le(t);if(n){if(e.Di&&n.target.On()){var i=new Mr(n.target.path);null!==o.te.get(i)||o.we(t,i)||o.se(t,i,new Ns(i,r))}e.Qi&&(s[t]=e.Gi(),e.zi())}});var i=Fa();this.ne.forEach(function(t,e){var n=!0;e.xt(function(t){var e=o.le(t);return!e||2===e.ci||(n=!1)}),n&&(i=i.add(t))});var t=new za(r,s,this.ie,this.te,i);return this.te=Ca(),this.ne=iu(),this.ie=new Jr(Su),t},Xa.prototype.re=function(t,e){if(this.ce(t)){var n=this.we(t,e.key)?2:0;this.he(t).Hi(e.key,n),this.te=this.te.dt(e.key,e),this.ne=this.ne.dt(e.key,this.me(e.key).add(t))}},Xa.prototype.se=function(t,e,n){if(this.ce(t)){var i=this.he(t);this.we(t,e)?i.Hi(e,1):i.Ji(e),this.ne=this.ne.dt(e,this.me(e).delete(t)),n&&(this.te=this.te.dt(e,n))}},Xa.prototype.removeTarget=function(t){delete this.Zi[t]},Xa.prototype.de=function(t){var e=this.he(t).Gi();return this.$i.ge(t).size+e.ki.size-e.Pi.size},Xa.prototype.Yi=function(t){this.he(t).Yi()},Xa.prototype.he=function(t){return this.Zi[t]||(this.Zi[t]=new Wa),this.Zi[t]},Xa.prototype.me=function(t){var e=this.ne.get(t);return e||(e=new Jr(Su),this.ne=this.ne.dt(t,e)),e},Xa.prototype.ce=function(t){var e=null!==this.le(t);return e||wu("WatchChangeAggregator","Detected inactive target",t),e},Xa.prototype.le=function(t){var e=this.Zi[t];return e&&e.Bi?null:this.$i.pe(t)},Xa.prototype.ae=function(e){var n=this;Nu(!this.Zi[e].Bi,"Should only reset active targets"),this.Zi[e]=new Wa,this.$i.ge(e).forEach(function(t){n.se(e,t,null)})},Xa.prototype.we=function(t,e){return this.$i.ge(t).has(e)},Xa);function Xa(t){this.$i=t,this.Zi={},this.te=Ca(),this.ne=iu(),this.ie=new Jr(Su)}function $a(){this.ji=0,this.Li=ru(),this.qi=wr.k,this.Mi=!1,this.xi=!0}function Za(t,e,n,i,r){this.resumeToken=t,this.Di=e,this.ki=n,this.Oi=i,this.Pi=r}function Ja(t,e,n,i,r){this.ai=t,this.Si=e,this.Ii=n,this.Ai=i,this.Ci=r}function tu(t,e,n,i,r,o,s,a){this.query=t,this.docs=e,this.bi=n,this.docChanges=i,this.yi=r,this.fromCache=o,this._i=s,this.Ti=a}function eu(){this.gi=new Fr(Mr.G)}function nu(n){this.G=n?function(t,e){return n(t,e)||Mr.G(t.key,e.key)}:function(t,e){return Mr.G(t.key,e.key)},this.vi=_a(),this.wi=new Fr(this.G)}function iu(){return new Fr(Mr.G)}function ru(){return new Fr(Mr.G)}var ou,su,au=((ou={})[sa.ASCENDING.name]="ASCENDING",ou[sa.DESCENDING.name]="DESCENDING",ou),uu=((su={})[Js.LESS_THAN.name]="LESS_THAN",su[Js.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",su[Js.GREATER_THAN.name]="GREATER_THAN",su[Js.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",su[Js.EQUAL.name]="EQUAL",su[Js.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",su[Js.IN.name]="IN",su[Js.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",su),hu=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cu(t,e){Nu(!xs(t),e+" is missing")}function fu(t){return"number"==typeof t?t:"string"==typeof t?Number(t):Iu("can't parse "+t)}var lu=(yu.prototype.be=function(t){var e=void 0===t.code?Fi.UNKNOWN:Ra(t.code);return new Vi(e,t.message||"")},yu.prototype.ye=function(t){return this.options._e||xs(t)?t:{value:t}},yu.prototype.Te=function(t){var e;return xs(e="object"==typeof t?t.value:t)?null:e},yu.prototype.W=function(t){return this.options._e?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},yu.prototype.L=function(t){if("string"==typeof t)return this.Ee(t);Nu(!!t,"Cannot deserialize null or undefined timestamp.");var e=fu(t.seconds||"0"),n=t.nanos||0;return new Cr(e,n)},yu.prototype.Ee=function(t){var e=0,n=hu.exec(t);if(Nu(!!n,"invalid timestamp: "+t),n[1]){var i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}var r=new Date(t),o=Math.floor(r.getTime()/1e3);return new Cr(o,e)},yu.prototype.Se=function(t){return this.options._e?t.toBase64():t.toUint8Array()},yu.prototype.Ie=function(t){return this.options._e?(Nu(void 0===t||"string"==typeof t,"value must be undefined or a string when using proto3 Json"),wr.fromBase64String(t||"")):(Nu(void 0===t||t instanceof Uint8Array,"value must be undefined or Uint8Array"),wr.fromUint8Array(t||new Uint8Array))},yu.prototype.Ae=function(t){return"string"==typeof t?(Nu(this.options._e,"Expected bytes to be passed in as Uint8Array, but got a string instead."),kr.fromBase64String(t)):(Nu(!this.options._e,"Expected bytes to be passed in as Uint8Array, but got a string instead."),kr.fromUint8Array(t))},yu.prototype.toVersion=function(t){return this.W(t.W())},yu.prototype.fromVersion=function(t){return Nu(!!t,"Trying to deserialize version that isn't set"),Or.L(this.L(t))},yu.prototype.Ce=function(t,e){return this.Re(t).child("documents").child(e).it()},yu.prototype.Ne=function(t){var e=_r.et(t);return Nu(this.De(e),"Tried to deserialize invalid key "+e.toString()),e},yu.prototype.ke=function(t){return this.Ce(this.In,t.path)},yu.prototype.Oe=function(t){var e=this.Ne(t);return Nu(e.get(1)===this.In.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.In.projectId),Nu(!e.get(3)&&!this.In.database||e.get(3)===this.In.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.In.database),new Mr(this.Pe(e))},yu.prototype.Fe=function(t){return this.Ce(this.In,t)},yu.prototype.Ve=function(t){var e=this.Ne(t);return 4===e.length?_r.rt:this.Pe(e)},Object.defineProperty(yu.prototype,"Ue",{get:function(){return new _r(["projects",this.In.projectId,"databases",this.In.database]).it()},enumerable:!0,configurable:!0}),yu.prototype.Re=function(t){return new _r(["projects",t.projectId,"databases",t.database])},yu.prototype.Pe=function(t){return Nu(4<t.length&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.J(5)},yu.prototype.De=function(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)},yu.prototype.je=function(t){if(t instanceof _o)return{nullValue:"NULL_VALUE"};if(t instanceof Uo)return{booleanValue:t.value()};if(t instanceof cs)return{integerValue:""+t.value()};if(t instanceof fs){var e=t.value();if(this.options._e){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"};if(Gs(e))return{doubleValue:"-0"}}return{doubleValue:t.value()}}return t instanceof ls?{stringValue:t.value()}:t instanceof ms?{mapValue:this.Le(t)}:t instanceof bs?{arrayValue:this.qe(t)}:t instanceof ps?{timestampValue:this.W(t.Yt)}:t instanceof gs?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof vs?{bytesValue:this.Se(t.value())}:t instanceof ys?{referenceValue:this.Ce(t.In,t.key.path)}:Iu("Unknown FieldValue "+JSON.stringify(t))},yu.prototype.Me=function(t){var e=this;if("nullValue"in t)return _o.yn;if("booleanValue"in t)return Uo.of(t.booleanValue);if("integerValue"in t)return new cs(fu(t.integerValue));if("doubleValue"in t){if(this.options._e){if("NaN"===t.doubleValue)return fs.En;if("Infinity"===t.doubleValue)return fs.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return fs.NEGATIVE_INFINITY;if("-0"===t.doubleValue)return new fs(-0)}return new fs(t.doubleValue)}if("stringValue"in t)return new ls(t.stringValue);if("mapValue"in t)return this.xe(t.mapValue.fields||{});if("arrayValue"in t){cu(t.arrayValue,"arrayValue");var n=t.arrayValue.values||[];return new bs(n.map(function(t){return e.Me(t)}))}if("timestampValue"in t)return cu(t.timestampValue,"timestampValue"),new ps(this.L(t.timestampValue));if("geoPointValue"in t){cu(t.geoPointValue,"geoPointValue");var i=t.geoPointValue.latitude||0,r=t.geoPointValue.longitude||0;return new gs(new Dr(i,r))}if("bytesValue"in t){cu(t.bytesValue,"bytesValue");var o=this.Ae(t.bytesValue);return new vs(o)}if("referenceValue"in t){cu(t.referenceValue,"referenceValue");var s=this.Ne(t.referenceValue),a=new Cu(s.get(1),s.get(3)),u=new Mr(this.Pe(s));return new ys(a,u)}return Iu("Unknown Value proto "+JSON.stringify(t))},yu.prototype.Be=function(t,e){return{name:this.ke(t),fields:this.Qe(e)}},yu.prototype.We=function(t){return Nu(!t.rn,"Can't serialize documents with mutations."),{name:this.ke(t.key),fields:this.Qe(t.data()),updateTime:this.W(t.version.W())}},yu.prototype.Ge=function(t,e){var n=this,i=this.Oe(t.name),r=this.fromVersion(t.updateTime);return new Is(i,r,{hasCommittedMutations:!!e},void 0,t,function(t){return n.Me(t)})},yu.prototype.Qe=function(t){var n=this,i={};return t.forEach(function(t,e){i[t]=n.je(e)}),i},yu.prototype.xe=function(t){var n=this,e=t,i=ms.wn();return Ji(e,function(t,e){i.set(new Pr([t]),n.Me(e))}),i.an()},yu.prototype.Le=function(t){return{fields:this.Qe(t)}},yu.prototype.qe=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.je(t))}),{values:n}},yu.prototype.ze=function(t){var e=this;Nu(!!t.found,"Tried to deserialize a found document from a missing document."),cu(t.found.name,"doc.found.name"),cu(t.found.updateTime,"doc.found.updateTime");var n=this.Oe(t.found.name),i=this.fromVersion(t.found.updateTime);return new Is(n,i,{},void 0,t.found,function(t){return e.Me(t)})},yu.prototype.He=function(t){Nu(!!t.missing,"Tried to deserialize a missing document from a found document."),Nu(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.Oe(t.missing),n=this.fromVersion(t.readTime);return new Ns(e,n)},yu.prototype.Je=function(t){return"found"in t?this.ze(t):"missing"in t?this.He(t):Iu("invalid batch get response: "+JSON.stringify(t))},yu.prototype.Ye=function(t){switch(t){case 1:return"ADD";case 3:return"CURRENT";case 0:return"NO_CHANGE";case 2:return"REMOVE";case 4:return"RESET";default:return Iu("Unknown WatchTargetChangeState: "+t)}},yu.prototype.Ke=function(t){if(t instanceof Ga)return{filter:{count:t.Ui.count,targetId:t.targetId}};if(t instanceof xa){if(t.Vi instanceof Is){var e=t.Vi;return{documentChange:{document:{name:this.ke(e.key),fields:this.Qe(e.data()),updateTime:this.toVersion(e.version)},targetIds:t.Fi,removedTargetIds:t.removedTargetIds}}}if(t.Vi instanceof Ns)return e=t.Vi,{documentDelete:{document:this.ke(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}};if(null===t.Vi)return{documentRemove:{document:this.ke(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof ja){var n=void 0;return t.cause&&(n={code:function(t){if(void 0===t)return Bs.OK;switch(t){case Fi.OK:return Bs.OK;case Fi.CANCELLED:return Bs.CANCELLED;case Fi.UNKNOWN:return Bs.UNKNOWN;case Fi.DEADLINE_EXCEEDED:return Bs.DEADLINE_EXCEEDED;case Fi.RESOURCE_EXHAUSTED:return Bs.RESOURCE_EXHAUSTED;case Fi.INTERNAL:return Bs.INTERNAL;case Fi.UNAVAILABLE:return Bs.UNAVAILABLE;case Fi.UNAUTHENTICATED:return Bs.UNAUTHENTICATED;case Fi.INVALID_ARGUMENT:return Bs.INVALID_ARGUMENT;case Fi.NOT_FOUND:return Bs.NOT_FOUND;case Fi.ALREADY_EXISTS:return Bs.ALREADY_EXISTS;case Fi.PERMISSION_DENIED:return Bs.PERMISSION_DENIED;case Fi.FAILED_PRECONDITION:return Bs.FAILED_PRECONDITION;case Fi.ABORTED:return Bs.ABORTED;case Fi.OUT_OF_RANGE:return Bs.OUT_OF_RANGE;case Fi.UNIMPLEMENTED:return Bs.UNIMPLEMENTED;case Fi.DATA_LOSS:return Bs.DATA_LOSS;default:return Iu("Unknown status code: "+t)}}(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.Ye(t.state),targetIds:t.targetIds,resumeToken:this.Se(t.resumeToken),cause:n}}}return Iu("Unrecognized watch change: "+JSON.stringify(t))},yu.prototype.Xe=function(t){var e,n=this;if("targetChange"in t){cu(t.targetChange,"targetChange");var i=this.$e(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],o=this.Ie(t.targetChange.resumeToken),s=t.targetChange.cause,a=s&&this.be(s);e=new ja(i,r,o,a||null)}else if("documentChange"in t){cu(t.documentChange,"documentChange");var u=t.documentChange;cu(u.document,"documentChange.name"),cu(u.document.name,"documentChange.document.name"),cu(u.document.updateTime,"documentChange.document.updateTime");var h=this.Oe(u.document.name),c=this.fromVersion(u.document.updateTime),f=new Is(h,c,{},void 0,u.document,function(t){return n.Me(t)}),l=u.targetIds||[],p=u.removedTargetIds||[];e=new xa(l,p,f.key,f)}else if("documentDelete"in t){cu(t.documentDelete,"documentDelete");var d=t.documentDelete;cu(d.document,"documentDelete.document"),h=this.Oe(d.document),c=d.readTime?this.fromVersion(d.readTime):Or.q(),f=new Ns(h,c),p=d.removedTargetIds||[],e=new xa([],p,f.key,f)}else if("documentRemove"in t){cu(t.documentRemove,"documentRemove");var v=t.documentRemove;cu(v.document,"documentRemove"),h=this.Oe(v.document),p=v.removedTargetIds||[],e=new xa([],p,h,null)}else{if(!("filter"in t))return Iu("Unknown change type "+JSON.stringify(t));cu(t.filter,"filter");var y=t.filter;cu(y.targetId,"filter.targetId");var g=y.count||0,m=new la(g),w=y.targetId;e=new Ga(w,m)}return e},yu.prototype.$e=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Iu("Got unexpected TargetChange.state: "+t)},yu.prototype.Ze=function(t){if(!("targetChange"in t))return Or.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?Or.MIN:e.readTime?this.fromVersion(e.readTime):Or.MIN},yu.prototype.tr=function(t){var e,n=this;if(t instanceof So)e={update:this.Be(t.key,t.value)};else if(t instanceof Do)e={delete:this.ke(t.key)};else if(t instanceof ko)e={update:this.Be(t.key,t.data),updateMask:this.nr(t.un)};else if(t instanceof Ro)e={transform:{document:this.ke(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.ir(t)})}};else{if(!(t instanceof Co))return Iu("Unknown mutation type "+t.type);e={verify:this.ke(t.key)}}return t.en.Zt||(e.currentDocument=this.er(t.en)),e},yu.prototype.rr=function(t){var e=this,n=t.currentDocument?this.sr(t.currentDocument):To.NONE;if(t.update){cu(t.update.name,"name");var i=this.Oe(t.update.name),r=this.xe(t.update.fields||{});if(t.updateMask){var o=this.ur(t.updateMask);return new ko(i,r,o,n)}return new So(i,r,n)}if(t.delete)return i=this.Oe(t.delete),new Do(i,n);if(t.transform){i=this.Oe(t.transform.document);var s=t.transform.fieldTransforms.map(function(t){return e.or(t)});return Nu(!0===n.exists,'Transforms only support precondition "exists == true"'),new Ro(i,s)}return t.verify?(i=this.Oe(t.verify),new Co(i,n)):Iu("unknown mutation proto: "+JSON.stringify(t))},yu.prototype.er=function(t){return Nu(!t.Zt,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Iu("Unknown precondition")},yu.prototype.sr=function(t){return void 0!==t.updateTime?To.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?To.exists(t.exists):To.NONE},yu.prototype.hr=function(t,e){var n=this,i=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);i.isEqual(Or.MIN)&&(i=this.fromVersion(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults.map(function(t){return n.Me(t)})),new lo(i,r)},yu.prototype.cr=function(t,e){var n=this;return t&&0<t.length?(Nu(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.hr(t,e)})):[]},yu.prototype.ir=function(t){var e=this,n=t.transform;if(n instanceof eo)return{fieldPath:t.field.it(),setToServerValue:"REQUEST_TIME"};if(n instanceof no)return{fieldPath:t.field.it(),appendMissingElements:{values:n.elements.map(function(t){return e.je(t)})}};if(n instanceof io)return{fieldPath:t.field.it(),removeAllFromArray:{values:n.elements.map(function(t){return e.je(t)})}};if(n instanceof ro)return{fieldPath:t.field.it(),increment:this.je(n.Jt)};throw Iu("Unknown transform: "+t.transform)},yu.prototype.or=function(t){var e=this,n=null;if("setToServerValue"in t)Nu("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=eo.instance;else if("appendMissingElements"in t){var i=t.appendMissingElements.values||[];n=new no(i.map(function(t){return e.Me(t)}))}else if("removeAllFromArray"in t)i=t.removeAllFromArray.values||[],n=new io(i.map(function(t){return e.Me(t)}));else if("increment"in t){var r=this.Me(t.increment);Nu(r instanceof Po,"NUMERIC_ADD transform requires a NumberValue"),n=new ro(r)}else Iu("Unknown transform proto: "+JSON.stringify(t));var o=Pr.ht(t.fieldPath);return new No(o,n)},yu.prototype.ar=function(t){return{documents:[this.Fe(t.path)]}},yu.prototype.lr=function(t){var e=t.documents.length;Nu(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return Zs.Ln(this.Ve(n)).Kn()},yu.prototype.dr=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(Nu(n.length%2==0,"Collection Group queries should be within a document path or root."),e.parent=this.Fe(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(Nu(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.Fe(n.Y()),e.structuredQuery.from=[{collectionId:n.$()}]);var i=this.vr(t.filters);i&&(e.structuredQuery.where=i);var r=this.wr(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this.ye(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.mr(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.mr(t.endAt)),e},yu.prototype.gr=function(t){var e=this.Ve(t.parent),n=t.structuredQuery,i=n.from?n.from.length:0,r=null;if(0<i){Nu(1===i,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?r=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.pr(n.where));var a=[];n.orderBy&&(a=this.br(n.orderBy));var u=null;n.limit&&(u=this.Te(n.limit));var h=null;n.startAt&&(h=this.yr(n.startAt));var c=null;return n.endAt&&(c=this.yr(n.endAt)),new Zs(e,r,a,s,u,"F",h,c).Kn()},yu.prototype._r=function(t){var e=this.Tr(t.ci);return null==e?null:{"goog-listen-tags":e}},yu.prototype.Tr=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Iu("Unrecognized query purpose: "+t)}},yu.prototype.Kn=function(t){var e,n=t.target;return(e=n.On()?{documents:this.ar(n)}:{query:this.dr(n)}).targetId=t.targetId,0<t.resumeToken.D()&&(e.resumeToken=this.Se(t.resumeToken)),e},yu.prototype.vr=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof ta?e.Er(t):Iu("Unrecognized filter: "+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},yu.prototype.pr=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Sr(t)]:void 0!==t.fieldFilter?[this.Ir(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.pr(t)}).reduce(function(t,e){return t.concat(e)}):Iu("Unknown filter: "+JSON.stringify(t)):[]},yu.prototype.wr=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.Ar(t)})},yu.prototype.br=function(t){var e=this;return t.map(function(t){return e.Cr(t)})},yu.prototype.mr=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.je(t)})}},yu.prototype.yr=function(t){var e=this,n=!!t.before,i=t.values.map(function(t){return e.Me(t)});return new aa(i,n)},yu.prototype.Rr=function(t){return au[t.name]},yu.prototype.Nr=function(t){switch(t){case"ASCENDING":return sa.ASCENDING;case"DESCENDING":return sa.DESCENDING;default:return}},yu.prototype.Dr=function(t){return uu[t.name]},yu.prototype.kr=function(t){switch(t){case"EQUAL":return Js.EQUAL;case"GREATER_THAN":return Js.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Js.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Js.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Js.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Js.ARRAY_CONTAINS;case"IN":return Js.IN;case"ARRAY_CONTAINS_ANY":return Js.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return Iu("Unspecified operator");default:return Iu("Unknown operator")}},yu.prototype.Or=function(t){return{fieldPath:t.it()}},yu.prototype.Pr=function(t){return Pr.ht(t.fieldPath)},yu.prototype.Ar=function(t){return{field:this.Or(t.field),direction:this.Rr(t.dir)}},yu.prototype.Cr=function(t){return new ua(this.Pr(t.field),this.Nr(t.direction))},yu.prototype.Ir=function(t){return ta.create(this.Pr(t.fieldFilter.field),this.kr(t.fieldFilter.op),this.Me(t.fieldFilter.value))},yu.prototype.Er=function(t){if(t.op===Js.EQUAL){if(t.value.isEqual(fs.En))return{unaryFilter:{field:this.Or(t.field),op:"IS_NAN"}};if(t.value.isEqual(_o.yn))return{unaryFilter:{field:this.Or(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.Or(t.field),op:this.Dr(t.op),value:this.je(t.value)}}},yu.prototype.Sr=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.Pr(t.unaryFilter.field);return ta.create(e,Js.EQUAL,fs.En);case"IS_NULL":var n=this.Pr(t.unaryFilter.field);return ta.create(n,Js.EQUAL,_o.yn);case"OPERATOR_UNSPECIFIED":return Iu("Unspecified filter");default:return Iu("Unknown filter")}},yu.prototype.nr=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.it())}),{fieldPaths:e}},yu.prototype.ur=function(t){var e=(t.fieldPaths||[]).map(function(t){return Pr.ht(t)});return Io.Xt(e)},yu),pu=(vu.Fr=function(t){vu.platform&&Iu("Platform already defined"),vu.platform=t},vu.N=function(){return vu.platform||Iu("Platform not set"),vu.platform},vu),du=new l("@firebase/firestore");function vu(){}function yu(t,e){this.In=t,this.options=e}function gu(){return du.logLevel===o.DEBUG?0:du.logLevel===o.SILENT?2:1}function mu(t){switch(t){case 0:du.logLevel=o.DEBUG;break;case 1:du.logLevel=o.ERROR;break;case 2:du.logLevel=o.SILENT;break;default:du.error("Firestore ("+Pi+"): Invalid value passed to `setLogLevel`")}}function wu(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(du.logLevel<=o.DEBUG){var r=n.map(Eu);du.debug.apply(du,s(["Firestore ("+Pi+") ["+t+"]: "+e],r))}}function bu(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(du.logLevel<=o.ERROR){var i=e.map(Eu);du.error.apply(du,s(["Firestore ("+Pi+"): "+t],i))}}function Eu(t){if("string"==typeof t)return t;var e=pu.N();try{return e.Vr(t)}catch(e){return t}}function Iu(t){var e="FIRESTORE ("+Pi+") INTERNAL ASSERTION FAILED: "+t;throw bu(e),new Error(e)}function Nu(t,e){t||Iu(e)}var Tu=(Au.Ur=function(){for(var e="";e.length<20;)pu.N().randomBytes(40).forEach(function(t){e.length<20&&t<=247&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(t%62))});return Nu(20===e.length,"Invalid auto ID: "+e),e},Au);function Au(){}function Su(t,e){return t<e?-1:e<t?1:0}function ku(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function Ru(t,e,n,i,r){this.In=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}function Du(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Cu=(Object.defineProperty(Ku.prototype,"jr",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),Ku.prototype.isEqual=function(t){return t instanceof Ku&&t.projectId===this.projectId&&t.database===this.database},Ku.prototype.M=function(t){return Su(this.projectId,t.projectId)||Su(this.database,t.database)},Ku),Ou=(zu.prototype.zt=function(t,e,n){e&&Nu(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var i=n.Lr;Nu(i.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+i.length+").");for(var r=0;r<this.mutations.length;r++){var o=this.mutations[r];if(o.key.isEqual(t)){var s=i[r];e=o.zt(e,s)}}return e},zu.prototype.Gt=function(t,e){e&&Nu(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,i=this.baseMutations;n<i.length;n++)(a=i[n]).key.isEqual(t)&&(e=a.Gt(e,e,this.Sn));for(var r=e,o=0,s=this.mutations;o<s.length;o++){var a;(a=s[o]).key.isEqual(t)&&(e=a.Gt(e,r,this.Sn))}return e},zu.prototype.qr=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.Gt(t.key,n.get(t.key));e&&(r=r.dt(t.key,e))}),r},zu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Fa())},zu.prototype.isEqual=function(t){return this.batchId===t.batchId&&ku(this.mutations,t.mutations)&&ku(this.baseMutations,t.baseMutations)},zu),Lu=(Hu.from=function(t,e,n,i){Nu(t.mutations.length===n.length,"Mutations sent "+t.mutations.length+" must equal results received "+n.length);for(var r=Pa(),o=t.mutations,s=0;s<o.length;s++)r=r.dt(o[s].key,n[s].version);return new Hu(t,e,n,i,r)},Hu),_u=(Yu.prototype.get=function(t){var e=this.Br(t),n=this.Qr[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],a=o[1];if(s.isEqual(t))return a}},Yu.prototype.has=function(t){return void 0!==this.get(t)},Yu.prototype.set=function(t,e){var n=this.Br(t),i=this.Qr[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.Qr[n]=[[t,e]]},Yu.prototype.delete=function(t){var e=this.Br(t),n=this.Qr[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.Qr[e]:n.splice(i,1),!0;return!1},Yu.prototype.forEach=function(a){Ji(this.Qr,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];a(o,s)}})},Yu.prototype.K=function(){return tr(this.Qr)},Yu),Uu=(Bu.zr=function(t,e){for(var n=Fa(),i=Fa(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Bu(t,e.fromCache,n,i)},Bu),Pu=(ju.prototype.Jr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ju.prototype.next=function(){var t=++this.previousValue;return this.Yr&&this.Yr(t),t},ju.Xr=-1,ju),Mu=(Gu.rs=function(t,e,n,i,r){var o=new Gu(t,e,Date.now()+n,i,r);return o.start(n),o},Gu.prototype.start=function(t){var e=this;this.ss=setTimeout(function(){return e.us()},t)},Gu.prototype.os=function(){return this.us()},Gu.prototype.cancel=function(t){null!==this.ss&&(this.clearTimeout(),this.es.reject(new Vi(Fi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Gu.prototype.us=function(){var e=this;this.$r.hs(function(){return null!==e.ss?(e.clearTimeout(),e.op().then(function(t){return e.es.resolve(t)})):Promise.resolve()})},Gu.prototype.clearTimeout=function(){null!==this.ss&&(this.ns(this),clearTimeout(this.ss),this.ss=null)},Gu),Fu=(Object.defineProperty(xu.prototype,"ws",{get:function(){return this.as},enumerable:!0,configurable:!0}),xu.prototype.hs=function(t){this.enqueue(t)},xu.prototype.ms=function(t){this.gs(),this.ps(t)},xu.prototype.bs=function(t){return this.gs(),this.ps(t)},xu.prototype.ys=function(e){return c(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.gs(),this.as?[3,2]:(this.as=!0,[4,this.bs(e)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},xu.prototype.enqueue=function(t){return this.gs(),this.as?new Promise(function(t){}):this.ps(t)},xu.prototype.ps=function(t){var n=this,e=this.cs.then(function(){return n.ds=!0,t().catch(function(t){n.ls=t,n.ds=!1;var e=t.stack||t.message||"";throw bu("INTERNAL UNHANDLED ERROR: ",e),e.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return n.ds=!1,t})});return this.cs=e},xu.prototype._s=function(t,e,n){var i=this;this.gs(),Nu(0<=e,"Attempted to schedule an operation with a negative delay of "+e),-1<this.vs.indexOf(t)&&(e=0);var r=Mu.rs(this,t,e,n,function(t){return i.Ts(t)});return this.fs.push(r),r},xu.prototype.gs=function(){this.ls&&Iu("AsyncQueue is already failed: "+(this.ls.stack||this.ls.message))},xu.prototype.Es=function(){Nu(this.ds,"verifyOpInProgress() called when no op in progress on this queue.")},xu.prototype.Ss=function(){return c(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.cs];case 1:t.sent(),t.label=2;case 2:if(e!==this.cs)return[3,0];t.label=3;case 3:return[2]}})})},xu.prototype.Is=function(t){for(var e=0,n=this.fs;e<n.length;e++)if(n[e].Zr===t)return!0;return!1},xu.prototype.As=function(i){var r=this;return this.Ss().then(function(){Nu("all"===i||r.Is(i),"Attempted to drain to missing operation "+i),r.fs.sort(function(t,e){return t.ts-e.ts});for(var t=0,e=r.fs;t<e.length;t++){var n=e[t];if(n.os(),"all"!==i&&n.Zr===i)break}return r.Ss()})},xu.prototype.Cs=function(t){this.vs.push(t)},xu.prototype.Ts=function(t){var e=this.fs.indexOf(t);Nu(0<=e,"Delayed operation not found."),this.fs.splice(e,1)},xu),Vu=(qu.prototype.catch=function(t){return this.next(void 0,t)},qu.prototype.next=function(i,r){var o=this;return this.ks&&Iu("Called next() or catch() twice for PersistencePromise"),this.ks=!0,this.Ds?this.error?this.Os(r,this.error):this.Ps(i,this.result):new qu(function(e,n){o.Rs=function(t){o.Ps(i,t).next(e,n)},o.Ns=function(t){o.Os(r,t).next(e,n)}})},qu.prototype.Fs=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},qu.prototype.Vs=function(t){try{var e=t();return e instanceof qu?e:qu.resolve(e)}catch(t){return qu.reject(t)}},qu.prototype.Ps=function(t,e){return t?this.Vs(function(){return t(e)}):qu.resolve(e)},qu.prototype.Os=function(t,e){return t?this.Vs(function(){return t(e)}):qu.reject(e)},qu.resolve=function(n){return new qu(function(t,e){t(n)})},qu.reject=function(n){return new qu(function(t,e){e(n)})},qu.Us=function(t){return new qu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},qu.js=function(t){for(var n=qu.resolve(!1),e=function(e){n=n.next(function(t){return t?qu.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},qu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Us(r)},qu);function qu(t){var e=this;this.Rs=null,this.Ns=null,this.result=void 0,this.error=void 0,this.Ds=!1,this.ks=!1,t(function(t){e.Ds=!0,e.result=t,e.Rs&&e.Rs(t)},function(t){e.Ds=!0,e.error=t,e.Ns&&e.Ns(t)})}function xu(){this.cs=Promise.resolve(),this.as=!1,this.fs=[],this.ls=null,this.ds=!1,this.vs=[]}function Gu(t,e,n,i,r){this.$r=t,this.Zr=e,this.ts=n,this.op=i,this.ns=r,this.es=new Du,this.then=this.es.promise.then.bind(this.es.promise),this.catch=this.es.promise.catch.bind(this.es.promise),this.es.promise.catch(function(t){})}function ju(t,e){var n=this;this.previousValue=t,e&&(e.Hr=function(t){return n.Jr(t)},this.Yr=function(t){return e.Kr(t)})}function Bu(t,e,n,i){this.targetId=t,this.fromCache=e,this.Wr=n,this.Gr=i}function Yu(t){this.Br=t,this.Qr={}}function Hu(t,e,n,i,r){this.batch=t,this.Mr=e,this.Lr=n,this.streamToken=i,this.xr=r}function zu(t,e,n,i){this.batchId=t,this.Sn=e,this.baseMutations=n,Nu(0<(this.mutations=i).length,"Cannot create an empty mutation batch")}function Ku(t,e){this.projectId=t,this.database=e||"(default)"}function Wu(t,e){var n=t[0],i=t[1],r=e[0],o=e[1],s=Su(n,r);return 0===s?Su(i,o):s}function Qu(t){this.Ls=t,this.buffer=new Jr(Wu),this.qs=0}Qu.prototype.Ms=function(){return++this.qs},Qu.prototype.xs=function(t){var e=[t,this.Ms()];if(this.buffer.size<this.Ls)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Wu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(Qu.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0});var Xu=(sh.Gs=function(t){return new sh(t,sh.zs,sh.Hs)},sh.Js=-1,sh.Ys=1048576,sh.Xs=new sh(sh.Ks=41943040,sh.zs=10,sh.Hs=1e3),sh.DISABLED=new sh(sh.Js,0,0),sh),$u=(oh.prototype.start=function(t){Nu(null===this.tu,"Cannot start an already started LruScheduler"),this.$s.params.Bs!==Xu.Js&&this.nu(t)},oh.prototype.stop=function(){this.tu&&(this.tu.cancel(),this.tu=null)},Object.defineProperty(oh.prototype,"iu",{get:function(){return null!==this.tu},enumerable:!0,configurable:!0}),oh.prototype.nu=function(t){var e=this;Nu(null===this.tu,"Cannot schedule GC while a task is pending");var n=this.Zs?3e5:6e4;wu("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.tu=this.$r._s("lru_garbage_collection",n,function(){return e.tu=null,e.Zs=!0,t.eu(e.$s).then(function(){return e.nu(t)}).catch(ah)})},rh.prototype.K=function(){return this.ru.K()},rh.prototype.ou=function(t,e){var n=new Zu(t,e);this.ru=this.ru.add(n),this.su=this.su.add(n)},rh.prototype.hu=function(t,e){var n=this;t.forEach(function(t){return n.ou(t,e)})},rh.prototype.cu=function(t,e){this.au(new Zu(t,e))},rh.prototype.fu=function(t,e){var n=this;t.forEach(function(t){return n.cu(t,e)})},rh.prototype.lu=function(t){var e=this,n=Mr.EMPTY,i=new Zu(n,t),r=new Zu(n,t+1),o=[];return this.su.Mt([i,r],function(t){e.au(t),o.push(t.key)}),o},rh.prototype.du=function(){var e=this;this.ru.forEach(function(t){return e.au(t)})},rh.prototype.au=function(t){this.ru=this.ru.delete(t),this.su=this.su.delete(t)},rh.prototype.vu=function(t){var e=Mr.EMPTY,n=new Zu(e,t),i=new Zu(e,t+1),r=Fa();return this.su.Mt([n,i],function(t){r=r.add(t.key)}),r},rh.prototype.wu=function(t){var e=new Zu(t,0),n=this.ru.Bt(e);return null!==n&&t.isEqual(n.key)},rh),Zu=(ih.An=function(t,e){return Mr.G(t.key,e.key)||Su(t.mu,e.mu)},ih.uu=function(t,e){return Su(t.mu,e.mu)||Mr.G(t.key,e.key)},ih),Ju=(Object.defineProperty(nh.prototype,"readTime",{get:function(){return Nu(void 0!==this.bu,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this.bu},set:function(t){Nu(void 0===this.bu||this.bu.isEqual(t),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this.bu=t},enumerable:!0,configurable:!0}),nh.prototype.yu=function(t,e){this._u(),this.readTime=e,this.gu.set(t.key,t)},nh.prototype.Tu=function(t,e){this._u(),e&&(this.readTime=e),this.gu.set(t,null)},nh.prototype.Eu=function(t,e){this._u();var n=this.gu.get(e);return void 0!==n?Vu.resolve(n):this.Su(t,e)},nh.prototype.getEntries=function(t,e){return this.Iu(t,e)},nh.prototype.apply=function(t){return this._u(),this.pu=!0,this.Au(t)},nh.prototype._u=function(){Nu(!this.pu,"Changes have already been applied.")},nh),th=(eh.prototype.start=function(){return this.Qu()},eh.prototype.Wu=function(r){return c(this,void 0,void 0,function(){var e,y,n,i=this;return v(this,function(t){switch(t.label){case 0:return e=this.Fu,y=this.Mu,[4,this.persistence.runTransaction("Handle user change","readonly",function(d){var v;return i.Fu.Gu(d).next(function(t){return v=t,e=i.persistence.Vu(r),y=new Ah(i.Uu,e,i.persistence.xu()),e.Gu(d)}).next(function(t){for(var e=[],n=[],i=Fa(),r=0,o=v;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++){var h=u[a];i=i.add(h.key)}}for(var c=0,f=t;c<f.length;c++){s=f[c],n.push(s.batchId);for(var l=0,p=s.mutations;l<p.length;l++)h=p[l],i=i.add(h.key)}return y.zu(d,i).next(function(t){return{Hu:t,Ju:e,Yu:n}})})})];case 1:return n=t.sent(),this.Fu=e,this.Mu=y,this.Cu.Bu(this.Mu),[2,n]}})})},eh.prototype.Ku=function(a){var u,h=this,c=Cr.now(),t=a.reduce(function(t,e){return t.add(e.key)},Fa());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Mu.zu(s,t).next(function(t){u=t;for(var e=[],n=0,i=a;n<i.length;n++){var r=i[n],o=r.sn(u.get(r.key));null!=o&&e.push(new ko(r.key,o,o.un(),To.exists(!0)))}return h.Fu.Xu(s,c,e,a)})}).then(function(t){var e=t.qr(u);return{batchId:t.batchId,gu:e}})},eh.prototype.$u=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return n.Fu.Zu(e,t).next(function(t){return t?n.Mu.zu(e,t):Vu.resolve(null)})})},eh.prototype.to=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.Uu.no({io:!0});return r.Fu.to(t,i.batch,i.streamToken).next(function(){return r.eo(t,i,n)}).next(function(){return n.apply(t)}).next(function(){return r.Fu.ro(t)}).next(function(){return r.Mu.zu(t,e)})})},eh.prototype.so=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Fu.uo(e,t).next(function(t){return Nu(null!==t,"Attempt to reject nonexistent batch!"),n=t.keys(),i.Fu.oo(e,t)}).next(function(){return i.Fu.ro(e)}).next(function(){return i.Mu.zu(e,n)})})},eh.prototype.ho=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Fu.ho(t)})},eh.prototype.co=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.Fu.co(t)})},eh.prototype.ao=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.Fu.ao(t,e)})},eh.prototype.fo=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Lu.fo(t)})},eh.prototype.lo=function(u){var h=this,c=u.ai,f=this.Nu;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.Uu.no({io:!0});f=h.Nu;var s=[];Zi(u.Si,function(t,e){var n=f.get(t);if(n){s.push(h.Lu.do(o,e.Pi,t).next(function(){return h.Lu.vo(o,e.ki,t)}));var i=e.resumeToken;if(0<i.D()){var r=n.li(i,c).fi(o.wo);f=f.dt(t,r),eh.mo(n,r,e)&&s.push(h.Lu.po(o,r))}}});var a=Ca(),n=Fa();if(u.Ai.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){u.Ai.forEach(function(t,e){var n=i.get(t);e instanceof Ns&&e.version.isEqual(Or.MIN)?(r.Tu(t,c),a=a.dt(t,e)):null==n||0<e.version.M(n.version)||0===e.version.M(n.version)&&n.hasPendingWrites?(Nu(!Or.MIN.isEqual(c),"Cannot add a document when the remote version is zero"),r.yu(e,c),a=a.dt(t,e)):wu("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.Ci.has(t)&&s.push(h.persistence.Pu.bo(o,t))})})),!c.isEqual(Or.MIN)){var t=h.Lu.fo(o).next(function(t){return Nu(0<=c.M(t),"Watch stream reverted to previous snapshot?? "+c+" < "+t),h.Lu.yo(o,o.wo,c)});s.push(t)}return Vu.Us(s).next(function(){return r.apply(o)}).next(function(){return h.Mu._o(o,a)})}).then(function(t){return h.Nu=f,t})},eh.mo=function(t,e,n){return Nu(0<e.resumeToken.D(),"Attempted to persist target data with no resume token"),0===t.resumeToken.D()||e.ai.B()-t.ai.B()>=this.To||0<n.ki.size+n.Oi.size+n.Pi.size},eh.prototype.Eo=function(t){for(var n=this,e=0,i=t;e<i.length;e++){var r=i[e],o=r.targetId;if(this.Ru.hu(r.Wr,o),this.Ru.fu(r.Gr,o),!r.fromCache){var s=this.Nu.get(o);Nu(null!==s,"Can't set limbo-free snapshot version for unknown target: "+o);var a=s.ai,u=s.di(a);this.Nu=this.Nu.dt(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return Vu.forEach(t,function(t){return Vu.forEach(t.Gr,function(t){return n.persistence.Pu.cu(e,t)})})})},eh.prototype.So=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Fu.Io(t,e)})},eh.prototype.Ao=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Mu.Co(t,e)})},eh.prototype.Ro=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Lu.No(e,i).next(function(t){return t?(n=t,Vu.resolve(n)):r.Lu.Do(e).next(function(t){return n=new fa(i,t,0,e.wo),r.Lu.ko(e,n).next(function(){return n})})})}).then(function(t){return null===r.Nu.get(t.targetId)&&(r.Nu=r.Nu.dt(t.targetId,t),r.Du.set(i,t.targetId)),t})},eh.prototype.No=function(t,e){var n=this.Du.get(e);return void 0!==n?Vu.resolve(this.Nu.get(n)):this.Lu.No(t,e)},eh.prototype.Oo=function(n,i){var r=this,o=this.Nu.get(n);Nu(null!==o,"Tried to release nonexistent target: "+n);var t=i?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",t,function(e){var t=r.Ru.lu(n);return i?Vu.resolve():Vu.forEach(t,function(t){return r.persistence.Pu.cu(e,t)}).next(function(){r.persistence.Pu.removeTarget(e,o)})}).then(function(){r.Nu=r.Nu.remove(n),r.Du.delete(o.target)})},eh.prototype.Po=function(t,n){var i=this,r=Or.MIN,o=Fa();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.No(e,t.Kn()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Lu.Fo(e,t.targetId).next(function(t){o=t})}).next(function(){return i.Cu.Vo(e,t,n?r:Or.MIN,n?o:Fa())}).next(function(t){return{documents:t,Uo:o}})})},eh.prototype.jo=function(e){var n=this;return this.persistence.runTransaction("Remote document keys","readonly",function(t){return n.Lu.Fo(t,e)})},eh.prototype.Lo=function(){return this.persistence.Lo()},eh.prototype.qo=function(t){this.Fu.Mo(t)},eh.prototype.xo=function(t){this.persistence.xo(t)},eh.prototype.eo=function(t,r,o){var e=this,s=r.batch,n=s.keys(),a=Vu.resolve();return n.forEach(function(i){a=a.next(function(){return o.Eu(t,i)}).next(function(t){var e=t,n=r.xr.get(i);Nu(null!==n,"ackVersions should contain every doc in the write."),(!e||e.version.M(n)<0)&&((e=s.zt(i,e,r))?o.yu(e,r.Mr):Nu(!t,"Mutation batch "+s+" applied to document "+t+" resulted in null"))})}),a.next(function(){return e.Fu.oo(t,s)})},eh.prototype.eu=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Bo(t,n.Nu)})},eh.prototype.Qo=function(e){var n=this,t=this.Nu.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly",function(t){return n.Lu.pe(t,e).next(function(t){return t?t.target:null})})},eh.prototype.Wo=function(){var i=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return i.Uu.Wo(t,i.ku)}).then(function(t){var e=t.Go,n=t.readTime;return i.ku=n,e})},eh.prototype.Qu=function(){return c(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Uu.zo(t)})];case 1:return e.ku=t.sent(),[2]}})})},eh.To=3e8,eh);function eh(t,e,n){this.persistence=t,this.Cu=e,this.Ru=new $u,this.Nu=new Fr(Su),this.Du=new _u(function(t){return t.canonicalId()}),this.ku=Or.MIN,Nu(t.iu,"LocalStore was passed an unstarted persistence implementation"),this.persistence.Pu.Ou(this.Ru),this.Fu=t.Vu(n),this.Uu=t.ju(),this.Lu=t.qu(),this.Mu=new Ah(this.Uu,this.Fu,this.persistence.xu()),this.Cu.Bu(this.Mu)}function nh(){this.gu=new _u(function(t){return t.toString()}),this.pu=!1}function ih(t,e){this.key=t,this.mu=e}function rh(){this.ru=new Jr(Zu.An),this.su=new Jr(Zu.uu)}function oh(t,e){this.$s=t,this.$r=e,this.Zs=!1,this.tu=null}function sh(t,e,n){this.Bs=t,this.Qs=e,this.Ws=n}function ah(e){return c(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Fi.FAILED_PRECONDITION||e.message!==Nh)throw e;return wu("LocalStore","Unexpectedly lost primary lease"),[2]})})}function uh(t,e){return Nu(-1===e.indexOf("_"),"Client key cannot contain '_', but was '"+e+"'"),"firestore_clients_"+t+"_"+e}function hh(t,e,n){var i="firestore_mutations_"+t+"_"+n;return e.t()&&(i+="_"+e.uid),i}function ch(t,e){return"firestore_targets_"+t+"_"+e}var fh=(bh.Ho=function(t,e,n){var i=JSON.parse(n),r="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),o=void 0;return r&&i.error&&(r="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(o=new Vi(i.error.code,i.error.message)),r?new bh(t,e,i.state,o):(bu("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},bh.prototype.Jo=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},bh),lh=(wh.Ho=function(t,e){var n=JSON.parse(e),i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),r=void 0;return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(r=new Vi(n.error.code,n.error.message)),i?new wh(t,n.state,r):(bu("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},wh.prototype.Jo=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},wh),ph=(mh.Ho=function(t,e){for(var n=JSON.parse(e),i="object"==typeof n&&n.activeTargetIds instanceof Array,r=qa(),o=0;i&&o<n.activeTargetIds.length;++o)i=js(n.activeTargetIds[o]),r=r.add(n.activeTargetIds[o]);return i?new mh(t,r):(bu("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},mh),dh=(gh.Ho=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new gh(e.clientId,e.onlineState):(bu("SharedClientState","Failed to parse online state: "+t),null)},gh),vh=(yh.prototype.Yo=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},yh.prototype.Ko=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},yh.prototype.Jo=function(){var t={activeTargetIds:this.activeTargetIds.nt(),updateTimeMs:Date.now()};return JSON.stringify(t)},yh);function yh(){this.activeTargetIds=qa()}function gh(t,e){this.clientId=t,this.onlineState=e}function mh(t,e){this.clientId=t,this.activeTargetIds=e}function wh(t,e,n){this.targetId=t,this.state=e,Nu(void 0!==(this.error=n)==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}function bh(t,e,n,i){this.user=t,this.batchId=e,this.state=n,Nu(void 0!==(this.error=i)==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}function Eh(t,e,n,i,r){if(this.Xo=t,this.platform=e,this.persistenceKey=n,this.$o=i,this.Zo=null,this.th=null,this.Hr=null,this.nh={},this.ih=this.eh.bind(this),this.iu=!1,this.rh=[],!Eh.sh(this.platform))throw new Vi(Fi.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=r,this.uh=uh(this.persistenceKey,this.$o),this.oh="firestore_sequence_number_"+this.persistenceKey,this.nh[this.$o]=new vh,this.hh=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.ah=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.fh=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.lh="firestore_online_state_"+this.persistenceKey,this.platform.window.addEventListener("storage",this.ih)}Eh.sh=function(t){return!(!t.window||null==t.window.localStorage)},Eh.prototype.start=function(){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u,h,c,f,l=this;return v(this,function(t){switch(t.label){case 0:return Nu(!this.iu,"WebStorageSharedClientState already started"),Nu(null!==this.Zo,"syncEngine property must be set before calling start()"),Nu(null!==this.th,"onlineStateHandler property must be set before calling start()"),[4,this.Zo.Lo()];case 1:for(e=t.sent(),n=0,i=e;n<i.length;n++)(r=i[n])!==this.$o&&(o=this.getItem(uh(this.persistenceKey,r)))&&(s=ph.Ho(r,o))&&(this.nh[s.clientId]=s);for(this.dh(),(a=this.storage.getItem(this.lh))&&(u=this.vh(a))&&this.wh(u),h=0,c=this.rh;h<c.length;h++)f=c[h],this.eh(f);return this.rh=[],this.platform.window.addEventListener("unload",function(){return l.shutdown()}),this.iu=!0,[2]}})})},Eh.prototype.Kr=function(t){this.setItem(this.oh,JSON.stringify(t))},Eh.prototype.mh=function(){var n=qa();return Ji(this.nh,function(t,e){n=n.Qt(e.activeTargetIds)}),n},Eh.prototype.gh=function(t){for(var e in this.nh)if(this.nh.hasOwnProperty(e)&&this.nh[e].activeTargetIds.has(t))return!0;return!1},Eh.prototype.ph=function(t){this.bh(t,"pending")},Eh.prototype.yh=function(t,e,n){this.bh(t,e,n),this._h(t)},Eh.prototype.Th=function(t){var e="not-current";if(this.gh(t)){var n=this.storage.getItem(ch(this.persistenceKey,t));if(n){var i=lh.Ho(t,n);i&&(e=i.state)}}return this.Eh.Yo(t),this.dh(),e},Eh.prototype.Sh=function(t){this.Eh.Ko(t),this.dh()},Eh.prototype.Ih=function(t){return this.Eh.activeTargetIds.has(t)},Eh.prototype.Ah=function(t){this.removeItem(ch(this.persistenceKey,t))},Eh.prototype.Ch=function(t,e,n){this.Rh(t,e,n)},Eh.prototype.Wu=function(t,e,n){var i=this;e.forEach(function(t){i._h(t)}),this.currentUser=t,n.forEach(function(t){i.ph(t)})},Eh.prototype.Nh=function(t){this.Dh(t)},Eh.prototype.shutdown=function(){this.iu&&(this.platform.window.removeEventListener("storage",this.ih),this.removeItem(this.uh),this.iu=!1)},Eh.prototype.getItem=function(t){var e=this.storage.getItem(t);return wu("SharedClientState","READ",t,e),e},Eh.prototype.setItem=function(t,e){wu("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Eh.prototype.removeItem=function(t){wu("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Eh.prototype.eh=function(a){var t=this;if(a.storageArea===this.storage){if(wu("SharedClientState","EVENT",a.key,a.newValue),a.key===this.uh)return void bu("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Xo.hs(function(){return c(t,void 0,void 0,function(){var e,n,i,r,o,s;return v(this,function(t){if(!this.iu)return this.rh.push(a),[2];if(null===a.key)return[2];if(this.hh.test(a.key)){if(null==a.newValue)return n=this.kh(a.key),[2,this.Oh(n,null)];if(e=this.Ph(a.key,a.newValue))return[2,this.Oh(e.clientId,e)]}else if(this.ah.test(a.key)){if(null!==a.newValue&&(i=this.Fh(a.key,a.newValue)))return[2,this.Vh(i)]}else if(this.fh.test(a.key)){if(null!==a.newValue&&(r=this.Uh(a.key,a.newValue)))return[2,this.jh(r)]}else if(a.key===this.lh){if(null!==a.newValue&&(o=this.vh(a.newValue)))return[2,this.wh(o)]}else a.key===this.oh&&(Nu(!!this.Hr,"Missing sequenceNumberHandler"),(s=function(t){var e=Pu.Xr;if(null!=t)try{var n=JSON.parse(t);Nu("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(t){bu("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(a.newValue))!==Pu.Xr&&this.Hr(s));return[2]})})})}},Object.defineProperty(Eh.prototype,"Eh",{get:function(){return this.nh[this.$o]},enumerable:!0,configurable:!0}),Eh.prototype.dh=function(){this.setItem(this.uh,this.Eh.Jo())},Eh.prototype.bh=function(t,e,n){var i=new fh(this.currentUser,t,e,n),r=hh(this.persistenceKey,this.currentUser,t);this.setItem(r,i.Jo())},Eh.prototype._h=function(t){var e=hh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Eh.prototype.Dh=function(t){var e={clientId:this.$o,onlineState:t};this.storage.setItem(this.lh,JSON.stringify(e))},Eh.prototype.Rh=function(t,e,n){var i=ch(this.persistenceKey,t),r=new lh(t,e,n);this.setItem(i,r.Jo())},Eh.prototype.kh=function(t){var e=this.hh.exec(t);return e?e[1]:null},Eh.prototype.Ph=function(t,e){var n=this.kh(t);return Nu(null!==n,"Cannot parse client state key '"+t+"'"),ph.Ho(n,e)},Eh.prototype.Fh=function(t,e){var n=this.ah.exec(t);Nu(null!==n,"Cannot parse mutation batch key '"+t+"'");var i=Number(n[1]),r=void 0!==n[2]?n[2]:null;return fh.Ho(new Mi(r),i,e)},Eh.prototype.Uh=function(t,e){var n=this.fh.exec(t);Nu(null!==n,"Cannot parse query target key '"+t+"'");var i=Number(n[1]);return lh.Ho(i,e)},Eh.prototype.vh=function(t){return dh.Ho(t)},Eh.prototype.Vh=function(e){return c(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid!==this.currentUser.uid?(wu("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2]):[2,this.Zo.Lh(e.batchId,e.state,e.error)]})})},Eh.prototype.jh=function(t){return this.Zo.qh(t.targetId,t.state,t.error)},Eh.prototype.Oh=function(t,e){var n=this,i=this.mh();e?this.nh[t]=e:delete this.nh[t];var r=this.mh(),o=[],s=[];return r.forEach(function(e){return c(n,void 0,void 0,function(){return v(this,function(t){return i.has(e)||o.push(e),[2]})})}),i.forEach(function(e){return c(n,void 0,void 0,function(){return v(this,function(t){return r.has(e)||s.push(e),[2]})})}),this.Zo.Mh(o,s)},Eh.prototype.wh=function(t){this.nh[t.clientId]&&this.th(t.onlineState)};var Ih=(Mh.prototype.ph=function(t){},Mh.prototype.yh=function(t,e,n){},Mh.prototype.Th=function(t){return this.xh.Yo(t),this.Bh[t]||"not-current"},Mh.prototype.Ch=function(t,e,n){this.Bh[t]=e},Mh.prototype.Sh=function(t){this.xh.Ko(t)},Mh.prototype.Ih=function(t){return this.xh.activeTargetIds.has(t)},Mh.prototype.Ah=function(t){delete this.Bh[t]},Mh.prototype.mh=function(){return this.xh.activeTargetIds},Mh.prototype.gh=function(t){return this.xh.activeTargetIds.has(t)},Mh.prototype.start=function(){return this.xh=new vh,Promise.resolve()},Mh.prototype.Wu=function(t,e,n){},Mh.prototype.Nh=function(t){},Mh.prototype.shutdown=function(){},Mh.prototype.Kr=function(t){},Mh),Nh="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Th=(Ph.prototype.Wh=function(t){this.Qh.push(t)},Ph.prototype.Gh=function(){this.Qh.forEach(function(t){return t()})},Ph),Ah=(Uh.prototype.Co=function(e,n){var i=this;return this.Fu.Jh(e,n).next(function(t){return i.Yh(e,n,t)})},Uh.prototype.Yh=function(t,i,r){return this.zh.Eu(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].Gt(i,t);return t})},Uh.prototype.Kh=function(t,e,r){var o=Oa();return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].Gt(t,e);o=o.dt(t,e)}),o},Uh.prototype.zu=function(e,t){var n=this;return this.zh.getEntries(e,t).next(function(t){return n._o(e,t)})},Uh.prototype._o=function(i,r){var o=this;return this.Fu.Xh(i,r).next(function(t){var e=o.Kh(i,r,t),n=Ca();return e.forEach(function(t,e){e=e||new Ns(t,Or.q()),n=n.dt(t,e)}),n})},Uh.prototype.Vo=function(t,e,n){return e.On()?this.$h(t,e.path):e.si()?this.Zh(t,e,n):this.tc(t,e,n)},Uh.prototype.$h=function(t,e){return this.Co(t,new Mr(e)).next(function(t){var e=_a();return t instanceof Is&&(e=e.dt(t.key,t)),e})},Uh.prototype.Zh=function(n,i,r){var o=this;Nu(i.path.K(),"Currently we only support collection group queries at the root.");var s=i.collectionGroup,a=_a();return this.Hh.nc(n,s).next(function(t){return Vu.forEach(t,function(t){var e=i.Jn(t.child(s));return o.tc(n,e,r).next(function(t){t.forEach(function(t,e){a=a.dt(t,e)})})}).next(function(){return a})})},Uh.prototype.tc=function(e,n,t){var c,f,i=this;return this.zh.Vo(e,n,t).next(function(t){return c=t,i.Fu.ic(e,n)}).next(function(t){return f=t,i.ec(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],a=s.key,u=c.get(a),h=s.Gt(u,u,i.Sn);c=h instanceof Is?c.dt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},Uh.prototype.ec=function(t,e,n){for(var i=Fa(),r=0,o=e;r<o.length;r++)for(var s=0,a=o[r].mutations;s<a.length;s++){var u=a[s];u instanceof ko&&null===n.get(u.key)&&(i=i.add(u.key))}var h=n;return this.zh.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Is&&(h=h.dt(t,e))}),h})},Uh),Sh=(_h.prototype.Bu=function(t){this.rc=t},_h.prototype.Vo=function(e,i,r,o){var s=this;return Nu(void 0!==this.rc,"setLocalDocumentsView() not called"),i.Yn()||r.isEqual(Or.MIN)?this.sc(e,i):this.rc.zu(e,o).next(function(t){var n=s.uc(i,t);return(i.ii()||i.ei())&&s.oc(i.Fn,n,o,r)?s.sc(e,i):(gu()<=0&&wu("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.rc.Vo(e,i,r).next(function(e){return n.forEach(function(t){e=e.dt(t.key,t)}),e}))})},_h.prototype.uc=function(n,t){var i=new Jr(function(t,e){return n.Xn(t,e)});return t.forEach(function(t,e){e instanceof Is&&n.matches(e)&&(i=i.add(e))}),i},_h.prototype.oc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.M(i))},_h.prototype.sc=function(t,e){return gu()<=0&&wu("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.rc.Vo(t,e,Or.MIN)},_h),kh=(Lh.prototype.cc=function(t,e){return this.hc.add(e),Vu.resolve()},Lh.prototype.nc=function(t,e){return Vu.resolve(this.hc.getEntries(e))},Lh),Rh=(Oh.prototype.add=function(t){Nu(t.length%2==1,"Expected a collection path.");var e=t.$(),n=t.Y(),i=this.index[e]||new Jr(_r.G),r=!i.has(n);return this.index[e]=i.add(n),r},Oh.prototype.has=function(t){var e=t.$(),n=t.Y(),i=this.index[e];return i&&i.has(n)},Oh.prototype.getEntries=function(t){return(this.index[t]||new Jr(_r.G)).nt()},Oh),Dh=(Ch.prototype.lc=function(t){return Vu.resolve(0===this.Fu.length)},Ch.prototype.to=function(t,e,n){var i=e.batchId,r=this.dc(i,"acknowledged");Nu(0===r,"Can only acknowledge the first batch in the mutation queue");var o=this.Fu[r];return Nu(i===o.batchId,"Queue ordering failure: expected batch "+i+", got batch "+o.batchId),this.lastStreamToken=n,Vu.resolve()},Ch.prototype.co=function(t){return Vu.resolve(this.lastStreamToken)},Ch.prototype.ao=function(t,e){return this.lastStreamToken=e,Vu.resolve()},Ch.prototype.Xu=function(t,e,n,i){Nu(0!==i.length,"Mutation batches should not be empty");var r=this.ac;this.ac++,0<this.Fu.length&&Nu(this.Fu[this.Fu.length-1].batchId<r,"Mutation batchIDs must be monotonically increasing order");var o=new Ou(r,e,n,i);this.Fu.push(o);for(var s=0,a=i;s<a.length;s++){var u=a[s];this.fc=this.fc.add(new Zu(u.key,r)),this.Hh.cc(t,u.key.path.Y())}return Vu.resolve(o)},Ch.prototype.uo=function(t,e){return Vu.resolve(this.vc(e))},Ch.prototype.Zu=function(t,e){var n=this.vc(e);return Nu(null!=n,"Failed to find local mutation batch."),Vu.resolve(n.keys())},Ch.prototype.Io=function(t,e){var n=e+1,i=this.wc(n),r=i<0?0:i;return Vu.resolve(this.Fu.length>r?this.Fu[r]:null)},Ch.prototype.ho=function(){return Vu.resolve(0===this.Fu.length?-1:this.ac-1)},Ch.prototype.Gu=function(t){return Vu.resolve(this.Fu.slice())},Ch.prototype.Jh=function(t,n){var i=this,e=new Zu(n,0),r=new Zu(n,Number.POSITIVE_INFINITY),o=[];return this.fc.Mt([e,r],function(t){Nu(n.isEqual(t.key),"Should only iterate over a single key's batches");var e=i.vc(t.mu);Nu(null!==e,"Batches in the index must exist in the main table"),o.push(e)}),Vu.resolve(o)},Ch.prototype.Xh=function(t,e){var i=this,r=new Jr(Su);return e.forEach(function(e){var t=new Zu(e,0),n=new Zu(e,Number.POSITIVE_INFINITY);i.fc.Mt([t,n],function(t){Nu(e.isEqual(t.key),"For each key, should only iterate over a single key's batches"),r=r.add(t.mu)})}),Vu.resolve(this.mc(r))},Ch.prototype.ic=function(t,e){Nu(!e.si(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,i=n.length+1,r=n;Mr.ct(r)||(r=r.child(""));var o=new Zu(new Mr(r),0),s=new Jr(Su);return this.fc.xt(function(t){var e=t.key.path;return!!n.Z(e)&&(e.length===i&&(s=s.add(t.mu)),!0)},o),Vu.resolve(this.mc(s))},Ch.prototype.mc=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.vc(t);null!==e&&i.push(e)}),i},Ch.prototype.oo=function(n,i){var r=this;Nu(0===this.dc(i.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.Fu.shift();var o=this.fc;return Vu.forEach(i.mutations,function(t){var e=new Zu(t.key,i.batchId);return o=o.delete(e),r.Pu.gc(n,t.key)}).next(function(){r.fc=o})},Ch.prototype.Mo=function(t){},Ch.prototype.wu=function(t,e){var n=new Zu(e,0),i=this.fc.Bt(n);return Vu.resolve(e.isEqual(i&&i.key))},Ch.prototype.ro=function(t){return 0===this.Fu.length&&Nu(this.fc.K(),"Document leak -- detected dangling mutation references when queue is empty."),Vu.resolve()},Ch.prototype.dc=function(t,e){var n=this.wc(t);return Nu(0<=n&&n<this.Fu.length,"Batches must exist to be "+e),n},Ch.prototype.wc=function(t){return 0===this.Fu.length?0:t-this.Fu[0].batchId},Ch.prototype.vc=function(t){var e=this.wc(t);if(e<0||e>=this.Fu.length)return null;var n=this.Fu[e];return Nu(n.batchId===t,"If found batch must match"),n},Ch);function Ch(t,e){this.Hh=t,this.Pu=e,this.Fu=[],this.ac=1,this.lastStreamToken=wr.k,this.fc=new Jr(Zu.An)}function Oh(){this.index={}}function Lh(){this.hc=new Rh}function _h(){}function Uh(t,e,n){this.zh=t,this.Fu=e,this.Hh=n}function Ph(){this.Qh=[]}function Mh(){this.xh=new vh,this.Bh={},this.Zo=null,this.th=null,this.Hr=null}var Fh,Vh,qh,xh,Gh=(dc.prototype.yu=function(t,e,n){Nu(!n.isEqual(Or.MIN),"Cannot add a document with a read time of zero");var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.pc(e);return this.docs=this.docs.dt(i,{bc:e,size:s,readTime:n}),this.size+=s-o,this.Hh.cc(t,i.path.Y())},dc.prototype.Tu=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},dc.prototype.Eu=function(t,e){var n=this.docs.get(e);return Vu.resolve(n?n.bc:null)},dc.prototype.getEntries=function(t,e){var n=this,i=Oa();return e.forEach(function(t){var e=n.docs.get(t);i=i.dt(t,e?e.bc:null)}),Vu.resolve(i)},dc.prototype.Vo=function(t,e,n){Nu(!e.si(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var i=_a(),r=new Mr(e.path.child("")),o=this.docs._t(r);o.Ct();){var s=o.At(),a=s.key,u=s.value,h=u.bc,c=u.readTime;if(!e.path.Z(a.path))break;c.M(n)<=0||h instanceof Is&&e.matches(h)&&(i=i.dt(h.key,h))}return Vu.resolve(i)},dc.prototype.yc=function(t,e){return Vu.forEach(this.docs,function(t){return e(t)})},dc.prototype.Wo=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},dc.prototype.zo=function(t){return Vu.resolve(Or.MIN)},dc.prototype.no=function(t){return new dc._c(this)},dc.prototype.Tc=function(t){return Vu.resolve(this.size)},dc._c=(t(vc,xh=Ju),vc.prototype.Au=function(n){var i=this,r=[];return this.gu.forEach(function(t,e){e?r.push(i.Ec.yu(n,e,i.readTime)):i.Ec.Tu(t)}),Vu.Us(r)},vc.prototype.Su=function(t,e){return this.Ec.Eu(t,e)},vc.prototype.Iu=function(t,e){return this.Ec.getEntries(t,e)},vc),dc),jh=(pc.prototype.next=function(){var t=this.Ac;return this.Ac+=2,t},pc.prototype.after=function(t){return this.Ic(t+2),this.next()},pc.prototype.Ic=function(t){Nu((1&t)===this.Sc,"Cannot supply target ID from different generator ID"),this.Ac=t},pc.Cc=function(){return new pc(0,2)},pc.Rc=function(){return new pc(1)},pc),Bh=(lc.prototype.oe=function(t,n){return this.Nc.forEach(function(t,e){return n(e)}),Vu.resolve()},lc.prototype.fo=function(t){return Vu.resolve(this.lastRemoteSnapshotVersion)},lc.prototype.Pc=function(t){return Vu.resolve(this.Dc)},lc.prototype.Do=function(t){var e=this.Oc.after(this.highestTargetId);return this.highestTargetId=e,Vu.resolve(e)},lc.prototype.yo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Dc&&(this.Dc=e),Vu.resolve()},lc.prototype.Fc=function(t){this.Nc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.Dc&&(this.Dc=t.sequenceNumber)},lc.prototype.ko=function(t,e){return Nu(!this.Nc.has(e.target),"Adding a target that already exists"),this.Fc(e),this.targetCount+=1,Vu.resolve()},lc.prototype.po=function(t,e){return Nu(this.Nc.has(e.target),"Updating a non-existent target"),this.Fc(e),Vu.resolve()},lc.prototype.Vc=function(t,e){return Nu(0<this.targetCount,"Removing a target from an empty cache"),Nu(this.Nc.has(e.target),"Removing a non-existent target from the cache"),this.Nc.delete(e.target),this.kc.lu(e.targetId),this.targetCount-=1,Vu.resolve()},lc.prototype.Uc=function(n,i,r){var o=this,s=0,a=[];return this.Nc.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Nc.delete(t),a.push(o.jc(n,e.targetId)),s++)}),Vu.Us(a).next(function(){return s})},lc.prototype.Lc=function(t){return Vu.resolve(this.targetCount)},lc.prototype.No=function(t,e){var n=this.Nc.get(e)||null;return Vu.resolve(n)},lc.prototype.pe=function(t,e){return Iu("Not yet implemented.")},lc.prototype.vo=function(e,t,n){this.kc.hu(t,n);var i=this.persistence.Pu,r=[];return i&&t.forEach(function(t){r.push(i.ou(e,t))}),Vu.Us(r)},lc.prototype.do=function(e,t,n){this.kc.fu(t,n);var i=this.persistence.Pu,r=[];return i&&t.forEach(function(t){r.push(i.cu(e,t))}),Vu.Us(r)},lc.prototype.jc=function(t,e){return this.kc.lu(e),Vu.resolve()},lc.prototype.Fo=function(t,e){var n=this.kc.vu(e);return Vu.resolve(n)},lc.prototype.wu=function(t,e){return Vu.resolve(this.kc.wu(e))},lc),Yh="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Hh=(fc.prototype.shutdown=function(){return this.xc=!1,Promise.resolve()},Object.defineProperty(fc.prototype,"iu",{get:function(){return this.xc},enumerable:!0,configurable:!0}),fc.prototype.Lo=function(){return c(this,void 0,void 0,function(){return v(this,function(t){return[2,[this.clientId]]})})},fc.prototype.Qc=function(t){return t(!0)},fc.prototype.Wc=function(){},fc.prototype.xo=function(t){},fc.prototype.xu=function(){return this.Hh},fc.prototype.Vu=function(t){var e=this.qc[t.i()];return e||(e=new Dh(this.Hh,this.Pu),this.qc[t.i()]=e),e},fc.prototype.qu=function(){return this.Lu},fc.prototype.ju=function(){return this.zh},fc.prototype.runTransaction=function(t,e,n){var i=this;wu("MemoryPersistence","Starting transaction:",t);var r=new zh(this.Mc.next());return this.Pu.Gc(),n(r).next(function(t){return i.Pu.zc(r).next(function(){return t})}).Fs().then(function(t){return r.Gh(),t})},fc.prototype.Hc=function(e,n){return Vu.js((t=this.qc,i=[],Ji(t,function(t,e){return i.push(e)}),i).map(function(t){return function(){return t.wu(e,n)}}));var t,i},fc),zh=(t(cc,qh=Th),cc),Kh=(Object.defineProperty(hc.prototype,"Kc",{get:function(){if(this.Yc)return this.Yc;throw Iu("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),hc.prototype.Ou=function(t){this.Jc=t},hc.prototype.ou=function(t,e){return this.Kc.delete(e),Vu.resolve()},hc.prototype.cu=function(t,e){return this.Kc.add(e),Vu.resolve()},hc.prototype.gc=function(t,e){return this.Kc.add(e),Vu.resolve()},hc.prototype.removeTarget=function(t,e){var n=this,i=this.persistence.qu();return i.Fo(t,e.targetId).next(function(t){t.forEach(function(t){return n.Kc.add(t)})}).next(function(){return i.Vc(t,e)})},hc.prototype.Gc=function(){this.Yc=new Set},hc.prototype.zc=function(t){var n=this,i=this.persistence.ju().no();return Vu.forEach(this.Kc,function(e){return n.Xc(t,e).next(function(t){t||i.Tu(e)})}).next(function(){return n.Yc=null,i.apply(t)})},hc.prototype.bo=function(t,e){var n=this;return this.Xc(t,e).next(function(t){t?n.Kc.delete(e):n.Kc.add(e)})},hc.prototype.Bc=function(t){return 0},hc.prototype.Xc=function(t,e){var n=this;return Vu.js([function(){return n.persistence.qu().wu(t,e)},function(){return n.persistence.Hc(t,e)},function(){return Vu.resolve(n.Jc.wu(e))}])},hc),Wh=(uc.prototype.initialize=function(t,e,n,i,r,o){if(o.$c)throw new Vi(Fi.FAILED_PRECONDITION,Yh);return this.clientId=i,Promise.resolve()},uc.prototype.Zc=function(){var t=!1;return{iu:t,start:function(){return t=!0},stop:function(){return t=!1}}},uc.prototype.ta=function(){return Nu(!!this.clientId,"initialize() not called"),new Hh(this.clientId,function(t){return new Kh(t)})},uc.prototype.na=function(){return new Ih},uc.prototype.clearPersistence=function(){throw new Vi(Fi.FAILED_PRECONDITION,Yh)},uc),Qh=(ac.prototype.reset=function(){this.sa=0},ac.prototype.ha=function(){this.sa=this.ra},ac.prototype.ca=function(t){var e=this;this.cancel();var n=Math.floor(this.sa+this.aa()),i=Math.max(0,Date.now()-this.oa),r=Math.max(0,n-i);0<this.sa&&wu("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.sa+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.ua=this.Xo._s(this.Zr,r,function(){return e.oa=Date.now(),t()}),this.sa*=this.ea,this.sa<this.ia&&(this.sa=this.ia),this.sa>this.ra&&(this.sa=this.ra)},ac.prototype.cancel=function(){null!==this.ua&&(this.ua.cancel(),this.ua=null)},ac.prototype.aa=function(){return(Math.random()-.5)*this.sa},ac),Xh=(sc.prototype.ma=function(){return 1===this.state||2===this.state||4===this.state},sc.prototype.ga=function(){return 2===this.state},sc.prototype.start=function(){3!==this.state?(Nu(0===this.state,"Already started"),this.auth()):this.pa()},sc.prototype.stop=function(){return c(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ma()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},sc.prototype.ba=function(){Nu(!this.ma(),"Can only inhibit backoff in a stopped state"),this.state=0,this.wa.reset()},sc.prototype.ya=function(){var t=this;this.ga()&&null===this.va&&(this.va=this.Xo._s(this.fa,6e4,function(){return t._a()}))},sc.prototype.Ta=function(t){this.Ea(),this.stream.send(t)},sc.prototype._a=function(){return c(this,void 0,void 0,function(){return v(this,function(t){return this.ga()?[2,this.close(0)]:[2]})})},sc.prototype.Ea=function(){this.va&&(this.va.cancel(),this.va=null)},sc.prototype.close=function(e,n){return c(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Nu(this.ma(),"Only started streams should be closed."),Nu(3===e||xs(n),"Can't provide an error when not in an error state."),this.Ea(),this.wa.cancel(),this.da++,3!==e?this.wa.reset():n&&n.code===Fi.RESOURCE_EXHAUSTED?(bu(n.toString()),bu("Using maximum backoff delay to prevent overloading the backend."),this.wa.ha()):n&&n.code===Fi.UNAUTHENTICATED&&this.la.l(),null!==this.stream&&(this.Sa(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ia(n)];case 1:return t.sent(),[2]}})})},sc.prototype.Sa=function(){},sc.prototype.auth=function(){var n=this;Nu(0===this.state,"Must be in initial state to auth"),this.state=1;var t=this.Aa(this.da),e=this.da;this.la.getToken().then(function(t){n.da===e&&n.Ca(t)},function(e){t(function(){var t=new Vi(Fi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Ra(t)})})},sc.prototype.Ca=function(t){var e=this;Nu(1===this.state,"Trying to start stream in a non-starting state");var n=this.Aa(this.da);this.stream=this.Na(t),this.stream.Da(function(){n(function(){return Nu(1===e.state,"Expected stream to be in state Starting, but was "+e.state),e.state=2,e.listener.Da()})}),this.stream.Ia(function(t){n(function(){return e.Ra(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},sc.prototype.pa=function(){var t=this;Nu(3===this.state,"Should only perform backoff when in Error state"),this.state=4,this.wa.ca(function(){return c(t,void 0,void 0,function(){return v(this,function(t){return Nu(4===this.state,"Backoff elapsed but state is now: "+this.state),this.state=0,this.start(),Nu(this.ma(),"PersistentStream should have started"),[2]})})})},sc.prototype.Ra=function(t){return Nu(this.ma(),"Can't handle server close on non-started stream"),wu("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},sc.prototype.Aa=function(e){var n=this;return function(t){n.Xo.hs(function(){return n.da===e?t():(wu("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},sc),$h=(t(oc,Vh=Xh),oc.prototype.Na=function(t){return this.connection.ka("Listen",t)},oc.prototype.onMessage=function(t){this.wa.reset();var e=this.serializer.Xe(t),n=this.serializer.Ze(t);return this.listener.Oa(e,n)},oc.prototype.watch=function(t){var e={};e.database=this.serializer.Ue,e.addTarget=this.serializer.Kn(t);var n=this.serializer._r(t);n&&(e.labels=n),this.Ta(e)},oc.prototype.Pa=function(t){var e={};e.database=this.serializer.Ue,e.removeTarget=t,this.Ta(e)},oc),Zh=(t(rc,Fh=Xh),Object.defineProperty(rc.prototype,"Va",{get:function(){return this.Fa},enumerable:!0,configurable:!0}),rc.prototype.start=function(){this.Fa=!1,Fh.prototype.start.call(this)},rc.prototype.Sa=function(){this.Fa&&this.Ua([])},rc.prototype.Na=function(t){return this.connection.ka("Write",t)},rc.prototype.onMessage=function(t){if(Nu(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=this.serializer.Ie(t.streamToken),this.Fa){this.wa.reset();var e=this.serializer.cr(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.ja(n,e)}return Nu(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.Fa=!0,this.listener.La()},rc.prototype.qa=function(){Nu(this.ga(),"Writing handshake requires an opened stream"),Nu(!this.Fa,"Handshake already completed");var t={};t.database=this.serializer.Ue,this.Ta(t)},rc.prototype.Ua=function(t){var e=this;Nu(this.ga(),"Writing mutations requires an opened stream"),Nu(this.Fa,"Handshake must be complete before writing mutations"),Nu(0<this.lastStreamToken.D(),"Trying to write mutation without a token");var n={streamToken:this.serializer.Se(this.lastStreamToken),writes:t.map(function(t){return e.serializer.tr(t)})};this.Ta(n)},rc),Jh=(ic.prototype.Ma=function(t){return new Zh(this.Xo,this.connection,this.credentials,this.serializer,t)},ic.prototype.xa=function(t){return new $h(this.Xo,this.connection,this.credentials,this.serializer,t)},ic.prototype.commit=function(t){var e=this,n={database:this.serializer.Ue,writes:t.map(function(t){return e.serializer.tr(t)})};return this.Ba("Commit",n).then(function(t){return e.serializer.cr(t.writeResults,t.commitTime)})},ic.prototype.lookup=function(e){var r=this,t={database:this.serializer.Ue,documents:e.map(function(t){return r.serializer.ke(t)})};return this.Qa("BatchGetDocuments",t).then(function(t){var n=Ca();t.forEach(function(t){var e=r.serializer.Je(t);n=n.dt(e.key,e)});var i=[];return e.forEach(function(t){var e=n.get(t);Nu(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},ic.prototype.Ba=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.connection.Ba(e,n,t)}).catch(function(t){throw t.code===Fi.UNAUTHENTICATED&&i.credentials.l(),t})},ic.prototype.Qa=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.connection.Qa(e,n,t)}).catch(function(t){throw t.code===Fi.UNAUTHENTICATED&&i.credentials.l(),t})},ic),tc=(nc.documentId=function(){return nc.Ga},nc.prototype.isEqual=function(t){if(!(t instanceof nc))throw vr("isEqual","FieldPath",1,t);return this.Wa.isEqual(t.Wa)},nc.Ga=new nc(Pr.ot().it()),nc),ec=new RegExp("[~\\*/\\[\\]]");function nc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t,e,n,i){if(!(e instanceof Array)||e.length<i)throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+mr(i,"element")+".")}("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(or("FieldPath","string",n,t[n]),0===t[n].length)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Wa=new Pr(t)}function ic(t,e,n,i){this.Xo=t,this.connection=e,this.credentials=n,this.serializer=i}function rc(t,e,n,i,r){var o=Fh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this;return o.serializer=i,o.Fa=!1,o.lastStreamToken=wr.k,o}function oc(t,e,n,i,r){var o=Vh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this;return o.serializer=i,o}function sc(t,e,n,i,r,o){this.Xo=t,this.fa=n,this.connection=i,this.la=r,this.listener=o,this.state=0,this.da=0,this.va=null,this.stream=null,this.wa=new Qh(t,e)}function ac(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.Xo=t,this.Zr=e,this.ia=n,this.ea=i,this.ra=r,this.sa=0,this.ua=null,this.oa=Date.now(),this.reset()}function uc(){}function hc(t){this.persistence=t,this.Jc=null,this.Yc=null}function cc(t){var e=qh.call(this)||this;return e.wo=t,e}function fc(t,e){var n=this;this.clientId=t,this.qc={},this.Mc=new Pu(0),this.xc=!1,this.xc=!0,this.Pu=e(this),this.Lu=new Bh(this),this.Hh=new kh,this.zh=new Gh(this.Hh,function(t){return n.Pu.Bc(t)})}function lc(t){this.persistence=t,this.Nc=new _u(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Or.MIN,this.highestTargetId=0,this.Dc=0,this.kc=new $u,this.targetCount=0,this.Oc=jh.Cc()}function pc(t,e){Nu((1&(this.Sc=t))===t,"Generator ID "+t+" contains more than 1 reserved bits"),this.Ic(void 0!==e?e:this.Sc)}function dc(t,e){this.Hh=t,this.pc=e,this.docs=new Fr(Mr.G),this.size=0}function vc(t){var e=xh.call(this)||this;return e.Ec=t,e}var yc,gc,mc,wc,bc,Ec=(Vc.delete=function(){return er("FieldValue.delete",arguments),Ic.instance},Vc.serverTimestamp=function(){return er("FieldValue.serverTimestamp",arguments),Nc.instance},Vc.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ir("FieldValue.arrayUnion",arguments,1),new Tc(t)},Vc.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ir("FieldValue.arrayRemove",arguments,1),new Ac(t)},Vc.increment=function(t){return or("FieldValue.increment","number",1,t),nr("FieldValue.increment",arguments,1),new Sc(t)},Vc.prototype.isEqual=function(t){return this===t},Vc),Ic=(t(Fc,bc=Ec),Fc.instance=new Fc,Fc),Nc=(t(Mc,wc=Ec),Mc.instance=new Mc,Mc),Tc=(t(Pc,mc=Ec),Pc),Ac=(t(Uc,gc=Ec),Uc),Sc=(t(_c,yc=Ec),_c),kc=Qi(Ec,"Use FieldValue.<field>() instead."),Rc=/^__.*__$/,Dc=(Lc.prototype.Ya=function(t,e){var n=[];return null!==this.un?n.push(new ko(t,this.data,this.un,e)):n.push(new So(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Ro(t,this.fieldTransforms)),n},Lc),Cc=(Oc.prototype.Ya=function(t,e){var n=[new ko(t,this.data,this.un,e)];return 0<this.fieldTransforms.length&&n.push(new Ro(t,this.fieldTransforms)),n},Oc);function Oc(t,e,n){this.data=t,this.un=e,this.fieldTransforms=n}function Lc(t,e,n){this.data=t,this.un=e,this.fieldTransforms=n}function _c(t){var e=yc.call(this,"FieldValue.increment")||this;return e.Ja=t,e}function Uc(t){var e=gc.call(this,"FieldValue.arrayRemove")||this;return e.Ha=t,e}function Pc(t){var e=mc.call(this,"FieldValue.arrayUnion")||this;return e.Ha=t,e}function Mc(){return wc.call(this,"FieldValue.serverTimestamp")||this}function Fc(){return bc.call(this,"FieldValue.delete")||this}function Vc(t){this.za=t}function qc(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Iu("Unexpected case for UserDataSource: "+t)}}var xc=(Yc.prototype.Za=function(t){var e=null==this.path?null:this.path.child(t),n=new Yc(this.Ka,this.methodName,e,!1,this.fieldTransforms,this.un);return n.tf(t),n},Yc.prototype.nf=function(t){var e=null==this.path?null:this.path.child(t),n=new Yc(this.Ka,this.methodName,e,!1,this.fieldTransforms,this.un);return n.$a(),n},Yc.prototype.if=function(t){return new Yc(this.Ka,this.methodName,null,!0,this.fieldTransforms,this.un)},Yc.prototype.ef=function(t){var e=null===this.path||this.path.K()?"":" (found in field "+this.path.toString()+")";return new Vi(Fi.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},Yc.prototype.contains=function(e){return void 0!==this.un.find(function(t){return e.Z(t)})||void 0!==this.fieldTransforms.find(function(t){return e.Z(t.field)})},Yc.prototype.$a=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.tf(this.path.get(t))},Yc.prototype.tf=function(t){if(0===t.length)throw this.ef("Document fields must not be empty");if(qc(this.Ka)&&Rc.test(t))throw this.ef('Document fields cannot begin and end with "__"')},Yc),Gc=function(t,e){this.In=t,this.key=e},jc=(Bc.prototype.sf=function(t,e){var n=new xc(0,t,Pr.rt);zc("Data must be an object, but it was:",n,e);var i=this.uf(e,n);return new Dc(i,null,n.fieldTransforms)},Bc.prototype.hf=function(t,e,n){var i=new xc(2,t,Pr.rt);zc("Data must be an object, but it was:",i,e);var r,o,s=this.uf(e,i);if(n){for(var a=new Jr(Pr.G),u=0,h=n;u<h.length;u++){var c=h[u],f=void 0;if(c instanceof tc)f=c.Wa;else{if("string"!=typeof c)throw Iu("Expected stringOrFieldPath to be a string or a FieldPath");f=Wc(t,c)}if(!i.contains(f))throw new Vi(Fi.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");a=a.add(f)}r=Io.Kt(a),o=i.fieldTransforms.filter(function(t){return r.$t(t.field)})}else r=Io.Xt(i.un),o=i.fieldTransforms;return new Dc(s,r,o)},Bc.prototype.cf=function(o,t){var s=this,a=new xc(1,o,Pr.rt);zc("Data must be an object, but it was:",a,t);var u=new Jr(Pr.G),h=ms.wn();Ji(t,function(t,e){var n=Wc(o,t),i=a.nf(n);if((e=s.af(e,i))instanceof Ic)u=u.add(n);else{var r=s.uf(e,i);null!=r&&(u=u.add(n),h.set(n,r))}});var e=Io.Kt(u);return new Cc(h.an(),e,a.fieldTransforms)},Bc.prototype.ff=function(t,e,n,i){var r=new xc(1,t,Pr.rt),o=[Kc(t,e)],s=[n];if(i.length%2!=0)throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var a=0;a<i.length;a+=2)o.push(Kc(t,i[a])),s.push(i[a+1]);var u=new Jr(Pr.G),h=ms.wn();for(a=0;a<o.length;++a){var c=o[a],f=r.nf(c),l=this.af(s[a],f);if(l instanceof Ic)u=u.add(c);else{var p=this.uf(l,f);null!=p&&(u=u.add(c),h.set(c,p))}}var d=Io.Kt(u);return new Cc(h.an(),d,r.fieldTransforms)},Bc.prototype.lf=function(t,e,n){void 0===n&&(n=!1);var i=new xc(n?4:3,t,Pr.rt),r=this.uf(e,i);return Nu(null!=r,"Parsed data should not be null."),Nu(0===i.fieldTransforms.length,"Field transforms should have been disallowed."),r},Bc.prototype.af=function(t,e){try{return this.rf(t)}catch(t){var n=Qc(t);throw e.ef(n)}},Bc.prototype.uf=function(t,e){if(Hc(t=this.af(t,e)))return zc("Unsupported field value:",e,t),this.df(t,e);if(t instanceof Ec)return this.vf(t,e),null;if(e.path&&e.un.push(e.path),t instanceof Array){if(e.Xa&&4!==e.Ka)throw e.ef("Nested arrays are not supported");return this.wf(t,e)}return this.mf(t,e)},Bc.prototype.df=function(t,i){var r=this,o=new Fr(Su);return tr(t)?i.path&&0<i.path.length&&i.un.push(i.path):Ji(t,function(t,e){var n=r.uf(e,i.Za(t));null!=n&&(o=o.dt(t,n))}),new ms(o)},Bc.prototype.wf=function(t,e){for(var n=[],i=0,r=0,o=t;r<o.length;r++){var s=o[r],a=this.uf(s,e.if(i));null==a&&(a=_o.yn),n.push(a),i++}return new bs(n)},Bc.prototype.vf=function(t,e){if(!qc(e.Ka))throw e.ef(t.za+"() can only be used with update() and set()");if(null===e.path)throw e.ef(t.za+"() is not currently supported inside arrays");if(t instanceof Ic){if(2!==e.Ka)throw 1===e.Ka?(Nu(0<e.path.length,"FieldValue.delete() at the top level should have already been handled."),e.ef("FieldValue.delete() can only appear at the top level of your update data")):e.ef("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.un.push(e.path)}else if(t instanceof Nc)e.fieldTransforms.push(new No(e.path,eo.instance));else if(t instanceof Tc){var n=this.gf(t.za,t.Ha),i=new no(n);e.fieldTransforms.push(new No(e.path,i))}else if(t instanceof Ac){n=this.gf(t.za,t.Ha);var r=new io(n);e.fieldTransforms.push(new No(e.path,r))}else if(t instanceof Sc){var o=this.lf("FieldValue.increment",t.Ja),s=new ro(o);e.fieldTransforms.push(new No(e.path,s))}else Iu("Unknown FieldValue type: "+t)},Bc.prototype.mf=function(t,e){if(null===t)return _o.yn;if("number"==typeof t)return js(t)?new cs(t):new fs(t);if("boolean"==typeof t)return Uo.of(t);if("string"==typeof t)return new ls(t);if(t instanceof Date)return new ps(Cr.fromDate(t));if(t instanceof Cr)return new ps(new Cr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof Dr)return new gs(t);if(t instanceof kr)return new vs(t);if(t instanceof Gc)return new ys(t.In,t.key);throw e.ef("Unsupported field value: "+lr(t))},Bc.prototype.gf=function(i,t){var r=this;return t.map(function(t,e){var n=new xc(3,i,Pr.rt);return r.uf(t,n.if(e))})},Bc);function Bc(t){this.rf=t}function Yc(t,e,n,i,r,o){this.Ka=t,this.methodName=e,this.path=n,this.Xa=i,void 0===r&&this.$a(),this.Xa=void 0!==i&&i,this.fieldTransforms=r||[],this.un=o||[]}function Hc(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Cr||t instanceof Dr||t instanceof kr||t instanceof Gc||t instanceof Ec)}function zc(t,e,n){if(!Hc(n)||!fr(n)){var i=lr(n);throw"an object"===i?e.ef(t+" a custom object"):e.ef(t+" "+i)}}function Kc(t,e){if(e instanceof tc)return e.Wa;if("string"==typeof e)return Wc(t,e);throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Wc(t,e){try{return function(e){if(0<=e.search(ec))throw new Vi(Fi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(tc.bind.apply(tc,s([void 0],e.split("."))))}catch(t){throw new Vi(Fi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Wa}catch(e){var n=Qc(e);throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Qc(t){return t instanceof Error?t.message:t.toString()}function Xc(t){this.key=t}function $c(t){this.key=t}var Zc=(sf.prototype.lookup=function(i){return c(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Ef(),0<this.mutations.length)throw new Vi(Fi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.pf.lookup(i)];case 1:return(e=t.sent()).forEach(function(t){t instanceof Ns||t instanceof Is?n.Sf(t):Iu("Document in a transaction was a "+t.constructor.name)}),[2,e]}})})},sf.prototype.set=function(t,e){this.write(e.Ya(t,this.en(t))),this.Tf.add(t)},sf.prototype.update=function(t,e){try{this.write(e.Ya(t,this.If(t)))}catch(t){this._f=t}this.Tf.add(t)},sf.prototype.delete=function(t){this.write([new Do(t,this.en(t))]),this.Tf.add(t)},sf.prototype.commit=function(){return c(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Ef(),this._f)throw this._f;return e=this.bf,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new Co(t,n.en(t)))}),[4,this.pf.commit(this.mutations)];case 1:return t.sent(),this.yf=!0,[2]}})})},sf.prototype.Sf=function(t){var e;if(t instanceof Is)e=t.version;else{if(!(t instanceof Ns))throw Iu("Document in a transaction was a "+t.constructor.name);e=Or.q()}var n=this.bf.get(t.key);if(null!==n){if(!e.isEqual(n))throw new Vi(Fi.ABORTED,"Document version changed between two reads.")}else this.bf=this.bf.dt(t.key,e)},sf.prototype.en=function(t){var e=this.bf.get(t);return!this.Tf.has(t)&&e?To.updateTime(e):To.NONE},sf.prototype.If=function(t){var e=this.bf.get(t);if(this.Tf.has(t)||!e)return To.exists(!0);if(e.isEqual(Or.q()))throw new Vi(Fi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return To.updateTime(e)},sf.prototype.write=function(t){this.Ef(),this.mutations=this.mutations.concat(t)},sf.prototype.Ef=function(){Nu(!this.yf,"A transaction object cannot be used after its update callback has been invoked.")},sf),Jc=(of.prototype.Nf=function(){var t=this;0===this.Af&&(this.Df("Unknown"),Nu(null===this.Cf,"onlineStateTimer shouldn't be started yet"),this.Cf=this.$r._s("online_state_timeout",1e4,function(){return t.Cf=null,Nu("Unknown"===t.state,"Timer should be canceled if we transitioned to a different state."),t.kf("Backend didn't respond within 10 seconds."),t.Df("Offline"),Promise.resolve()}))},of.prototype.Of=function(t){"Online"===this.state?(this.Df("Unknown"),Nu(0===this.Af,"watchStreamFailures must be 0"),Nu(null===this.Cf,"onlineStateTimer must be null")):(this.Af++,1<=this.Af&&(this.Pf(),this.kf("Connection failed 1 times. Most recent error: "+t.toString()),this.Df("Offline")))},of.prototype.set=function(t){this.Pf(),this.Af=0,"Online"===t&&(this.Rf=!1),this.Df(t)},of.prototype.Df=function(t){t!==this.state&&(this.state=t,this.th(t))},of.prototype.kf=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rf?(bu(e),this.Rf=!1):wu("OnlineStateTracker",e)},of.prototype.Pf=function(){null!==this.Cf&&(this.Cf.cancel(),this.Cf=null)},of),tf=(rf.prototype.start=function(){return this.enableNetwork()},rf.prototype.enableNetwork=function(){return c(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.Mf()?(e=this.Hf,[4,this.Ff.co()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.Xf()?this.$f():this.Bf.set("Unknown"),[4,this.Zf()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},rf.prototype.disableNetwork=function(){return c(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.tl()];case 1:return t.sent(),this.Bf.set("Offline"),[2]}})})},rf.prototype.tl=function(){return c(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.Hf.stop()];case 1:return t.sent(),[4,this.Qf.stop()];case 2:return t.sent(),0<this.Vf.length&&(wu("RemoteStore","Stopping write stream with "+this.Vf.length+" pending writes"),this.Vf=[]),this.nl(),[2]}})})},rf.prototype.shutdown=function(){return c(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return wu("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.tl()];case 1:return t.sent(),this.Lf.shutdown(),this.Bf.set("Unknown"),[2]}})})},rf.prototype.listen=function(t){Xi(this.Uf,t.targetId)||(this.Uf[t.targetId]=t,this.Xf()?this.$f():this.Qf.ga()&&this.il(t))},rf.prototype.el=function(t){Nu(Xi(this.Uf,t),"unlisten called on target no currently watched: "+t),delete this.Uf[t],this.Qf.ga()&&this.rl(t),tr(this.Uf)&&(this.Qf.ga()?this.Qf.ya():this.Mf()&&this.Bf.set("Unknown"))},rf.prototype.pe=function(t){return this.Uf[t]||null},rf.prototype.ge=function(t){return this.Zo.ge(t)},rf.prototype.il=function(t){this.jf.Yi(t.targetId),this.Qf.watch(t)},rf.prototype.rl=function(t){this.jf.Yi(t),this.Qf.Pa(t)},rf.prototype.$f=function(){Nu(this.Xf(),"startWatchStream() called when shouldStartWatchStream() is false."),this.jf=new Qa(this),this.Qf.start(),this.Bf.Nf()},rf.prototype.Xf=function(){return this.Mf()&&!this.Qf.ma()&&!tr(this.Uf)},rf.prototype.Mf=function(){return this.isPrimary&&this.networkEnabled},rf.prototype.nl=function(){this.jf=null},rf.prototype.Wf=function(){return c(this,void 0,void 0,function(){var n=this;return v(this,function(t){return Zi(this.Uf,function(t,e){n.il(e)}),[2]})})},rf.prototype.Gf=function(e){return c(this,void 0,void 0,function(){return v(this,function(t){return void 0===e&&Nu(!this.Xf(),"Watch stream was stopped gracefully while still needed."),this.nl(),this.Xf()?(this.Bf.Of(e),this.$f()):this.Bf.set("Unknown"),[2]})})},rf.prototype.zf=function(n,i){return c(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.Bf.set("Online"),n instanceof ja&&2===n.state&&n.cause?[2,this.sl(n)]:(n instanceof xa?this.jf.ee(n):n instanceof Ga?this.jf.fe(n):(Nu(n instanceof ja,"Expected watchChange to be an instance of WatchTargetChange"),this.jf.ue(n)),i.isEqual(Or.MIN)?[3,3]:[4,this.Ff.fo()]);case 1:return e=t.sent(),0<=i.M(e)?[4,this.ul(i)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},rf.prototype.ul=function(i){var r=this;Nu(!i.isEqual(Or.MIN),"Can't raise event for unknown SnapshotVersion");var t=this.jf.ve(i);return Zi(t.Si,function(t,e){if(0<e.resumeToken.D()){var n=r.Uf[t];n&&(r.Uf[t]=n.li(e.resumeToken,i))}}),t.Ii.forEach(function(t){var e=r.Uf[t];if(e){r.Uf[t]=e.li(wr.k,e.ai),r.rl(t);var n=new fa(e.target,t,1,e.sequenceNumber);r.il(n)}}),this.Zo.lo(t)},rf.prototype.sl=function(t){var n=this;Nu(!!t.cause,"Handling target error without a cause");var i=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(e){r=r.then(function(){return c(n,void 0,void 0,function(){return v(this,function(t){return Xi(this.Uf,e)?(delete this.Uf[e],this.jf.removeTarget(e),[2,this.Zo.ol(e,i)]):[2]})})})}),r},rf.prototype.Zf=function(){return c(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.hl()?(e=0<this.Vf.length?this.Vf[this.Vf.length-1].batchId:-1,[4,this.Ff.So(e)]):[3,4];case 1:return null!==(n=t.sent())?[3,2]:(0===this.Vf.length&&this.Hf.ya(),[3,4]);case 2:return this.cl(n),[4,this.Zf()];case 3:t.sent(),t.label=4;case 4:return this.al()&&this.fl(),[2]}})})},rf.prototype.hl=function(){return this.Mf()&&this.Vf.length<10},rf.prototype.ll=function(){return this.Vf.length},rf.prototype.cl=function(t){Nu(this.hl(),"addToWritePipeline called when pipeline is full"),this.Vf.push(t),this.Hf.ga()&&this.Hf.Va&&this.Hf.Ua(t.mutations)},rf.prototype.al=function(){return this.Mf()&&!this.Hf.ma()&&0<this.Vf.length},rf.prototype.fl=function(){Nu(this.al(),"startWriteStream() called when shouldStartWriteStream() is false."),this.Hf.start()},rf.prototype.Jf=function(){return c(this,void 0,void 0,function(){return v(this,function(t){return this.Hf.qa(),[2]})})},rf.prototype.Kf=function(){var i=this;return this.Ff.ao(this.Hf.lastStreamToken).then(function(){for(var t=0,e=i.Vf;t<e.length;t++){var n=e[t];i.Hf.Ua(n.mutations)}}).catch(ah)},rf.prototype.ja=function(t,e){var n=this;Nu(0<this.Vf.length,"Got result for empty write pipeline");var i=this.Vf.shift(),r=Lu.from(i,t,e,this.Hf.lastStreamToken);return this.Zo.dl(r).then(function(){return n.Zf()})},rf.prototype.Yf=function(n){return c(this,void 0,void 0,function(){var e=this;return v(this,function(t){return void 0===n&&Nu(!this.al(),"Write stream was stopped gracefully while still needed."),n&&0<this.Vf.length?[2,(this.Hf.Va?this.vl(n):this.wl(n)).then(function(){e.al()&&e.fl()})]:[2]})})},rf.prototype.wl=function(e){return c(this,void 0,void 0,function(){return v(this,function(t){return ka(e.code)?(wu("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.Hf.lastStreamToken),this.Hf.lastStreamToken=wr.k,[2,this.Ff.ao(wr.k).catch(ah)]):[2]})})},rf.prototype.vl=function(r){return c(this,void 0,void 0,function(){var n,i=this;return v(this,function(t){return ka(e=r.code)&&e!==Fi.ABORTED?(n=this.Vf.shift(),this.Hf.ba(),[2,this.Zo.ml(n.batchId,r).then(function(){return i.Zf()})]):[2];var e})})},rf.prototype.gl=function(){return new Zc(this.pf)},rf.prototype.xf=function(){return c(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.tl()];case 1:return t.sent(),this.Bf.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},rf.prototype.pl=function(){return c(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Mf()?(wu("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.xf()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},rf.prototype.bl=function(e){return c(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,4];case 2:return e?[3,4]:[4,this.tl()];case 3:t.sent(),this.Bf.set("Unknown"),t.label=4;case 4:return[2]}})})},rf),ef=(Object.defineProperty(nf.prototype,"Sl",{get:function(){return this.yl},enumerable:!0,configurable:!0}),nf.prototype.Il=function(t,e){var a=this,u=e?e.Al:new Ya,h=e?e.El:this.El,c=e?e.yi:this.yi,f=h,l=!1,p=this.query.ii()&&h.size===this.query.limit?h.last():null,d=this.query.ei()&&h.size===this.query.limit?h.first():null;if(t.pt(function(t,e){var n=h.get(t),i=e instanceof Is?e:null;i&&(Nu(t.isEqual(i.key),"Mismatching keys found in document changes: "+t+" != "+i.key),i=a.query.matches(i)?i:null);var r=!!n&&a.yi.has(n.key),o=!!i&&(i.rn||a.yi.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(u.track({type:3,doc:i}),s=!0):a.Cl(n,i)||(u.track({type:2,doc:i}),s=!0,(p&&0<a.query.Xn(i,p)||d&&a.query.Xn(i,d)<0)&&(l=!0)):!n&&i?(u.track({type:0,doc:i}),s=!0):n&&!i&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=i?(f=f.add(i),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.ii()||this.query.ei())for(;f.size>this.query.limit;){var n=this.query.ii()?f.last():f.first();f=f.delete(n.key),c=c.delete(n.key),u.track({type:1,doc:n})}return Nu(!l||!e,"View was refilled using docs that themselves needed refilling."),{El:f,Al:u,oc:l,yi:c}},nf.prototype.Cl=function(t,e){return t.rn&&e.hasCommittedMutations&&!e.rn},nf.prototype.Au=function(t,e,n){var o=this;Nu(!t.oc,"Cannot apply changes that need a refill");var i=this.El;this.El=t.El,this.yi=t.yi;var r=t.Al.pi();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.Xn(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Iu("Unknown ChangeType: "+t)}}var i,r}),this.Rl(n);var s=e?this.Nl():[],a=0===this.Tl.size&&this.Di?1:0,u=a!==this._l;return this._l=a,0!==r.length||u?{snapshot:new Ha(this.query,t.El,i,r,t.yi,0==a,u,!1),Dl:s}:{Dl:s}},nf.prototype.kl=function(t){return this.Di&&"Offline"===t?(this.Di=!1,this.Au({El:this.El,Al:new Ya,yi:this.yi,oc:!1},!1)):{Dl:[]}},nf.prototype.Ol=function(t){return!this.yl.has(t)&&!!this.El.has(t)&&!this.El.get(t).rn},nf.prototype.Rl=function(t){var e=this;t&&(t.ki.forEach(function(t){return e.yl=e.yl.add(t)}),t.Oi.forEach(function(t){return Nu(e.yl.has(t),"Modified document "+t+" not found in view.")}),t.Pi.forEach(function(t){return e.yl=e.yl.delete(t)}),this.Di=t.Di)},nf.prototype.Nl=function(){var e=this;if(!this.Di)return[];var n=this.Tl;this.Tl=Fa(),this.El.forEach(function(t){e.Ol(t.key)&&(e.Tl=e.Tl.add(t.key))});var i=[];return n.forEach(function(t){e.Tl.has(t)||i.push(new $c(t))}),this.Tl.forEach(function(t){n.has(t)||i.push(new Xc(t))}),i},nf.prototype.Pl=function(t){this.yl=t.Uo,this.Tl=Fa();var e=this.Il(t.documents);return this.Au(e,!0)},nf.prototype.Fl=function(){return Ha.Ei(this.query,this.El,this.yi,0===this._l)},nf);function nf(t,e){this.query=t,this.yl=e,this._l=null,this.Di=!1,this.Tl=Fa(),this.yi=Fa(),this.El=new Ba(t.Xn.bind(t))}function rf(t,e,n,i,r){var o=this;this.Ff=t,this.pf=e,this.Vf=[],this.Uf={},this.jf=null,this.networkEnabled=!1,this.isPrimary=!1,this.Lf=r,this.Lf.qf(function(t){n.hs(function(){return c(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Mf()?(wu("RemoteStore","Restarting streams for network reachability change."),[4,this.xf()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Bf=new Jc(n,i),this.Qf=this.pf.xa({Da:this.Wf.bind(this),Ia:this.Gf.bind(this),Oa:this.zf.bind(this)}),this.Hf=this.pf.Ma({Da:this.Jf.bind(this),Ia:this.Yf.bind(this),La:this.Kf.bind(this),ja:this.ja.bind(this)})}function of(t,e){this.$r=t,this.th=e,this.state="Unknown",this.Af=0,this.Cf=null,this.Rf=!0}function sf(t){this.pf=t,this.bf=Pa(),this.mutations=[],this.yf=!1,this._f=null,this.Tf=new Set}function af(t,e,n){this.query=t,this.targetId=e,this.view=n}function uf(t){this.key=t,this.xl=!1}function hf(){this.yd=null,this.targetId=0,this.listeners=[]}var cf=(Ef.prototype.run=function(){this.jl()},Ef.prototype.jl=function(){var t=this;this.wa.ca(function(){return c(t,void 0,void 0,function(){var e,n,i=this;return v(this,function(t){return e=this.Vl.gl(),(n=this.Ll(e))&&n.then(function(t){i.$r.hs(function(){return e.commit().then(function(){i.es.resolve(t)}).catch(function(t){i.ql(t)})})}).catch(function(t){i.ql(t)}),[2]})})})},Ef.prototype.Ll=function(t){try{var e=this.updateFunction(t);return!xs(e)&&e.catch&&e.then?e:(this.es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.es.reject(t),null}},Ef.prototype.ql=function(t){var e=this;0<this.Ul&&this.Ml(t)?(this.Ul-=1,this.$r.hs(function(){return e.jl(),Promise.resolve()})):this.es.reject(t)},Ef.prototype.Ml=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!ka(e)},Ef),ff=(Object.defineProperty(bf.prototype,"$l",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),bf.prototype.subscribe=function(t){Nu(null!==t,"SyncEngine listener cannot be null"),Nu(null===this.Ql,"SyncEngine already has a subscriber."),this.Ql=t},bf.prototype.listen=function(s){return c(this,void 0,void 0,function(){var e,n,i,r,o;return v(this,function(t){switch(t.label){case 0:return this.Zl("listen()"),(i=this.Wl.get(s))?(e=i.targetId,this.Bl.Th(e),n=i.view.Fl(),[3,4]):[3,1];case 1:return[4,this.Ff.Ro(s.Kn())];case 2:return r=t.sent(),o=this.Bl.Th(r.targetId),e=r.targetId,[4,this.td(s,e,"current"===o)];case 3:n=t.sent(),this.isPrimary&&this.Vl.listen(r),t.label=4;case 4:return this.Ql.Oa([n]),[2,e]}})})},bf.prototype.td=function(a,u,h){return c(this,void 0,void 0,function(){var e,n,i,r,o,s;return v(this,function(t){switch(t.label){case 0:return[4,this.Ff.Po(a,!0)];case 1:return e=t.sent(),n=new ef(a,e.Uo),i=n.Il(e.documents),r=Ka.Ni(u,h&&"Offline"!==this.onlineState),Nu(0===(o=n.Au(i,!0===this.isPrimary,r)).Dl.length,"View returned limbo docs before target ack from the server."),Nu(!!o.snapshot,"applyChanges for new view should always return a snapshot"),s=new af(a,u,n),this.Wl.set(a,s),this.Gl[u]||(this.Gl[u]=[]),this.Gl[u].push(a),[2,o.snapshot]}})})},bf.prototype.nd=function(i){return c(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.Ff.Po(i.query,!0)];case 1:return e=t.sent(),n=i.view.Pl(e),this.isPrimary&&this.ed(i.targetId,n.Dl),[2,n]}})})},bf.prototype.el=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return v(this,function(t){switch(t.label){case 0:return this.Zl("unlisten()"),Nu(!!(e=this.Wl.get(r)),"Trying to unlisten on query not found:"+r),1<(n=this.Gl[e.targetId]).length?(this.Gl[e.targetId]=n.filter(function(t){return!t.isEqual(r)}),this.Wl.delete(r),[2]):this.isPrimary?(this.Bl.Sh(e.targetId),this.Bl.gh(e.targetId)?[3,2]:[4,this.Ff.Oo(e.targetId,!1).then(function(){i.Bl.Ah(e.targetId),i.Vl.el(e.targetId),i.rd(e.targetId)}).catch(ah)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.rd(e.targetId),[4,this.Ff.Oo(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},bf.prototype.write=function(n,i){return c(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.Zl("write()"),[4,this.Ff.Ku(n)];case 1:return e=t.sent(),this.Bl.ph(e.batchId),this.sd(e.batchId,i),[4,this.ud(e.gu)];case 2:return t.sent(),[4,this.Vl.Zf()];case 3:return t.sent(),[2]}})})},bf.prototype.runTransaction=function(t,e,n){new cf(t,this.Vl,e,n).run()},bf.prototype.lo=function(n){return c(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:this.Zl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Ff.lo(n)];case 2:return e=t.sent(),Ji(n.Si,function(t,e){var n=i.Hl[Number(t)];n&&(Nu(e.ki.size+e.Oi.size+e.Pi.size<=1,"Limbo resolution for single document contains multiple changes."),0<e.ki.size?n.xl=!0:0<e.Oi.size?Nu(n.xl,"Received change for limbo target document without add."):0<e.Pi.size&&(Nu(n.xl,"Received remove for limbo target document without add."),n.xl=!1))}),[4,this.ud(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,ah(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},bf.prototype.kl=function(i,t){if(this.isPrimary&&0===t||!this.isPrimary&&1===t){this.Zl("applyOnlineStateChange()");var r=[];this.Wl.forEach(function(t,e){var n=e.view.kl(i);Nu(0===n.Dl.length,"OnlineState should not affect limbo documents."),n.snapshot&&r.push(n.snapshot)}),this.Ql.od(i),this.Ql.Oa(r),this.onlineState=i,this.isPrimary&&this.Bl.Nh(i)}},bf.prototype.ol=function(a,u){return c(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return v(this,function(t){switch(t.label){case 0:return this.Zl("rejectListens()"),this.Bl.Ch(a,"rejected",u),e=this.Hl[a],(n=e&&e.key)?(this.zl=this.zl.remove(n),delete this.Hl[a],i=(i=new Fr(Mr.G)).dt(n,new Ns(n,Or.q())),r=Fa().add(n),o=new za(Or.MIN,{},new Jr(Su),i,r),[2,this.lo(o)]):[3,1];case 1:return[4,this.Ff.Oo(a,!1).then(function(){return s.rd(a,u)}).catch(ah)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},bf.prototype.Lh=function(n,i,r){return c(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.Zl("applyBatchState()"),[4,this.Ff.$u(n)];case 1:return null===(e=t.sent())?(wu("SyncEngine","Cannot apply mutation batch with id: "+n),[2]):"pending"!==i?[3,3]:[4,this.Vl.Zf()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===i||"rejected"===i?(this.hd(n,r||null),this.Ff.qo(n)):Iu("Unknown batchState: "+i),t.label=4;case 4:return[4,this.ud(e)];case 5:return t.sent(),[2]}})})},bf.prototype.dl=function(i){return c(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:this.Zl("applySuccessfulWrite()"),e=i.batch.batchId,this.hd(e,null),this.ad(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Ff.to(i)];case 2:return n=t.sent(),this.Bl.yh(e,"acknowledged"),[4,this.ud(n)];case 3:return t.sent(),[3,6];case 4:return[4,ah(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},bf.prototype.ml=function(n,i){return c(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Zl("rejectFailedWrite()"),this.hd(n,i),this.ad(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Ff.so(n)];case 2:return e=t.sent(),this.Bl.yh(n,"rejected",i),[4,this.ud(e)];case 3:return t.sent(),[3,6];case 4:return[4,ah(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},bf.prototype.fd=function(i){return c(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.Vl.Mf()||wu("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.Ff.ho()];case 1:return-1===(e=t.sent())?i.resolve():((n=this.Kl.get(e)||[]).push(i),this.Kl.set(e,n)),[2]}})})},bf.prototype.ad=function(t){(this.Kl.get(t)||[]).forEach(function(t){t.resolve()}),this.Kl.delete(t)},bf.prototype.ld=function(e){this.Kl.forEach(function(t){t.forEach(function(t){t.reject(new Vi(Fi.CANCELLED,e))})}),this.Kl.clear()},bf.prototype.sd=function(t,e){var n=this.Yl[this.currentUser.i()];n=(n=n||new Fr(Su)).dt(t,e),this.Yl[this.currentUser.i()]=n},bf.prototype.hd=function(t,e){var n=this.Yl[this.currentUser.i()];if(n){var i=n.get(t);i&&(Nu(t===n.wt(),"Mutation callbacks processed out-of-order?"),e?i.reject(e):i.resolve(),n=n.remove(t)),this.Yl[this.currentUser.i()]=n}},bf.prototype.rd=function(t,e){var n=this;void 0===e&&(e=null),this.Bl.Sh(t),Nu(this.Gl[t]&&0!==this.Gl[t].length,"There are no queries mapped to target id "+t);for(var i=0,r=this.Gl[t];i<r.length;i++){var o=r[i];this.Wl.delete(o),e&&this.Ql.dd(o,e)}if(delete this.Gl[t],this.isPrimary){var s=this.Jl.vu(t);this.Jl.lu(t),s.forEach(function(t){n.Jl.wu(t)||n.vd(t)})}},bf.prototype.vd=function(t){var e=this.zl.get(t);null!==e&&(this.Vl.el(e),this.zl=this.zl.remove(t),delete this.Hl[e])},bf.prototype.ed=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof Xc?(this.Jl.ou(r.key,t),this.wd(r)):r instanceof $c?(wu("SyncEngine","Document no longer in limbo: "+r.key),this.Jl.cu(r.key,t),this.Jl.wu(r.key)||this.vd(r.key)):Iu("Unknown limbo change: "+JSON.stringify(r))}},bf.prototype.wd=function(t){var e=t.key;if(!this.zl.get(e)){wu("SyncEngine","New document in limbo: "+e);var n=this.Xl.next(),i=Zs.Ln(e.path);this.Hl[n]=new uf(e),this.Vl.listen(new fa(i.Kn(),n,2,Pu.Xr)),this.zl=this.zl.dt(e,n)}},bf.prototype.md=function(){return this.zl},bf.prototype.ud=function(i,u){return c(this,void 0,void 0,function(){var o,s,e,a=this;return v(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Wl.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.Il(i);return n.oc?a.Ff.Po(r.query,!1).then(function(t){var e=t.documents;return r.view.Il(e,n)}):n}).then(function(t){var e=u&&u.Si[r.targetId],n=r.view.Au(t,!0===a.isPrimary,e);if(a.ed(r.targetId,n.Dl),n.snapshot){a.isPrimary&&a.Bl.Ch(r.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var i=Uu.zr(r.targetId,n.snapshot);s.push(i)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Ql.Oa(o),[4,this.Ff.Eo(s)];case 2:return t.sent(),[2]}})})},bf.prototype.Zl=function(t){Nu(null!==this.Ql,"Trying to call "+t+" before calling subscribe().")},bf.prototype.pl=function(i){return c(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(i),this.currentUser=i,e?(this.ld("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.Ff.Wu(i)]):[3,3];case 1:return n=t.sent(),this.Bl.Wu(i,n.Ju,n.Yu),[4,this.ud(n.Hu)];case 2:t.sent(),t.label=3;case 3:return[4,this.Vl.pl()];case 4:return t.sent(),[2]}})})},bf.prototype.bl=function(u){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,a=this;return v(this,function(t){switch(t.label){case 0:return!0!==u||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Vl.bl(!0)]);case 1:return t.sent(),o=this.Bl.mh(),[4,this.gd(o.nt())];case 2:for(e=t.sent(),n=0,i=e;n<i.length;n++)r=i[n],this.Vl.listen(r);return[3,7];case 3:return!1!==u||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,o=[],s=Promise.resolve(),Zi(this.Gl,function(t,e){a.Bl.Ih(t)?o.push(t):s=s.then(function(){return a.rd(t),a.Ff.Oo(t,!0)}),a.Vl.el(t)}),[4,s]);case 4:return t.sent(),[4,this.gd(o)];case 5:return t.sent(),this.pd(),[4,this.Vl.bl(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},bf.prototype.pd=function(){var e=this;Zi(this.Hl,function(t){e.Vl.el(t)}),this.Jl.du(),this.Hl=[],this.zl=new Fr(Mr.G)},bf.prototype.gd=function(d){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u,h,c,f,l,p;return v(this,function(t){switch(t.label){case 0:e=[],n=[],i=0,r=d,t.label=1;case 1:return i<r.length?(o=r[i],s=void 0,(a=this.Gl[o])&&0!==a.length?[4,this.Ff.Oo(o,!0)]:[3,8]):[3,14];case 2:return t.sent(),[4,this.Ff.Ro(a[0].Kn())];case 3:s=t.sent(),u=0,h=a,t.label=4;case 4:return u<h.length?(c=h[u],Nu(!!(f=this.Wl.get(c)),"No query view found for "+c),[4,this.nd(f)]):[3,7];case 5:(l=t.sent()).snapshot&&n.push(l.snapshot),t.label=6;case 6:return u++,[3,4];case 7:return[3,12];case 8:return Nu(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.Ff.Qo(o)];case 9:return Nu(!!(p=t.sent()),"Target for id "+o+" not found"),[4,this.Ff.Ro(p)];case 10:return s=t.sent(),[4,this.td(this.bd(p),o,!1)];case 11:t.sent(),t.label=12;case 12:e.push(s),t.label=13;case 13:return i++,[3,1];case 14:return this.Ql.Oa(n),[2,e]}})})},bf.prototype.bd=function(t){return new Zs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},bf.prototype.Lo=function(){return this.Ff.Lo()},bf.prototype.qh=function(i,r,o){return c(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(this.isPrimary)return wu("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.Gl[i])return[3,7];switch(r){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.Ff.Wo()];case 2:return e=t.sent(),n=za.Ri(i,"current"===r),[4,this.ud(e,n)];case 3:return t.sent(),[3,7];case 4:return[4,this.Ff.Oo(i,!0)];case 5:return t.sent(),this.rd(i,o),[3,7];case 6:Iu("Unexpected target state: "+r),t.label=7;case 7:return[2]}})})},bf.prototype.Mh=function(f,l){return c(this,void 0,void 0,function(){var e,n,i,r,o,s,a,u,h,c=this;return v(this,function(t){switch(t.label){case 0:if(!this.isPrimary)return[2];e=0,n=f,t.label=1;case 1:return e<n.length?(h=n[e],Nu(!this.Gl[h],"Trying to add an already active target"),[4,this.Ff.Qo(h)]):[3,6];case 2:return Nu(!!(i=t.sent()),"Query data for active target "+h+" not found"),[4,this.Ff.Ro(i)];case 3:return r=t.sent(),[4,this.td(this.bd(i),r.targetId,!1)];case 4:t.sent(),this.Vl.listen(r),t.label=5;case 5:return e++,[3,1];case 6:o=function(e){return v(this,function(t){switch(t.label){case 0:return s.Gl[e]?[4,s.Ff.Oo(e,!1).then(function(){c.Vl.el(e),c.rd(e)}).catch(ah)]:[2,"continue"];case 1:return t.sent(),[2]}})},s=this,a=0,u=l,t.label=7;case 7:return a<u.length?(h=u[a],[5,o(h)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})},bf.prototype.enableNetwork=function(){return this.Ff.xo(!0),this.Vl.enableNetwork()},bf.prototype.disableNetwork=function(){return this.Ff.xo(!1),this.Vl.disableNetwork()},bf.prototype.ge=function(t){var e=this.Hl[t];if(e&&e.xl)return Fa().add(e.key);var n=Fa(),i=this.Gl[t];if(!i)return n;for(var r=0,o=i;r<o.length;r++){var s=o[r],a=this.Wl.get(s);Nu(!!a,"No query view found for "+s),n=n.Qt(a.view.Sl)}return n},bf),lf=(wf.prototype.listen=function(t){var e=t.query,n=!1,i=this._d.get(e);return i||(n=!0,i=new hf,this._d.set(e,i)),i.listeners.push(t),Nu(!t.kl(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),i.yd&&t.Ed(i.yd)&&this.Sd(),n?this.Zo.listen(e).then(function(t){return i.targetId=t}):Promise.resolve(i.targetId)},wf.prototype.el=function(o){return c(this,void 0,void 0,function(){var e,n,i,r;return v(this,function(t){return e=o.query,n=!1,(i=this._d.get(e))&&0<=(r=i.listeners.indexOf(o))&&(i.listeners.splice(r,1),n=0===i.listeners.length),n?(this._d.delete(e),[2,this.Zo.el(e)]):[2]})})},wf.prototype.Oa=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this._d.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++)u[a].Ed(r)&&(e=!0);s.yd=r}}e&&this.Sd()},wf.prototype.dd=function(t,e){var n=this._d.get(t);if(n)for(var i=0,r=n.listeners;i<r.length;i++)r[i].onError(e);this._d.delete(t)},wf.prototype.od=function(r){this.onlineState=r;var o=!1;this._d.forEach(function(t,e){for(var n=0,i=e.listeners;n<i.length;n++)i[n].kl(r)&&(o=!0)}),o&&this.Sd()},wf.prototype.Id=function(t){this.Td.add(t),t.next()},wf.prototype.Ad=function(t){this.Td.delete(t)},wf.prototype.Sd=function(){this.Td.forEach(function(t){t.next()})},wf),pf=(mf.prototype.Ed=function(t){if(Nu(0<t.docChanges.length||t._i,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Ha(t.query,t.docs,t.bi,e,t.yi,t.fromCache,t._i,!0)}var o=!1;return this.Rd?this.Dd(t)&&(this.Cd.next(t),o=!0):this.kd(t,this.onlineState)&&(this.Od(t),o=!0),this.Nd=t,o},mf.prototype.onError=function(t){this.Cd.error(t)},mf.prototype.kl=function(t){this.onlineState=t;var e=!1;return this.Nd&&!this.Rd&&this.kd(this.Nd,t)&&(this.Od(this.Nd),e=!0),e},mf.prototype.kd=function(t,e){if(Nu(!this.Rd,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n="Offline"!==e;return this.options.Pd&&n?(Nu(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.K()||"Offline"===e},mf.prototype.Dd=function(t){if(0<t.docChanges.length)return!0;var e=this.Nd&&this.Nd.hasPendingWrites!==t.hasPendingWrites;return!(!t._i&&!e)&&!0===this.options.includeMetadataChanges},mf.prototype.Od=function(t){Nu(!this.Rd,"Trying to raise initial events for second time"),t=Ha.Ei(t.query,t.docs,t.yi,t.fromCache),this.Rd=!0,this.Cd.next(t)},mf),df=(gf.prototype.start=function(e,n){var i=this;this.Vd();var r=new Du,o=new Du,s=!1;return this.credentials.v(function(t){s?i.$r.hs(function(){return i.pl(t)}):(s=!0,i.Ud(e,n,t,o).then(function(){return i.jd(t)}).then(r.resolve,r.reject))}),this.$r.hs(function(){return r.promise}),o.promise},gf.prototype.enableNetwork=function(){var t=this;return this.Vd(),this.$r.enqueue(function(){return t.Zo.enableNetwork()})},gf.prototype.Ud=function(n,i,r,o){return c(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,n.initialize(this.$r,this.Fd,this.platform,this.clientId,r,i)];case 1:return t.sent(),this.persistence=n.ta(),this.Ld=n.Zc(),this.Bl=n.na(),o.resolve(),[3,3];case 2:if(e=t.sent(),o.reject(e),!this.qd(e))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),[2,this.Ud(new Wh,{$c:!1},r,o)];case 3:return[2]}})})},gf.prototype.qd=function(t){return"FirebaseError"===t.name?t.code===Fi.FAILED_PRECONDITION||t.code===Fi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},gf.prototype.Vd=function(){if(this.$r.ws)throw new Vi(Fi.FAILED_PRECONDITION,"The client has already been terminated.")},gf.prototype.jd=function(h){var t=this;return wu("FirestoreClient","Initializing. user=",h.uid),this.platform.Md(this.Fd).then(function(u){return c(t,void 0,void 0,function(){var e,n,i,r,o,s,a=this;return v(this,function(t){switch(t.label){case 0:return e=new Sh,this.Ff=new th(this.persistence,e,h),[4,this.Ff.start()];case 1:return t.sent(),n=this.platform.xd(),i=this.platform.Bd(this.Fd.In),r=new Jh(this.$r,u,this.credentials,i),o=function(t){return a.Zo.kl(t,0)},s=function(t){return a.Zo.kl(t,1)},this.Vl=new tf(this.Ff,r,this.$r,o,n),this.Zo=new ff(this.Ff,this.Vl,this.Bl,h),this.Bl.th=s,this.Vl.Zo=this.Zo,this.Bl.Zo=this.Zo,this.Qd=new lf(this.Zo),[4,this.Bl.start()];case 2:return t.sent(),[4,this.Vl.start()];case 3:return t.sent(),[4,this.persistence.Qc(function(e){return c(a,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.Zo.bl(e)];case 1:return t.sent(),e&&!this.Ld.iu?this.Ld.start(this.Ff):e||this.Ld.stop(),[2]}})})})];case 4:return t.sent(),[4,this.persistence.Wc(function(){return c(a,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})})];case 5:return t.sent(),[2]}})})})},gf.prototype.pl=function(t){return this.$r.Es(),wu("FirestoreClient","Credential Changed. Current user: "+t.uid),this.Zo.pl(t)},gf.prototype.disableNetwork=function(){var t=this;return this.Vd(),this.$r.enqueue(function(){return t.Zo.disableNetwork()})},gf.prototype.terminate=function(){var t=this;return this.$r.ys(function(){return c(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ld.stop(),[4,this.Vl.shutdown()];case 1:return t.sent(),[4,this.Bl.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:return t.sent(),this.credentials.m(),[2]}})})})},gf.prototype.waitForPendingWrites=function(){var t=this;this.Vd();var e=new Du;return this.$r.hs(function(){return t.Zo.fd(e)}),e.promise},gf.prototype.listen=function(t,e,n){var i=this;this.Vd();var r=new pf(t,e,n);return this.$r.hs(function(){return i.Qd.listen(r)}),r},gf.prototype.el=function(t){var e=this;this.Wd||this.$r.hs(function(){return e.Qd.el(t)})},gf.prototype.Gd=function(t){var e=this;return this.Vd(),this.$r.enqueue(function(){return e.Ff.Ao(t)}).then(function(t){if(t instanceof Is)return t;if(t instanceof Ns)return null;throw new Vi(Fi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},gf.prototype.zd=function(r){var t=this;return this.Vd(),this.$r.enqueue(function(){return c(t,void 0,void 0,function(){var e,n,i;return v(this,function(t){switch(t.label){case 0:return[4,this.Ff.Po(r,!0)];case 1:return e=t.sent(),n=new ef(r,e.Uo),i=n.Il(e.documents),[2,n.Au(i,!1).snapshot]}})})})},gf.prototype.write=function(t){var e=this;this.Vd();var n=new Du;return this.$r.hs(function(){return e.Zo.write(t,n)}),n.promise},gf.prototype.In=function(){return this.Fd.In},gf.prototype.Id=function(t){var e=this;this.Vd(),this.$r.hs(function(){return e.Qd.Id(t),Promise.resolve()})},gf.prototype.Ad=function(t){this.Wd||this.Qd.Ad(t)},Object.defineProperty(gf.prototype,"Wd",{get:function(){return this.$r.ws},enumerable:!0,configurable:!0}),gf.prototype.transaction=function(t){var e=this;this.Vd();var n=new Du;return this.$r.hs(function(){return e.Zo.runTransaction(e.$r,t,n),Promise.resolve()}),n.promise},gf),vf=(yf.prototype.next=function(t){this.Hd(this.observer.next,t)},yf.prototype.error=function(t){this.Hd(this.observer.error,t)},yf.prototype.Jd=function(){this.muted=!0},yf.prototype.Hd=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},yf);function yf(t){this.observer=t,this.muted=!1}function gf(t,e,n,i){this.platform=t,this.Fd=e,this.credentials=n,this.$r=i,this.clientId=Tu.Ur()}function mf(t,e,n){this.query=t,this.Cd=e,this.Rd=!1,this.Nd=null,this.onlineState="Unknown",this.options=n||{}}function wf(t){this.Zo=t,this._d=new _u(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.Td=new Set,this.Zo.subscribe(this)}function bf(t,e,n,i){this.Ff=t,this.Vl=e,this.Bl=n,this.currentUser=i,this.Ql=null,this.Wl=new _u(function(t){return t.canonicalId()}),this.Gl={},this.zl=new Fr(Mr.G),this.Hl={},this.Jl=new $u,this.Yl={},this.Kl=new Map,this.Xl=jh.Rc(),this.isPrimary=void 0,this.onlineState="Unknown"}function Ef(t,e,n,i){this.$r=t,this.Vl=e,this.updateFunction=n,this.es=i,this.Ul=5,this.wa=new Qh(this.$r,"retry_transaction")}function If(r){return function(){if("object"!=typeof r||null===r)return!1;for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return!0}return!1}()}var Nf,Tf=Xu.Js,Af=(Yf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},Yf),Sf=(Bf.prototype.settings=function(t){if(nr("Firestore.settings",arguments,1),or("Firestore.settings","object",1,t),Xi(t,"persistence"))throw new Vi(Fi.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new Af(t);if(this.$d&&!this.rv.isEqual(e))throw new Vi(Fi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.rv=e).credentials&&(this.iv=function(t){if(!t)return new qi;switch(t.type){case"gapi":var e=t.C;return Nu(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new ji(e,t.I||"0");case"provider":return t.C;default:throw new Vi(Fi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Bf.prototype.enableNetwork=function(){return this.Xd(),this.$d.enableNetwork()},Bf.prototype.disableNetwork=function(){return this.Xd(),this.$d.disableNetwork()},Bf.prototype.enablePersistence=function(t){if(this.$d)throw new Vi(Fi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&bu("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=$i(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.ov(this.ev,{$c:!0,cacheSizeBytes:this.rv.cacheSizeBytes,synchronizeTabs:e})},Bf.prototype.clearPersistence=function(){return c(this,void 0,void 0,function(){var i,e=this;return v(this,function(t){if(void 0!==this.$d&&!this.$d.Wd)throw new Vi(Fi.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new Du,this.Kd.ms(function(){return c(e,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.hv(),[4,this.ev.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),[2,i.promise]})})},Bf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Bf.prototype,"cv",{get:function(){return this.Xd(),this.$d.Wd},enumerable:!0,configurable:!0}),Bf.prototype.waitForPendingWrites=function(){return this.Xd(),this.$d.waitForPendingWrites()},Bf.prototype.onSnapshotsInSync=function(t){if(this.Xd(),If(t))return this.av(t);or("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.av(e)},Bf.prototype.av=function(t){var e=this,n=new vf({next:function(){t.next&&t.next()},error:function(t){throw Iu("Uncaught Error in onSnapshotsInSync")}});return this.$d.Id(n),function(){n.Jd(),e.$d.Ad(n)}},Bf.prototype.Xd=function(){return this.$d||this.ov(new Wh,{$c:!1}),this.$d},Bf.prototype.hv=function(){return new Ru(this.Zd,this.nv,this.rv.host,this.rv.ssl,this.rv.forceLongPolling)},Bf.prototype.ov=function(t,e){Nu(!!this.rv.host,"FirestoreSettings.host is not set"),Nu(!this.$d,"configureClient() called multiple times");var n=this.hv();return this.$d=new df(pu.N(),n,this.iv,this.Kd),this.$d.start(t,e)},Bf.prototype.uv=function(i){return new jc(function(t){if(t instanceof Df){var e=i,n=t.firestore.Zd;if(!n.isEqual(e))throw new Vi(Fi.INVALID_ARGUMENT,"Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+e.projectId+"/"+e.database);return new Gc(i,t.fv)}return t})},Bf.tv=function(t){var e=t.options;if(!Xi(e,"projectId"))throw new Vi(Fi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!=typeof n)throw new Vi(Fi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Cu(n)},Object.defineProperty(Bf.prototype,"app",{get:function(){if(!this.Yd)throw new Vi(Fi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Yd},enumerable:!0,configurable:!0}),Bf.prototype.collection=function(t){return nr("Firestore.collection",arguments,1),or("Firestore.collection","non-empty string",1,t),this.Xd(),new zf(_r.et(t),this)},Bf.prototype.doc=function(t){return nr("Firestore.doc",arguments,1),or("Firestore.doc","non-empty string",1,t),this.Xd(),Df.lv(_r.et(t),this)},Bf.prototype.collectionGroup=function(t){if(nr("Firestore.collectionGroup",arguments,1),or("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Vi(Fi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Xd(),new _f(new Zs(_r.rt,t),this)},Bf.prototype.runTransaction=function(e){var n=this;return nr("Firestore.runTransaction",arguments,1),or("Firestore.runTransaction","function",1,e),this.Xd().transaction(function(t){return e(new kf(n,t))})},Bf.prototype.batch=function(){return this.Xd(),new Rf(this)},Object.defineProperty(Bf,"logLevel",{get:function(){switch(gu()){case 0:return"debug";case 1:return"error";case 2:return"silent";default:return Iu("Unknown log level: "+gu())}},enumerable:!0,configurable:!0}),Bf.setLogLevel=function(t){switch(nr("Firestore.setLogLevel",arguments,1),or("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":mu(0);break;case"error":mu(1);break;case"silent":mu(2);break;default:throw new Vi(Fi.INVALID_ARGUMENT,"Invalid log level: "+t)}},Bf.prototype.dv=function(){return this.rv.timestampsInSnapshots},Bf),kf=(jf.prototype.get=function(t){var n=this;nr("Transaction.get",arguments,1);var i=$f("Transaction.get",t,this.vv);return this.wv.lookup([i.fv]).then(function(t){if(!t||1!==t.length)return Iu("Mismatch in docs returned from document lookup.");var e=t[0];if(e instanceof Ns)return new Of(n.vv,i.fv,null,!1,!1,i.mv);if(e instanceof Is)return new Of(n.vv,i.fv,e,!1,!1,i.mv);throw Iu("BatchGetDocumentsRequest returned unexpected document type: "+e.constructor.name)})},jf.prototype.set=function(t,e,n){rr("Transaction.set",arguments,2,3);var i=$f("Transaction.set",t,this.vv);n=Wf("Transaction.set",n);var r=Zf(i.mv,e,"Transaction.set"),o=r[0],s=r[1],a=n.merge||n.mergeFields?this.vv.sv.hf(s,o,n.mergeFields):this.vv.sv.sf(s,o);return this.wv.set(i.fv,a),this},jf.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof tc?(ir("Transaction.update",arguments,3),i=$f("Transaction.update",t,this.vv),this.vv.sv.ff("Transaction.update",e,n,o)):(nr("Transaction.update",arguments,2),i=$f("Transaction.update",t,this.vv),this.vv.sv.cf("Transaction.update",e)),this.wv.update(i.fv,r),this},jf.prototype.delete=function(t){nr("Transaction.delete",arguments,1);var e=$f("Transaction.delete",t,this.vv);return this.wv.delete(e.fv),this},jf),Rf=(Gf.prototype.set=function(t,e,n){rr("WriteBatch.set",arguments,2,3),this.bv();var i=$f("WriteBatch.set",t,this.vv);n=Wf("WriteBatch.set",n);var r=Zf(i.mv,e,"WriteBatch.set"),o=r[0],s=r[1],a=n.merge||n.mergeFields?this.vv.sv.hf(s,o,n.mergeFields):this.vv.sv.sf(s,o);return this.gv=this.gv.concat(a.Ya(i.fv,To.NONE)),this},Gf.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.bv(),r="string"==typeof e||e instanceof tc?(ir("WriteBatch.update",arguments,3),i=$f("WriteBatch.update",t,this.vv),this.vv.sv.ff("WriteBatch.update",e,n,o)):(nr("WriteBatch.update",arguments,2),i=$f("WriteBatch.update",t,this.vv),this.vv.sv.cf("WriteBatch.update",e)),this.gv=this.gv.concat(r.Ya(i.fv,To.exists(!0))),this},Gf.prototype.delete=function(t){nr("WriteBatch.delete",arguments,1),this.bv();var e=$f("WriteBatch.delete",t,this.vv);return this.gv=this.gv.concat(new Do(e.fv,To.NONE)),this},Gf.prototype.commit=function(){return c(this,void 0,void 0,function(){return v(this,function(t){return this.bv(),this.pv=!0,0<this.gv.length?[2,this.vv.Xd().write(this.gv)]:[2]})})},Gf.prototype.bv=function(){if(this.pv)throw new Vi(Fi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Gf),Df=(xf.lv=function(t,e,n){if(t.length%2!=0)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.it()+" has "+t.length);return new xf(new Mr(t),e,n)},Object.defineProperty(xf.prototype,"id",{get:function(){return this.fv.path.$()},enumerable:!0,configurable:!0}),Object.defineProperty(xf.prototype,"parent",{get:function(){return new zf(this.fv.path.Y(),this.firestore,this.mv)},enumerable:!0,configurable:!0}),Object.defineProperty(xf.prototype,"path",{get:function(){return this.fv.path.it()},enumerable:!0,configurable:!0}),xf.prototype.collection=function(t){if(nr("DocumentReference.collection",arguments,1),or("DocumentReference.collection","non-empty string",1,t),!t)throw new Vi(Fi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=_r.et(t);return new zf(this.fv.path.child(e),this.firestore)},xf.prototype.isEqual=function(t){if(!(t instanceof xf))throw vr("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.fv.isEqual(t.fv)&&this.mv===t.mv},xf.prototype.set=function(t,e){rr("DocumentReference.set",arguments,1,2),e=Wf("DocumentReference.set",e);var n=Zf(this.mv,t,"DocumentReference.set"),i=n[0],r=n[1],o=e.merge||e.mergeFields?this.firestore.sv.hf(r,i,e.mergeFields):this.firestore.sv.sf(r,i);return this.$d.write(o.Ya(this.fv,To.NONE))},xf.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof tc?(ir("DocumentReference.update",arguments,2),this.firestore.sv.ff("DocumentReference.update",t,e,i)):(nr("DocumentReference.update",arguments,1),this.firestore.sv.cf("DocumentReference.update",t)),this.$d.write(n.Ya(this.fv,To.exists(!0)))},xf.prototype.delete=function(){return nr("DocumentReference.delete",arguments,0),this.$d.write([new Do(this.fv,To.NONE)])},xf.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];rr("DocumentReference.onSnapshot",arguments,1,4);var n,i={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||If(t[r])||(dr("DocumentReference.onSnapshot",i=t[r],["includeMetadataChanges"]),ur("DocumentReference.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++);var o={includeMetadataChanges:i.includeMetadataChanges};return n=If(t[r])?t[r]:(or("DocumentReference.onSnapshot","function",r,t[r]),sr("DocumentReference.onSnapshot","function",r+1,t[r+1]),sr("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.yv(o,n)},xf.prototype.yv=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new vf({next:function(t){if(n.next){Nu(t.docs.size<=1,"Too many documents returned on a document query");var e=t.docs.get(i.fv);n.next(new Of(i.firestore,i.fv,e,t.fromCache,t.hasPendingWrites,i.mv))}},error:e}),o=this.$d.listen(Zs.Ln(this.fv.path),r,t);return function(){r.Jd(),i.$d.el(o)}},xf.prototype.get=function(n){var i=this;return rr("DocumentReference.get",arguments,0,1),Xf("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.Xd().Gd(i.fv).then(function(t){e(new Of(i.firestore,i.fv,t,!0,t instanceof Is&&t.rn,i.mv))},t):i._v(e,t,n)})},xf.prototype._v=function(e,n,i){var r=this.yv({includeMetadataChanges:!0,Pd:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new Vi(Fi.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new Vi(Fi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},xf.prototype.withConverter=function(t){return new xf(this.fv,this.firestore,t)},xf),Cf=(qf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},qf),Of=(Vf.prototype.data=function(t){if(rr("DocumentSnapshot.data",arguments,0,1),t=Qf("DocumentSnapshot.data",t),this.Tv){if(this.mv){var e=new Lf(this.vv,this.fv,this.Tv,this.Ev,this.Sv);return this.mv.fromFirestore(e,t)}return this.Iv(this.Tv.data(),Oo.gn(t,this.vv.dv()))}},Vf.prototype.get=function(t,e){if(rr("DocumentSnapshot.get",arguments,1,2),e=Qf("DocumentSnapshot.get",e),this.Tv){var n=this.Tv.data().field(Kc("DocumentSnapshot.get",t));if(null!==n)return this.Av(n,Oo.gn(e,this.vv.dv()))}},Object.defineProperty(Vf.prototype,"id",{get:function(){return this.fv.path.$()},enumerable:!0,configurable:!0}),Object.defineProperty(Vf.prototype,"ref",{get:function(){return new Df(this.fv,this.vv,this.mv)},enumerable:!0,configurable:!0}),Object.defineProperty(Vf.prototype,"exists",{get:function(){return null!==this.Tv},enumerable:!0,configurable:!0}),Object.defineProperty(Vf.prototype,"metadata",{get:function(){return new Cf(this.Sv,this.Ev)},enumerable:!0,configurable:!0}),Vf.prototype.isEqual=function(t){if(!(t instanceof Vf))throw vr("isEqual","DocumentSnapshot",1,t);return this.vv===t.vv&&this.Ev===t.Ev&&this.fv.isEqual(t.fv)&&(null===this.Tv?null===t.Tv:this.Tv.isEqual(t.Tv))&&this.mv===t.mv},Vf.prototype.Iv=function(t,n){var i=this,r={};return t.forEach(function(t,e){r[t]=i.Av(e,n)}),r},Vf.prototype.Av=function(t,e){if(t instanceof ms)return this.Iv(t,e);if(t instanceof bs)return this.Cv(t,e);if(t instanceof ys){var n=t.value(e),i=this.vv.Xd().In();return t.In.isEqual(i)||bu("Document "+this.fv.path+" contains a document reference within a different database ("+t.In.projectId+"/"+t.In.database+") which is not supported. It will be treated as a reference in the current database ("+i.projectId+"/"+i.database+") instead."),new Df(n,this.vv,this.mv)}return t.value(e)},Vf.prototype.Cv=function(t,e){var n=this;return t.Yt.map(function(t){return n.Av(t,e)})},Vf),Lf=(t(Ff,Nf=Of),Ff.prototype.data=function(t){var e=Nf.prototype.data.call(this,t);return Nu(void 0!==e,"Document in a QueryDocumentSnapshot should exist"),e},Ff),_f=(Mf.prototype.where=function(t,e,n){var i;nr("Query.where",arguments,3),pr("Query.where",3,n),function(t,e,n,i){if(!e.some(function(t){return t===i}))throw new Vi(Fi.INVALID_ARGUMENT,"Invalid value "+lr(i)+" provided to function "+t+"() for its "+gr(n)+" argument. Acceptable values: "+e.join(", "))}("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var r=Kc("Query.where",t),o=Js.et(e);if(r.ut()){if(o===Js.ARRAY_CONTAINS||o===Js.ARRAY_CONTAINS_ANY)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o.toString()+"' queries on FieldPath.documentId().");if(o===Js.IN){this.Nv(n,o);for(var s=[],a=0,u=n;a<u.length;a++){var h=u[a];s.push(this.Dv(h))}i=new bs(s)}else i=this.Dv(n)}else o!==Js.IN&&o!==Js.ARRAY_CONTAINS_ANY||this.Nv(n,o),i=this.firestore.sv.lf("Query.where",n,o===Js.IN);var c=ta.create(r,o,i);return this.kv(c),new Mf(this.Rv.xn(c),this.firestore,this.mv)},Mf.prototype.orderBy=function(t,e){var n;if(rr("Query.orderBy",arguments,1,2),sr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n=sa.ASCENDING;else{if("desc"!==e)throw new Vi(Fi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n=sa.DESCENDING}if(null!==this.Rv.startAt)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.Rv.endAt)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Kc("Query.orderBy",t),r=new ua(i,n);return this.Ov(r),new Mf(this.Rv.Qn(r),this.firestore,this.mv)},Mf.prototype.limit=function(t){return nr("Query.limit",arguments,1),or("Query.limit","number",1,t),yr("Query.limit",1,t),new Mf(this.Rv.Wn(t),this.firestore,this.mv)},Mf.prototype.limitToLast=function(t){return nr("Query.limitToLast",arguments,1),or("Query.limitToLast","number",1,t),yr("Query.limitToLast",1,t),new Mf(this.Rv.Gn(t),this.firestore,this.mv)},Mf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ir("Query.startAt",arguments,1);var i=this.Pv("Query.startAt",t,e,!0);return new Mf(this.Rv.zn(i),this.firestore,this.mv)},Mf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ir("Query.startAfter",arguments,1);var i=this.Pv("Query.startAfter",t,e,!1);return new Mf(this.Rv.zn(i),this.firestore,this.mv)},Mf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ir("Query.endBefore",arguments,1);var i=this.Pv("Query.endBefore",t,e,!0);return new Mf(this.Rv.Hn(i),this.firestore,this.mv)},Mf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ir("Query.endAt",arguments,1);var i=this.Pv("Query.endAt",t,e,!1);return new Mf(this.Rv.Hn(i),this.firestore,this.mv)},Mf.prototype.isEqual=function(t){if(!(t instanceof Mf))throw vr("isEqual","Query",1,t);return this.firestore===t.firestore&&this.Rv.isEqual(t.Rv)},Mf.prototype.withConverter=function(t){return new Mf(this.Rv,this.firestore,t)},Mf.prototype.Pv=function(t,e,n,i){if(pr(t,1,e),e instanceof Of){if(0<n.length)throw new Vi(Fi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var r=e;if(!r.exists)throw new Vi(Fi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.Fv(t,r.Tv,i)}var o=[e].concat(n);return this.Vv(t,o,i)},Mf.prototype.Fv=function(t,e,n){for(var i=[],r=0,o=this.Rv.orderBy;r<o.length;r++){var s=o[r];if(s.field.ut())i.push(new ys(this.firestore.Zd,e.key));else{var a=e.field(s.field);if(a instanceof ds)throw new Vi(Fi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var u=s.field.it();throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new aa(i,n)},Mf.prototype.Vv=function(t,e,n){var i=this.Rv.Pn;if(e.length>i.length)throw new Vi(Fi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.ut()){if("string"!=typeof s)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.Rv.si()&&-1!==s.indexOf("/"))throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var a=this.Rv.path.child(_r.et(s));if(!Mr.ct(a))throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+a+"' is not because it contains an odd number of segments.");var u=new Mr(a);r.push(new ys(this.firestore.Zd,u))}else{var h=this.firestore.sv.lf(t,s);r.push(h)}}return new aa(r,n)},Mf.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];rr("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||If(t[r])||(dr("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),ur("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=If(t[r])?t[r]:(or("Query.onSnapshot","function",r,t[r]),sr("Query.onSnapshot","function",r+1,t[r+1]),sr("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Uv(this.Rv),this.yv(i,n)},Mf.prototype.yv=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new vf({next:function(t){e.next&&e.next(new Uf(n.firestore,n.Rv,t,n.mv))},error:i}),o=this.firestore.Xd(),s=o.listen(this.Rv,r,t);return function(){r.Jd(),o.el(s)}},Mf.prototype.Uv=function(t){if(t.ei()&&0===t.Pn.length)throw new Vi(Fi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Mf.prototype.get=function(n){var i=this;return rr("Query.get",arguments,0,1),Xf("Query.get",n),this.Uv(this.Rv),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.Xd().zd(i.Rv).then(function(t){e(new Uf(i.firestore,i.Rv,t,i.mv))},t):i._v(e,t,n)})},Mf.prototype._v=function(e,n,i){var r=this.yv({includeMetadataChanges:!0,Pd:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new Vi(Fi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Mf.prototype.Dv=function(t){if("string"==typeof t){if(""===t)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.Rv.si()&&-1!==t.indexOf("/"))throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.Rv.path.child(_r.et(t));if(!Mr.ct(e))throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return new ys(this.firestore.Zd,new Mr(e))}if(t instanceof Df){var n=t;return new ys(this.firestore.Zd,n.fv)}throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+lr(t)+".")},Mf.prototype.Nv=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Vi(Fi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Mf.prototype.kv=function(t){if(t instanceof ta){var e=[Js.ARRAY_CONTAINS,Js.ARRAY_CONTAINS_ANY],n=[Js.IN,Js.ARRAY_CONTAINS_ANY],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.Bn()){var o=this.Rv.qn();if(null!==o&&!o.isEqual(t.field))throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.Rv.Mn();null!==s&&this.jv(t.field,s)}else if(r||i){var a=null;if(r&&(a=this.Rv.ri(n)),null===a&&i&&(a=this.Rv.ri(e)),null!=a)throw a===t.op?new Vi(Fi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Vi(Fi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+a.toString()+"' filters.")}}},Mf.prototype.Ov=function(t){if(null===this.Rv.Mn()){var e=this.Rv.qn();null!==e&&this.jv(e,t.field)}},Mf.prototype.jv=function(t,e){if(!e.isEqual(t))throw new Vi(Fi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},Mf),Uf=(Object.defineProperty(Pf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Pf.prototype,"empty",{get:function(){return this.qv.docs.K()},enumerable:!0,configurable:!0}),Object.defineProperty(Pf.prototype,"size",{get:function(){return this.qv.docs.size},enumerable:!0,configurable:!0}),Pf.prototype.forEach=function(e,n){var i=this;rr("QuerySnapshot.forEach",arguments,1,2),or("QuerySnapshot.forEach","function",1,e),this.qv.docs.forEach(function(t){e.call(n,i.Bv(t))})},Object.defineProperty(Pf.prototype,"query",{get:function(){return new _f(this.Lv,this.vv,this.mv)},enumerable:!0,configurable:!0}),Pf.prototype.docChanges=function(t){t&&(dr("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ur("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.qv.Ti)throw new Vi(Fi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Mv&&this.xv===e||(this.Mv=function(r,e,o,s){if(o.bi.K()){var n,i=0;return o.docChanges.map(function(t){var e=new Lf(r,t.doc.key,t.doc,o.fromCache,o.yi.has(t.doc.key),s);return Nu(0===t.type,"Invalid event type for first snapshot"),Nu(!n||o.query.Xn(n,t.doc)<0,"Got added events in wrong order"),n=t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:i++}})}var a=o.bi;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Lf(r,t.doc.key,t.doc,o.fromCache,o.yi.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(Nu(0<=(n=a.indexOf(t.doc.key)),"Index for document not found"),a=a.delete(t.doc.key)),1!==t.type&&(i=(a=a.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Iu("Unknown change type: "+t)}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.vv,e,this.qv,this.mv),this.xv=e),this.Mv},Pf.prototype.isEqual=function(t){if(!(t instanceof Pf))throw vr("isEqual","QuerySnapshot",1,t);return this.vv===t.vv&&this.Lv.isEqual(t.Lv)&&this.qv.isEqual(t.qv)&&this.mv===t.mv},Pf.prototype.Bv=function(t){return new Lf(this.vv,t.key,t,this.metadata.fromCache,this.qv.yi.has(t.key),this.mv)},Pf);function Pf(t,e,n,i){this.vv=t,this.Lv=e,this.qv=n,this.mv=i,this.Mv=null,this.xv=null,this.metadata=new Cf(n.hasPendingWrites,n.fromCache)}function Mf(t,e,n){this.Rv=t,this.firestore=e,this.mv=n}function Ff(){return null!==Nf&&Nf.apply(this,arguments)||this}function Vf(t,e,n,i,r,o){this.vv=t,this.fv=e,this.Tv=n,this.Ev=i,this.Sv=r,this.mv=o}function qf(t,e){this.hasPendingWrites=t,this.fromCache=e}function xf(t,e,n){this.fv=t,this.firestore=e,this.mv=n,this.$d=this.firestore.Xd()}function Gf(t){this.vv=t,this.gv=[],this.pv=!1}function jf(t,e){this.vv=t,this.wv=e}function Bf(t,e,n){var i=this;if(void 0===n&&(n=new Wh),this.Yd=null,this.Kd=new Fu,this.INTERNAL={delete:function(){return c(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Xd(),[4,this.$d.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.Yd=r,this.Zd=Bf.tv(r),this.nv=r.name,this.iv=new xi(e)}else{var o=t;if(!o.projectId)throw new Vi(Fi.INVALID_ARGUMENT,"Must provide projectId");this.Zd=new Cu(o.projectId,o.database),this.nv="[DEFAULT]",this.iv=new qi}this.ev=n,this.rv=new Af({}),this.sv=this.uv(this.Zd)}function Yf(t){if(void 0===t.host){if(void 0!==t.ssl)throw new Vi(Fi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ar("settings","non-empty string","host",t.host),this.host=t.host,ur("settings","boolean","ssl",t.ssl),this.ssl=$i(t.ssl,!0);if(dr("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),ur("settings","object","credentials",t.credentials),this.credentials=t.credentials,ur("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?bu("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&bu("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=$i(t.timestampsInSnapshots,!0),ur("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Xu.Ks;else{if(t.cacheSizeBytes!==Tf&&t.cacheSizeBytes<Xu.Ys)throw new Vi(Fi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Xu.Ys);this.cacheSizeBytes=t.cacheSizeBytes}ur("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}s(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach(function(t){try{Object.defineProperty(Uf.prototype.docChanges,t,{get:function(){return function(){throw new Vi(Fi.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}});var Hf,zf=(t(Kf,Hf=_f),Object.defineProperty(Kf.prototype,"id",{get:function(){return this.Rv.path.$()},enumerable:!0,configurable:!0}),Object.defineProperty(Kf.prototype,"parent",{get:function(){var t=this.Rv.path.Y();return t.K()?null:new Df(new Mr(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(Kf.prototype,"path",{get:function(){return this.Rv.path.it()},enumerable:!0,configurable:!0}),Kf.prototype.doc=function(t){if(rr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Tu.Ur()),or("CollectionReference.doc","non-empty string",1,t),""===t)throw new Vi(Fi.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=_r.et(t);return Df.lv(this.Rv.path.child(e),this.firestore,this.mv)},Kf.prototype.add=function(t){nr("CollectionReference.add",arguments,1),or("CollectionReference.add","object",1,this.mv?this.mv.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Kf.prototype.withConverter=function(t){return new Kf(this.Qv,this.firestore,t)},Kf);function Kf(t,e,n){var i=Hf.call(this,Zs.Ln(t),e,n)||this;if((i.Qv=t).length%2!=1)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.it()+" has "+t.length);return i}function Wf(t,e){if(void 0===e)return{merge:!1};if(dr(t,e,["merge","mergeFields"]),ur(t,"boolean","merge",e.merge),function(t,e,n,i,r){void 0!==i&&function(t,e,n,i,r){if(!(i instanceof Array))throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+lr(i));for(var o=0;o<i.length;++o)if(!r(i[o]))throw new Vi(Fi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+lr(i[o]))}(t,e,n,i,r)}(t,"mergeFields","a string or a FieldPath",e.mergeFields,function(t){return"string"==typeof t||t instanceof tc}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Vi(Fi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Qf(t,e){return void 0===e?{}:(dr(t,e,["serverTimestamps"]),hr(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Xf(t,e){sr(t,"object",1,e),e&&(dr(t,e,["source"]),hr(t,0,"source",e.source,["default","server","cache"]))}function $f(t,e,n){if(e instanceof Df){if(e.firestore!==n)throw new Vi(Fi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw vr(t,"DocumentReference",1,e)}function Zf(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}var Jf=Qi(Sf,"Use firebase.firestore() instead."),tl=Qi(kf,"Use firebase.firestore().runTransaction() instead."),el=Qi(Rf,"Use firebase.firestore().batch() instead."),nl=Qi(Df,"Use firebase.firestore().doc() instead."),il=Qi(Of),rl=Qi(Lf),ol=Qi(_f),sl=Qi(Uf),al=Qi(zf,"Use firebase.firestore().collection() instead."),ul={Firestore:Jf,GeoPoint:Dr,Timestamp:Cr,Blob:Rr,Transaction:tl,WriteBatch:el,DocumentReference:nl,DocumentSnapshot:il,Query:ol,QueryDocumentSnapshot:rl,QuerySnapshot:sl,CollectionReference:al,FieldPath:tc,FieldValue:kc,setLogLevel:Sf.setLogLevel,CACHE_SIZE_UNLIMITED:Tf};var hl,cl,fl,ll=(Nl.prototype.qf=function(t){},Nl.prototype.shutdown=function(){},Nl),pl=(Il.prototype.qf=function(t){this.Jv.push(t)},Il.prototype.shutdown=function(){window.removeEventListener("online",this.Wv),window.removeEventListener("offline",this.zv)},Il.prototype.Yv=function(){window.addEventListener("online",this.Wv),window.addEventListener("offline",this.zv)},Il.prototype.Gv=function(){wu("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Jv;t<e.length;t++)(0,e[t])(0)},Il.prototype.Hv=function(){wu("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Jv;t<e.length;t++)(0,e[t])(1)},Il.sh=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Il),dl=(El.prototype.Da=function(t){Nu(!this.$v,"Called onOpen on stream twice!"),this.$v=t},El.prototype.Ia=function(t){Nu(!this.Zv,"Called onClose on stream twice!"),this.Zv=t},El.prototype.onMessage=function(t){Nu(!this.tw,"Called onMessage on stream twice!"),this.tw=t},El.prototype.close=function(){this.Xv()},El.prototype.send=function(t){this.Kv(t)},El.prototype.nw=function(){Nu(void 0!==this.$v,"Cannot call onOpen because no callback was set"),this.$v()},El.prototype.iw=function(t){Nu(void 0!==this.Zv,"Cannot call onClose because no callback was set"),this.Zv(t)},El.prototype.ew=function(t){Nu(void 0!==this.tw,"Cannot call onMessage because no callback was set"),this.tw(t)},El),vl={BatchGetDocuments:"batchGet",Commit:"commit"},yl="gl-js/ fire/"+Pi,gl=(bl.prototype.sw=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=yl},bl.prototype.Ba=function(u,i,r){var h=this,c=this.uw(u);return new Promise(function(o,s){var a=new Ui;a.listenOnce(Li.COMPLETE,function(){try{switch(a.getLastErrorCode()){case Oi.NO_ERROR:var t=a.getResponseJson();wu("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Oi.TIMEOUT:wu("Connection",'RPC "'+u+'" timed out'),s(new Vi(Fi.DEADLINE_EXCEEDED,"Request time out"));break;case Oi.HTTP_ERROR:var e=a.getStatus();if(wu("Connection",'RPC "'+u+'" failed with status:',e,"response text:",a.getResponseText()),0<e){var n=a.getResponseJson().error;if(n&&n.status&&n.message){var i=(r=n.status.toLowerCase().replace("_","-"),0<=Object.values(Fi).indexOf(r)?r:Fi.UNKNOWN);s(new Vi(i,n.message))}else s(new Vi(Fi.UNKNOWN,"Server responded with status "+a.getStatus()))}else wu("Connection",'RPC "'+u+'" failed'),s(new Vi(Fi.UNAVAILABLE,"Connection failed."));break;default:Iu('RPC "'+u+'" failed with unanticipated webchannel error '+a.getLastErrorCode()+": "+a.getLastError()+", giving up.")}}finally{wu("Connection",'RPC "'+u+'" completed.')}var r});var t=f({},i);delete t.database;var e=JSON.stringify(t);wu("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.sw(n,r),a.send(c,"POST",e,n,15)})},bl.prototype.Qa=function(t,e,n){return this.Ba(t,e,n)},bl.prototype.ka=function(t,e){var n=[this.rw,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=Ci(),r={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.In.projectId+"/databases/"+this.In.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.sw(r.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=d().indexOf("Electron/")||function(){var t=d();return 0<=t.indexOf("MSIE ")||0<=t.indexOf("Trident/")}()||0<=d().indexOf("MSAppHost/")||function(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||(r.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");function s(t,e){u.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}wu("Connection","Creating WebChannel: "+o+" "+r);var u=i.createWebChannel(o,r),a=!1,h=!1,c=new dl({Kv:function(t){h?wu("Connection","Not sending because WebChannel is closed:",t):(a||(wu("Connection","Opening WebChannel transport."),u.open(),a=!0),wu("Connection","WebChannel sending:",t),u.send(t))},Xv:function(){return u.close()}});return s(_i.EventType.OPEN,function(){h||wu("Connection","WebChannel transport opened.")}),s(_i.EventType.CLOSE,function(){h||(h=!0,wu("Connection","WebChannel transport closed"),c.iw())}),s(_i.EventType.ERROR,function(t){h||(h=!0,wu("Connection","WebChannel transport errored:",t),c.iw(new Vi(Fi.UNAVAILABLE,"The operation could not be completed")))}),s(_i.EventType.MESSAGE,function(t){var e;if(!h){var n=t.data[0];Nu(!!n,"Got a webchannel message without data.");var i=n,r=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(r){wu("Connection","WebChannel received error:",r);var o=r.status,s=function(){var t=Bs[o];if(void 0!==t)return Ra(t)}(),a=r.message;void 0===s&&(s=Fi.INTERNAL,a="Unknown error status: "+o+" with message "+r.message),h=!0,c.iw(new Vi(s,a)),u.close()}else wu("Connection","WebChannel received:",n),c.ew(n)}}),setTimeout(function(){c.nw()},0),c},bl.prototype.uw=function(t){var e=vl[t];return Nu(void 0!==e,"Unknown REST mapping for: "+t),this.rw+"/v1/projects/"+this.In.projectId+"/databases/"+this.In.database+"/documents:"+e},bl),ml=(Object.defineProperty(wl.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(wl.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),wl.prototype.Md=function(t){return Promise.resolve(new gl(t))},wl.prototype.xd=function(){return pl.sh()?new pl:new ll},wl.prototype.Bd=function(t){return new lu(t,{_e:!0})},wl.prototype.Vr=function(t){return JSON.stringify(t)},wl.prototype.atob=function(t){return atob(t)},wl.prototype.btoa=function(t){return btoa(t)},wl.prototype.randomBytes=function(t){if(t<=0)return new Uint8Array;var e=new Uint8Array(t);return crypto.getRandomValues(e),e},wl);function wl(){this.O="undefined"!=typeof atob}function bl(t){this.In=t.In;var e=t.ssl?"https":"http";this.rw=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function El(t){this.Kv=t.Kv,this.Xv=t.Xv}function Il(){var t=this;this.Wv=function(){return t.Gv()},this.zv=function(){return t.Hv()},this.Jv=[],this.Yv()}function Nl(){}pu.Fr(new ml),hl=function(t,e){return new Sf(t,e,new Wh)},(fl=Tl).INTERNAL.registerComponent(new I("firestore",function(t){var e=t.getProvider("app").getImmediate();return hl(e,t.getProvider("auth-internal"))},"PUBLIC").setServiceProps((Nu((cl=ul)&&"object"==typeof cl,"shallowCopy() expects object parameter."),f({},cl)))),fl.registerVersion("@firebase/firestore","1.13.0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
